const _0x286f = [
    'retries\x20for\x20streams',
    'does\x20not\x20retry\x20on\x20a\x20timeout',
    'http://localhost:9988/never-ends',
    'create',
    'retry',
    'fromCallback',
    'error',
    'rejected',
    'code',
    'ESOCKETTIMEDOUT',
    'retries\x204x\x20on\x20a\x20connection\x20reset',
    'http://localhost:9988/econnreset',
    'ECONNRESET',
    'retries\x204x\x20on\x20a\x20NXDOMAIN\x20(ENOTFOUND)',
    'enableNetConnect',
    'retries\x20for\x20promises',
    'should\x20not\x20reach',
    'catch',
    '#sendPromise',
    'Request',
    'prototype',
    'init',
    '/foo',
    'text/html',
    'sendPromise',
    'http://www.github.com/foo',
    'calledWithMatch',
    'http://www.github.com',
    'sets\x20resolveWithFullResponse=true',
    'hello',
    'foobarbaz',
    'duration',
    'isOkStatusCode',
    'allRequestResponses',
    'requestHeaders',
    'status',
    'statusText',
    'true',
    '*/*',
    'keep-alive',
    'www.github.com',
    'gzip,\x20deflate',
    'includes\x20redirects',
    '/dashboard',
    '/auth',
    '/login',
    'log\x20in',
    'http://www.github.com/dashboard',
    'keys',
    'redirects',
    'undefined',
    '301:\x20http://www.github.com/auth',
    '302:\x20http://www.github.com/login',
    'http://www.github.com/auth',
    'application/json',
    'http://www.github.com/login',
    'catches\x20errors',
    'http://localhost:1111/foo',
    'should\x20have\x20failed\x20but\x20didnt',
    'message',
    'Error:\x20connect\x20ECONNREFUSED\x20127.0.0.1:1111',
    'parses\x20response\x20body\x20as\x20json\x20if\x20content-type\x20application/json\x20response\x20headers',
    'http://localhost:8080',
    '/status.json',
    'http://localhost:8080/status.json',
    'parses\x20response\x20body\x20as\x20json\x20if\x20content-type\x20application/vnd.api+json\x20response\x20headers',
    'stringify',
    'application/vnd.api+json',
    'revives\x20from\x20parsing\x20bad\x20json',
    '{bad:\x20\x27json\x27}',
    'sets\x20duration\x20on\x20response',
    'delay',
    '123',
    'text/plain',
    'Number',
    'sends\x20up\x20user-agent\x20headers',
    'matchHeader',
    'user-agent',
    'derp',
    'connection',
    'it\x20worked',
    'http://localhost:8080/foo',
    'lower\x20cases\x20headers',
    'test',
    'allows\x20overriding\x20user-agent\x20in\x20headers',
    'custom-agent',
    '/headers',
    'can\x20override\x20accept\x20header',
    'http://localhost:8080/headers',
    'accept',
    'followRedirect',
    'by\x20default\x20follow\x20redirects',
    'http://localhost:8080/login',
    'login',
    'http://localhost:8080/dashboard',
    'property',
    'redirectedToUrl',
    'follows\x20non-GET\x20redirects\x20by\x20default',
    'post',
    'dashboard',
    'can\x20turn\x20off\x20following\x20redirects',
    'resolves\x20redirectedToUrl\x20on\x20relative\x20redirects',
    'https://www.google.com/login',
    'does\x20not\x20included\x20redirectedToUrl\x20when\x20following\x20redirects',
    'http://localhost:1234/',
    'form=true',
    'Content-Type',
    'application/x-www-form-urlencoded',
    'foo=bar&baz=quux',
    '<html></html>',
    'takes\x20converts\x20body\x20to\x20x-www-form-urlencoded\x20and\x20sets\x20header',
    'POST',
    'quux',
    'does\x20not\x20send\x20body',
    'does\x20not\x20set\x20json=true',
    'end',
    'אבגד',
    'should\x20have\x20failed',
    'TypeError\x20[ERR_INVALID_CHAR]:\x20Invalid\x20character\x20in\x20header\x20content\x20[\x22x-text\x22]',
    'handles\x20weird\x20content\x20in\x20the\x20body\x20just\x20fine',
    'http://localhost:9988/foo',
    'sendStream',
    'gets\x20+\x20attaches\x20the\x20cookies\x20at\x20each\x20redirect',
    'stubTrue',
    'response',
    '485117TrmJUT',
    '353161whBsZS',
    '1GRZSyN',
    '424670RIiRUc',
    '730294iKMtvS',
    '557926NuHRUj',
    '1ZLaWAT',
    '80950uHRyPd',
    '689073qSJobT',
    '../spec_helper',
    'lodash',
    'http',
    'lib/request',
    'snap-shot-it',
    'spy',
    'setCookiesOnBrowser',
    'setRequestCookieHeader',
    'get',
    'reply',
    '/second',
    '/third',
    'three=3',
    'then',
    'getCalls',
    'map',
    'args',
    'headers',
    'set-cookie',
    'args.1',
    'stub',
    'resolves',
    'withArgs',
    'get:cookies',
    'object',
    'divides\x20by\x2010\x20when\x20delay\x20>=\x201000\x20and\x20err.code\x20=\x20ECONNREFUSED',
    'ECONNREFUSED',
    'forEach',
    'empty',
    'does\x20not\x20divide\x20by\x2010\x20when\x20err.code\x20!=\x20ECONNREFUSED',
    'getDelayForRetry',
    'have',
    'calledWith',
    'calls\x20onElse\x20when\x20delaysRemaining\x20is\x20exhausted',
    'calledWithExactly',
    'called',
    'delaysRemaining\x20to\x20retryIntervals\x20clone',
    'retryIntervals',
    'not',
    'delaysRemaining',
    'deep',
    'retryIntervals\x20to\x20[0,\x201000,\x202000,\x202000]\x20by\x20default',
    'setDefaults',
    'delaysRemaining\x20can\x20be\x20overridden',
    '#normalizeResponse',
    'push',
    'sets\x20status\x20to\x20statusCode\x20and\x20deletes\x20statusCode',
    'normalizeResponse',
    'bar',
    'body',
    'Not\x20Found',
    'calledOnce',
    'picks\x20out\x20status\x20body\x20and\x20headers',
    '<html>foo</html>',
    '#create',
    'hits',
    'createServer',
    '/never-ends',
    'writeHead',
    'write',
    'foo\x0a',
    '/econnreset',
    'destroy',
    'srv',
    'listen',
    'close'
];
const _0xbd67e3 = _0x9f75;
function _0x9f75(_0x1faff8, _0x5c9cf7) {
    return _0x9f75 = function (_0x286fc1, _0x9f7563) {
        _0x286fc1 = _0x286fc1 - 0xc3;
        let _0x2c6127 = _0x286f[_0x286fc1];
        return _0x2c6127;
    }, _0x9f75(_0x1faff8, _0x5c9cf7);
}
(function (_0x5cb11a, _0x27486d) {
    const _0x3792a3 = _0x9f75;
    while (!![]) {
        try {
            const _0x3ac3c6 = parseInt(_0x3792a3(0xc3)) + parseInt(_0x3792a3(0xc4)) * -parseInt(_0x3792a3(0xc5)) + -parseInt(_0x3792a3(0xc6)) + parseInt(_0x3792a3(0xc7)) + parseInt(_0x3792a3(0xc8)) + -parseInt(_0x3792a3(0xc9)) * -parseInt(_0x3792a3(0xca)) + -parseInt(_0x3792a3(0xcb));
            if (_0x3ac3c6 === _0x27486d)
                break;
            else
                _0x5cb11a['push'](_0x5cb11a['shift']());
        } catch (_0x5c91d2) {
            _0x5cb11a['push'](_0x5cb11a['shift']());
        }
    }
}(_0x286f, 0x5e937), require(_0xbd67e3(0xcc)));
const _ = require(_0xbd67e3(0xcd)), http = require(_0xbd67e3(0xce)), Bluebird = require('bluebird'), Request = require(root + _0xbd67e3(0xcf)), snapshot = require(_0xbd67e3(0xd0)), request = Request({ 'timeout': 0x64 }), testAttachingCookiesWith = function (_0x99f743) {
        const _0x35ebf7 = _0xbd67e3, _0x2a9d23 = sinon[_0x35ebf7(0xd1)](request, _0x35ebf7(0xd2)), _0x14c676 = sinon[_0x35ebf7(0xd1)](request, _0x35ebf7(0xd3));
        return nock('http://localhost:1234')[_0x35ebf7(0xd4)]('/')[_0x35ebf7(0xd5)](0x12e, '', {
            'set-cookie': 'one=1',
            'location': _0x35ebf7(0xd6)
        })[_0x35ebf7(0xd4)](_0x35ebf7(0xd6))['reply'](0x12e, '', {
            'set-cookie': 'two=2',
            'location': _0x35ebf7(0xd7)
        })[_0x35ebf7(0xd4)]('/third')['reply'](0xc8, '', { 'set-cookie': _0x35ebf7(0xd8) }), _0x99f743()[_0x35ebf7(0xd9)](() => {
            const _0x227a8b = _0x35ebf7;
            return snapshot({
                'setCalls': _0x2a9d23[_0x227a8b(0xda)]()[_0x227a8b(0xdb)](_0x1779dd => {
                    const _0x37c91b = _0x227a8b;
                    return {
                        'currentUrl': _0x1779dd[_0x37c91b(0xdc)][0x1],
                        'setCookie': _0x1779dd[_0x37c91b(0xdc)][0x0][_0x37c91b(0xdd)][_0x37c91b(0xde)]
                    };
                }),
                'getCalls': _0x14c676[_0x227a8b(0xda)]()[_0x227a8b(0xdb)](_0x49f892 => {
                    const _0x3973ed = _0x227a8b;
                    return { 'newUrl': _[_0x3973ed(0xd4)](_0x49f892, _0x3973ed(0xdf)) };
                })
            });
        });
    };
describe(_0xbd67e3(0xcf), () => {
    const _0x4fae09 = _0xbd67e3;
    beforeEach(function () {
        const _0x3e9c4d = _0x9f75;
        this['fn'] = sinon[_0x3e9c4d(0xe0)](), this['fn']['withArgs']('set:cookie')[_0x3e9c4d(0xe1)]({}), this['fn'][_0x3e9c4d(0xe2)](_0x3e9c4d(0xe3))[_0x3e9c4d(0xe1)]([]);
    }), it('is\x20defined', () => {
        const _0xf0cfab = _0x9f75;
        expect(request)['to']['be']['an'](_0xf0cfab(0xe4));
    }), context('#getDelayForRetry', () => {
        const _0x54c81a = _0x9f75;
        it(_0x54c81a(0xe5), () => {
            const _0x23a299 = _0x54c81a, _0x2a56b1 = [
                    0x1,
                    0x2,
                    0x3,
                    0x4
                ], _0x1dc161 = [
                    0x0,
                    0x3e7,
                    0x3e8,
                    0x7d0
                ], _0x85afb5 = { 'code': _0x23a299(0xe6) }, _0x5570a5 = sinon[_0x23a299(0xe0)]();
            _0x2a56b1[_0x23a299(0xe7)](() => {
                return request['getDelayForRetry']({
                    'err': _0x85afb5,
                    'onNext': _0x5570a5,
                    'retryIntervals': _0x2a56b1,
                    'delaysRemaining': _0x1dc161
                });
            }), expect(_0x1dc161)['to']['be'][_0x23a299(0xe8)], expect(_0x5570a5[_0x23a299(0xdc)])['to']['deep']['eq']([
                [
                    0x0,
                    0x1
                ],
                [
                    0x3e7,
                    0x2
                ],
                [
                    0x64,
                    0x3
                ],
                [
                    0xc8,
                    0x4
                ]
            ]);
        }), it(_0x54c81a(0xe9), () => {
            const _0x2e6bdd = _0x54c81a, _0xcc50ba = [
                    0x1,
                    0x2,
                    0x3,
                    0x4
                ], _0x45db04 = [
                    0x7d0,
                    0x7d0,
                    0x7d0,
                    0x7d0
                ], _0x12bfbb = { 'code': 'ECONNRESET' }, _0x1bf4a5 = sinon[_0x2e6bdd(0xe0)]();
            request[_0x2e6bdd(0xea)]({
                'err': _0x12bfbb,
                'onNext': _0x1bf4a5,
                'retryIntervals': _0xcc50ba,
                'delaysRemaining': _0x45db04
            }), expect(_0x45db04)['to'][_0x2e6bdd(0xeb)]['length'](0x3), expect(_0x1bf4a5)['to']['be'][_0x2e6bdd(0xec)](0x7d0, 0x1);
        }), it(_0x54c81a(0xed), () => {
            const _0x158407 = _0x54c81a, _0x3c539e = [
                    0x1,
                    0x2,
                    0x3,
                    0x4
                ], _0x2e6511 = [], _0x12cee9 = sinon[_0x158407(0xe0)](), _0x4cfdf2 = sinon[_0x158407(0xe0)]();
            request['getDelayForRetry']({
                'onElse': _0x4cfdf2,
                'onNext': _0x12cee9,
                'retryIntervals': _0x3c539e,
                'delaysRemaining': _0x2e6511
            }), expect(_0x4cfdf2)['to']['be'][_0x158407(0xee)](), expect(_0x12cee9)['not']['to']['be'][_0x158407(0xef)];
        });
    }), context('#setDefaults', () => {
        const _0x535c22 = _0x9f75;
        it(_0x535c22(0xf0), () => {
            const _0x56863b = _0x535c22, _0xee537 = [
                    0x1,
                    0x2,
                    0x3,
                    0x4
                ], _0x3db80f = request['setDefaults']({ 'retryIntervals': _0xee537 });
            expect(_0x3db80f[_0x56863b(0xf1)])['to']['eq'](_0xee537), expect(_0x3db80f['delaysRemaining'])[_0x56863b(0xf2)]['to']['eq'](_0xee537), expect(_0x3db80f[_0x56863b(0xf3)])['to'][_0x56863b(0xf4)]['eq'](_0xee537);
        }), it(_0x535c22(0xf5), () => {
            const _0xf8146e = _0x535c22, _0xbc638b = request[_0xf8146e(0xf6)]({});
            expect(_0xbc638b['retryIntervals'])['to']['deep']['eq']([
                0x0,
                0x3e8,
                0x7d0,
                0x7d0
            ]);
        }), it(_0x535c22(0xf7), () => {
            const _0x4c978a = _0x535c22, _0x549b6a = [0x1], _0x36116c = request[_0x4c978a(0xf6)]({ 'delaysRemaining': _0x549b6a });
            expect(_0x36116c[_0x4c978a(0xf3)])['to']['eq'](_0x549b6a);
        });
    }), context(_0x4fae09(0xf8), () => {
        const _0x222558 = _0x4fae09;
        beforeEach(function () {
            const _0x1e4e4b = _0x9f75;
            this[_0x1e4e4b(0xf9)] = sinon[_0x1e4e4b(0xe0)]();
        }), it(_0x222558(0xfa), function () {
            const _0x1c087f = _0x222558;
            expect(request[_0x1c087f(0xfb)](this[_0x1c087f(0xf9)], {
                'statusCode': 0x194,
                'request': {
                    'headers': { 'foo': _0x1c087f(0xfc) },
                    'body': _0x1c087f(0xfd)
                }
            }))['to'][_0x1c087f(0xf4)]['eq']({
                'status': 0x194,
                'statusText': _0x1c087f(0xfe),
                'isOkStatusCode': ![],
                'requestHeaders': { 'foo': _0x1c087f(0xfc) },
                'requestBody': _0x1c087f(0xfd)
            }), expect(this['push'])['to']['be'][_0x1c087f(0xff)];
        }), it(_0x222558(0x100), function () {
            const _0x4e5a1a = _0x222558;
            expect(request[_0x4e5a1a(0xfb)](this[_0x4e5a1a(0xf9)], {
                'foo': _0x4e5a1a(0xfc),
                'req': {},
                'originalHeaders': {},
                'headers': { 'Content-Length': 0x32 },
                'body': '<html>foo</html>',
                'statusCode': 0xc8,
                'request': {
                    'headers': { 'foo': _0x4e5a1a(0xfc) },
                    'body': _0x4e5a1a(0xfd)
                }
            }))['to'][_0x4e5a1a(0xf4)]['eq']({
                'body': _0x4e5a1a(0x101),
                'headers': { 'Content-Length': 0x32 },
                'status': 0xc8,
                'statusText': 'OK',
                'isOkStatusCode': !![],
                'requestHeaders': { 'foo': _0x4e5a1a(0xfc) },
                'requestBody': _0x4e5a1a(0xfd)
            }), expect(this[_0x4e5a1a(0xf9)])['to']['be']['calledOnce'];
        });
    }), context(_0x4fae09(0x102), () => {
        const _0x196b44 = _0x4fae09;
        beforeEach(function (_0x59959d) {
            const _0x3fb0a6 = _0x9f75;
            this[_0x3fb0a6(0x103)] = 0x0, this['srv'] = http[_0x3fb0a6(0x104)]((_0x549c4f, _0x1952b2) => {
                const _0x584779 = _0x3fb0a6;
                this['hits']++;
                switch (_0x549c4f['url']) {
                case _0x584779(0x105):
                    _0x1952b2[_0x584779(0x106)](0xc8);
                    return _0x1952b2[_0x584779(0x107)](_0x584779(0x108));
                case _0x584779(0x109):
                    return _0x549c4f['socket'][_0x584779(0x10a)]();
                default:
                    break;
                }
            }), this[_0x3fb0a6(0x10b)][_0x3fb0a6(0x10c)](0x2704, _0x59959d);
        }), afterEach(function () {
            const _0xd61c = _0x9f75;
            return this['srv'][_0xd61c(0x10d)]();
        }), context(_0x196b44(0x10e), () => {
            const _0x3942cf = _0x196b44;
            it(_0x3942cf(0x10f), () => {
                const _0x216606 = _0x3942cf, _0x4fa356 = request[_0x216606(0xf6)]({
                        'url': _0x216606(0x110),
                        'timeout': 0x3e8
                    }), _0x45760e = request[_0x216606(0x111)](_0x4fa356);
                let _0x7c3cb1 = 0x0;
                _0x45760e['on'](_0x216606(0x112), () => {
                    _0x7c3cb1++;
                });
                const _0x298e60 = Bluebird[_0x216606(0x113)](_0x567a07 => {
                    const _0x34e7b5 = _0x216606;
                    _0x45760e['on'](_0x34e7b5(0x114), _0x567a07);
                });
                return expect(_0x298e60)['to']['be'][_0x216606(0x115)][_0x216606(0xd9)](_0x3732d7 => {
                    const _0x32d5f3 = _0x216606;
                    expect(_0x3732d7[_0x32d5f3(0x116)])['to']['eq'](_0x32d5f3(0x117)), expect(_0x7c3cb1)['to']['eq'](0x0);
                });
            }), it(_0x3942cf(0x118), () => {
                const _0x26ac66 = _0x3942cf, _0x29510d = {
                        'url': _0x26ac66(0x119),
                        'retryIntervals': [
                            0x0,
                            0x1,
                            0x2,
                            0x3
                        ],
                        'timeout': 0x3e8
                    }, _0x188500 = request[_0x26ac66(0x111)](_0x29510d);
                let _0x1977d9 = 0x0;
                _0x188500['on'](_0x26ac66(0x112), () => {
                    _0x1977d9++;
                });
                const _0x44c5bf = Bluebird['fromCallback'](_0x1f4803 => {
                    _0x188500['on']('error', _0x1f4803);
                });
                return expect(_0x44c5bf)['to']['be'][_0x26ac66(0x115)][_0x26ac66(0xd9)](_0x8161d8 => {
                    const _0x5346ac = _0x26ac66;
                    expect(_0x8161d8[_0x5346ac(0x116)])['to']['eq'](_0x5346ac(0x11a)), expect(_0x1977d9)['to']['eq'](0x4);
                });
            }), it(_0x3942cf(0x11b), () => {
                const _0x52a684 = _0x3942cf;
                nock[_0x52a684(0x11c)]();
                const _0x7c70b2 = {
                        'url': 'http://will-never-exist.invalid.example.com',
                        'retryIntervals': [
                            0x0,
                            0x1,
                            0x2,
                            0x3
                        ],
                        'timeout': 0x3e8
                    }, _0x7287e3 = request[_0x52a684(0x111)](_0x7c70b2);
                let _0x49e603 = 0x0;
                _0x7287e3['on'](_0x52a684(0x112), () => {
                    _0x49e603++;
                });
                const _0x41a93e = Bluebird[_0x52a684(0x113)](_0x55b2ae => {
                    _0x7287e3['on']('error', _0x55b2ae);
                });
                return expect(_0x41a93e)['to']['be']['rejected']['then'](_0x2d9fe1 => {
                    const _0x1a6ad8 = _0x52a684;
                    expect(_0x2d9fe1[_0x1a6ad8(0x116)])['to']['eq']('ENOTFOUND'), expect(_0x49e603)['to']['eq'](0x4);
                });
            });
        }), context(_0x196b44(0x11d), () => {
            const _0xa16237 = _0x196b44;
            it('does\x20not\x20retry\x20on\x20a\x20timeout', function () {
                const _0x487b25 = {
                    'url': 'http://localhost:9988/never-ends',
                    'timeout': 0x64
                };
                return request['create'](_0x487b25, !![])['then'](() => {
                    const _0x579555 = _0x9f75;
                    throw new Error(_0x579555(0x11e));
                })['catch'](_0x2cfbe5 => {
                    const _0xf2afdc = _0x9f75;
                    expect(_0x2cfbe5[_0xf2afdc(0x114)][_0xf2afdc(0x116)])['to']['eq'](_0xf2afdc(0x117)), expect(this[_0xf2afdc(0x103)])['to']['eq'](0x1);
                });
            }), it(_0xa16237(0x118), function () {
                const _0x5512c5 = _0xa16237, _0x20b07b = {
                        'url': _0x5512c5(0x119),
                        'retryIntervals': [
                            0x0,
                            0x1,
                            0x2,
                            0x3
                        ],
                        'timeout': 0xfa
                    };
                return request['create'](_0x20b07b, !![])[_0x5512c5(0xd9)](() => {
                    const _0x51cece = _0x5512c5;
                    throw new Error(_0x51cece(0x11e));
                })[_0x5512c5(0x11f)](_0x495df8 => {
                    const _0x448319 = _0x5512c5;
                    expect(_0x495df8[_0x448319(0x114)][_0x448319(0x116)])['to']['eq']('ECONNRESET'), expect(this['hits'])['to']['eq'](0x5);
                });
            });
        });
    }), context(_0x4fae09(0x120), () => {
        const _0x1175d5 = _0x4fae09;
        it('sets\x20strictSSL=false', function () {
            const _0x4c1822 = _0x9f75, _0x373d44 = sinon[_0x4c1822(0xd1)](request['rp'][_0x4c1822(0x121)][_0x4c1822(0x122)], _0x4c1822(0x123));
            return nock('http://www.github.com')[_0x4c1822(0xd4)](_0x4c1822(0x124))[_0x4c1822(0xd5)](0xc8, 'hello', { 'Content-Type': _0x4c1822(0x125) }), request[_0x4c1822(0x126)]({}, this['fn'], {
                'url': _0x4c1822(0x127),
                'cookies': ![]
            })[_0x4c1822(0xd9)](() => {
                const _0x1577c8 = _0x4c1822;
                expect(_0x373d44)['to']['be'][_0x1577c8(0x128)]({ 'strictSSL': ![] });
            });
        }), it('sets\x20simple=false', function () {
            const _0x1b75c2 = _0x9f75;
            return nock(_0x1b75c2(0x129))[_0x1b75c2(0xd4)](_0x1b75c2(0x124))[_0x1b75c2(0xd5)](0x1f4, ''), request[_0x1b75c2(0x126)]({}, this['fn'], {
                'url': _0x1b75c2(0x127),
                'cookies': ![]
            });
        }), it(_0x1175d5(0x12a), function () {
            const _0x38ab12 = _0x1175d5;
            return nock(_0x38ab12(0x129))[_0x38ab12(0xd4)](_0x38ab12(0x124))['reply'](0xc8, _0x38ab12(0x12b), { 'Content-Type': 'text/html' }), request[_0x38ab12(0x126)]({}, this['fn'], {
                'url': 'http://www.github.com/foo',
                'cookies': ![],
                'body': _0x38ab12(0x12c)
            })['then'](_0x2ae6d5 => {
                const _0x3cfc76 = _0x38ab12;
                expect(_0x2ae6d5)['to'][_0x3cfc76(0xeb)]['keys']('status', _0x3cfc76(0xfd), _0x3cfc76(0xdd), _0x3cfc76(0x12d), _0x3cfc76(0x12e), 'statusText', _0x3cfc76(0x12f), 'requestBody', _0x3cfc76(0x130)), expect(_0x2ae6d5[_0x3cfc76(0x131)])['to']['eq'](0xc8), expect(_0x2ae6d5[_0x3cfc76(0x132)])['to']['eq']('OK'), expect(_0x2ae6d5['body'])['to']['eq'](_0x3cfc76(0x12b)), expect(_0x2ae6d5['headers'])['to'][_0x3cfc76(0xf4)]['eq']({ 'content-type': _0x3cfc76(0x125) }), expect(_0x2ae6d5[_0x3cfc76(0x12e)])['to']['be'][_0x3cfc76(0x133)], expect(_0x2ae6d5['requestBody'])['to']['eq'](_0x3cfc76(0x12c)), expect(_0x2ae6d5['requestHeaders'])['to'][_0x3cfc76(0xf4)]['eq']({
                    'accept': _0x3cfc76(0x134),
                    'accept-encoding': 'gzip,\x20deflate',
                    'connection': _0x3cfc76(0x135),
                    'content-length': 0x9,
                    'host': _0x3cfc76(0x136)
                }), expect(_0x2ae6d5['allRequestResponses'])['to'][_0x3cfc76(0xf4)]['eq']([{
                        'Request\x20Body': _0x3cfc76(0x12c),
                        'Request\x20Headers': {
                            'accept': _0x3cfc76(0x134),
                            'accept-encoding': _0x3cfc76(0x137),
                            'connection': _0x3cfc76(0x135),
                            'content-length': 0x9,
                            'host': _0x3cfc76(0x136)
                        },
                        'Request\x20URL': 'http://www.github.com/foo',
                        'Response\x20Body': _0x3cfc76(0x12b),
                        'Response\x20Headers': { 'content-type': 'text/html' },
                        'Response\x20Status': 0xc8
                    }]);
            });
        }), it(_0x1175d5(0x138), function () {
            const _0x46e0a8 = _0x1175d5;
            return this['fn'][_0x46e0a8(0xe1)](), nock(_0x46e0a8(0x129))['get'](_0x46e0a8(0x139))[_0x46e0a8(0xd5)](0x12d, null, { 'location': _0x46e0a8(0x13a) })[_0x46e0a8(0xd4)](_0x46e0a8(0x13a))[_0x46e0a8(0xd5)](0x12e, null, { 'location': _0x46e0a8(0x13b) })['get'](_0x46e0a8(0x13b))['reply'](0xc8, _0x46e0a8(0x13c), { 'Content-Type': _0x46e0a8(0x125) }), request[_0x46e0a8(0x126)]({}, this['fn'], {
                'url': _0x46e0a8(0x13d),
                'cookies': ![]
            })[_0x46e0a8(0xd9)](_0x41b329 => {
                const _0x32756c = _0x46e0a8;
                expect(_0x41b329)['to'][_0x32756c(0xeb)][_0x32756c(0x13e)]('status', _0x32756c(0xfd), _0x32756c(0xdd), _0x32756c(0x12d), 'isOkStatusCode', _0x32756c(0x132), _0x32756c(0x12f), _0x32756c(0x13f), 'requestBody', 'requestHeaders'), expect(_0x41b329[_0x32756c(0x131)])['to']['eq'](0xc8), expect(_0x41b329[_0x32756c(0x132)])['to']['eq']('OK'), expect(_0x41b329[_0x32756c(0xfd)])['to']['eq'](_0x32756c(0x13c)), expect(_0x41b329[_0x32756c(0xdd)])['to'][_0x32756c(0xf4)]['eq']({ 'content-type': 'text/html' }), expect(_0x41b329[_0x32756c(0x12e)])['to']['be']['true'], expect(_0x41b329['requestBody'])['to']['be'][_0x32756c(0x140)], expect(_0x41b329[_0x32756c(0x13f)])['to'][_0x32756c(0xf4)]['eq']([
                    _0x32756c(0x141),
                    _0x32756c(0x142)
                ]), expect(_0x41b329[_0x32756c(0x130)])['to']['deep']['eq']({
                    'accept': '*/*',
                    'accept-encoding': _0x32756c(0x137),
                    'connection': 'keep-alive',
                    'referer': 'http://www.github.com/auth',
                    'host': _0x32756c(0x136)
                }), expect(_0x41b329[_0x32756c(0x12f)])['to'][_0x32756c(0xf4)]['eq']([
                    {
                        'Request\x20Body': null,
                        'Request\x20Headers': {
                            'accept': _0x32756c(0x134),
                            'accept-encoding': _0x32756c(0x137),
                            'connection': 'keep-alive',
                            'host': _0x32756c(0x136)
                        },
                        'Request\x20URL': _0x32756c(0x13d),
                        'Response\x20Body': null,
                        'Response\x20Headers': {
                            'content-type': 'application/json',
                            'location': _0x32756c(0x13a)
                        },
                        'Response\x20Status': 0x12d
                    },
                    {
                        'Request\x20Body': null,
                        'Request\x20Headers': {
                            'accept': '*/*',
                            'accept-encoding': _0x32756c(0x137),
                            'connection': _0x32756c(0x135),
                            'host': _0x32756c(0x136),
                            'referer': _0x32756c(0x13d)
                        },
                        'Request\x20URL': _0x32756c(0x143),
                        'Response\x20Body': null,
                        'Response\x20Headers': {
                            'content-type': _0x32756c(0x144),
                            'location': '/login'
                        },
                        'Response\x20Status': 0x12e
                    },
                    {
                        'Request\x20Body': null,
                        'Request\x20Headers': {
                            'accept': _0x32756c(0x134),
                            'accept-encoding': _0x32756c(0x137),
                            'connection': _0x32756c(0x135),
                            'host': _0x32756c(0x136),
                            'referer': _0x32756c(0x143)
                        },
                        'Request\x20URL': _0x32756c(0x145),
                        'Response\x20Body': _0x32756c(0x13c),
                        'Response\x20Headers': { 'content-type': _0x32756c(0x125) },
                        'Response\x20Status': 0xc8
                    }
                ]);
            });
        }), it(_0x1175d5(0x146), function () {
            const _0x580d43 = _0x1175d5;
            nock[_0x580d43(0x11c)]();
            const _0x380630 = Request({ 'timeout': 0x7d0 });
            return _0x380630[_0x580d43(0x126)]({}, this['fn'], {
                'url': _0x580d43(0x147),
                'cookies': ![]
            })[_0x580d43(0xd9)](() => {
                const _0x586b9e = _0x580d43;
                throw new Error(_0x586b9e(0x148));
            })[_0x580d43(0x11f)](_0x192e88 => {
                const _0x512fcf = _0x580d43;
                expect(_0x192e88[_0x512fcf(0x149)])['to']['eq'](_0x512fcf(0x14a));
            });
        }), it(_0x1175d5(0x14b), function () {
            const _0x4575ef = _0x1175d5;
            return nock(_0x4575ef(0x14c))['get'](_0x4575ef(0x14d))[_0x4575ef(0xd5)](0xc8, JSON['stringify']({ 'status': 'ok' }), { 'Content-Type': _0x4575ef(0x144) }), request[_0x4575ef(0x126)]({}, this['fn'], {
                'url': _0x4575ef(0x14e),
                'cookies': ![]
            })[_0x4575ef(0xd9)](_0x1a4ec9 => {
                const _0x54b95a = _0x4575ef;
                expect(_0x1a4ec9[_0x54b95a(0xfd)])['to']['deep']['eq']({ 'status': 'ok' });
            });
        }), it(_0x1175d5(0x14f), function () {
            const _0x545ac4 = _0x1175d5;
            return nock(_0x545ac4(0x14c))[_0x545ac4(0xd4)](_0x545ac4(0x14d))[_0x545ac4(0xd5)](0xc8, JSON[_0x545ac4(0x150)]({ 'status': 'ok' }), { 'Content-Type': _0x545ac4(0x151) }), request[_0x545ac4(0x126)]({}, this['fn'], {
                'url': 'http://localhost:8080/status.json',
                'cookies': ![]
            })[_0x545ac4(0xd9)](_0x286ff5 => {
                const _0x15a794 = _0x545ac4;
                expect(_0x286ff5[_0x15a794(0xfd)])['to'][_0x15a794(0xf4)]['eq']({ 'status': 'ok' });
            });
        }), it(_0x1175d5(0x152), function () {
            const _0x38da5c = _0x1175d5;
            return nock(_0x38da5c(0x14c))[_0x38da5c(0xd4)]('/status.json')[_0x38da5c(0xd5)](0xc8, _0x38da5c(0x153), { 'Content-Type': _0x38da5c(0x144) }), request[_0x38da5c(0x126)]({}, this['fn'], {
                'url': _0x38da5c(0x14e),
                'cookies': ![]
            })['then'](_0x127feb => {
                const _0x4b58f9 = _0x38da5c;
                expect(_0x127feb[_0x4b58f9(0xfd)])['to']['eq'](_0x4b58f9(0x153));
            });
        }), it(_0x1175d5(0x154), function () {
            const _0x43369a = _0x1175d5;
            return nock(_0x43369a(0x14c))[_0x43369a(0xd4)]('/foo')[_0x43369a(0x155)](0xa)[_0x43369a(0xd5)](0xc8, _0x43369a(0x156), { 'Content-Type': _0x43369a(0x157) }), request[_0x43369a(0x126)]({}, this['fn'], {
                'url': 'http://localhost:8080/foo',
                'cookies': ![]
            })['then'](_0x503aef => {
                const _0x1d34d7 = _0x43369a;
                expect(_0x503aef[_0x1d34d7(0x12d)])['to']['be']['a'](_0x1d34d7(0x158)), expect(_0x503aef[_0x1d34d7(0x12d)])['to']['be']['gt'](0x0);
            });
        }), it(_0x1175d5(0x159), function () {
            const _0x7cfdd = _0x1175d5;
            nock(_0x7cfdd(0x14c))[_0x7cfdd(0x15a)](_0x7cfdd(0x15b), 'foobarbaz')['get']('/foo')[_0x7cfdd(0xd5)](0xc8, 'derp');
            const _0x5207cc = {};
            return _0x5207cc[_0x7cfdd(0x15b)] = _0x7cfdd(0x12c), request[_0x7cfdd(0x126)](_0x5207cc, this['fn'], {
                'url': 'http://localhost:8080/foo',
                'cookies': ![]
            })[_0x7cfdd(0xd9)](_0x5ad480 => {
                const _0x32735c = _0x7cfdd;
                expect(_0x5ad480[_0x32735c(0xfd)])['to']['eq'](_0x32735c(0x15c));
            });
        }), it('sends\x20connection:\x20keep-alive\x20by\x20default', function () {
            const _0x3df28e = _0x1175d5;
            return nock(_0x3df28e(0x14c))[_0x3df28e(0x15a)](_0x3df28e(0x15d), _0x3df28e(0x135))[_0x3df28e(0xd4)](_0x3df28e(0x124))[_0x3df28e(0xd5)](0xc8, _0x3df28e(0x15e)), request[_0x3df28e(0x126)]({}, this['fn'], {
                'url': _0x3df28e(0x15f),
                'cookies': ![]
            })['then'](_0x196ac1 => {
                const _0xe9a8a9 = _0x3df28e;
                expect(_0x196ac1[_0xe9a8a9(0xfd)])['to']['eq']('it\x20worked');
            });
        }), it(_0x1175d5(0x160), function () {
            const _0x2a7525 = _0x1175d5;
            nock('http://localhost:8080')['matchHeader'](_0x2a7525(0x161), 'true')[_0x2a7525(0xd4)]('/foo')[_0x2a7525(0xd5)](0xc8, 'derp');
            const _0x257bf3 = {};
            return _0x257bf3[_0x2a7525(0x15b)] = _0x2a7525(0x12c), request['sendPromise'](_0x257bf3, this['fn'], {
                'url': _0x2a7525(0x15f),
                'cookies': ![],
                'headers': { 'TEST': !![] }
            })[_0x2a7525(0xd9)](_0x361add => {
                const _0x492bbf = _0x2a7525;
                expect(_0x361add[_0x492bbf(0xfd)])['to']['eq'](_0x492bbf(0x15c));
            });
        }), it(_0x1175d5(0x162), function () {
            const _0x2fffd8 = _0x1175d5;
            nock(_0x2fffd8(0x14c))[_0x2fffd8(0x15a)](_0x2fffd8(0x15b), _0x2fffd8(0x163))[_0x2fffd8(0xd4)](_0x2fffd8(0x124))[_0x2fffd8(0xd5)](0xc8, _0x2fffd8(0x15c));
            const _0x4854e0 = { 'user-agent': _0x2fffd8(0x161) };
            return request[_0x2fffd8(0x126)](_0x4854e0, this['fn'], {
                'url': _0x2fffd8(0x15f),
                'cookies': ![],
                'headers': { 'User-Agent': _0x2fffd8(0x163) }
            })[_0x2fffd8(0xd9)](_0xdc6cbf => {
                const _0x151b3c = _0x2fffd8;
                expect(_0xdc6cbf[_0x151b3c(0xfd)])['to']['eq'](_0x151b3c(0x15c));
            });
        }), context('accept\x20header', () => {
            const _0x3f169f = _0x1175d5;
            it('sets\x20to\x20*/*\x20by\x20default', function () {
                const _0x8490a5 = _0x9f75;
                return nock(_0x8490a5(0x14c))[_0x8490a5(0x15a)]('accept', _0x8490a5(0x134))[_0x8490a5(0xd4)](_0x8490a5(0x164))['reply'](0xc8), request[_0x8490a5(0x126)]({}, this['fn'], {
                    'url': 'http://localhost:8080/headers',
                    'cookies': ![]
                })[_0x8490a5(0xd9)](_0x36371b => {
                    const _0x1e7603 = _0x8490a5;
                    expect(_0x36371b[_0x1e7603(0x131)])['to']['eq'](0xc8);
                });
            }), it(_0x3f169f(0x165), function () {
                const _0x44c907 = _0x3f169f;
                return nock(_0x44c907(0x14c))[_0x44c907(0x15a)]('accept', _0x44c907(0x125))[_0x44c907(0xd4)](_0x44c907(0x164))[_0x44c907(0xd5)](0xc8), request[_0x44c907(0x126)]({}, this['fn'], {
                    'url': _0x44c907(0x166),
                    'cookies': ![],
                    'headers': { 'accept': _0x44c907(0x125) }
                })[_0x44c907(0xd9)](_0x2fd47b => {
                    const _0x5021f3 = _0x44c907;
                    expect(_0x2fd47b[_0x5021f3(0x131)])['to']['eq'](0xc8);
                });
            }), it('can\x20override\x20Accept\x20header', function () {
                const _0x13ccb0 = _0x3f169f;
                return nock('http://localhost:8080')[_0x13ccb0(0x15a)](_0x13ccb0(0x167), _0x13ccb0(0x157))[_0x13ccb0(0xd4)]('/headers')[_0x13ccb0(0xd5)](0xc8), request['sendPromise']({}, this['fn'], {
                    'url': 'http://localhost:8080/headers',
                    'cookies': ![],
                    'headers': { 'Accept': _0x13ccb0(0x157) }
                })['then'](_0x50bad6 => {
                    const _0x20dc36 = _0x13ccb0;
                    expect(_0x50bad6[_0x20dc36(0x131)])['to']['eq'](0xc8);
                });
            });
        }), context('qs', () => {
            it('can\x20accept\x20qs', function () {
                const _0x10fd14 = _0x9f75;
                return nock(_0x10fd14(0x14c))['get']('/foo?bar=baz&q=1')[_0x10fd14(0xd5)](0xc8), request['sendPromise']({}, this['fn'], {
                    'url': _0x10fd14(0x15f),
                    'cookies': ![],
                    'qs': {
                        'bar': 'baz',
                        'q': 0x1
                    }
                })[_0x10fd14(0xd9)](_0x231209 => {
                    const _0x3c2b26 = _0x10fd14;
                    expect(_0x231209[_0x3c2b26(0x131)])['to']['eq'](0xc8);
                });
            });
        }), context(_0x1175d5(0x168), () => {
            const _0x1f8326 = _0x1175d5;
            beforeEach(function () {
                const _0x36748b = _0x9f75;
                this['fn'][_0x36748b(0xe1)]();
            }), it(_0x1f8326(0x169), function () {
                const _0x3afdfa = _0x1f8326;
                return nock(_0x3afdfa(0x14c))[_0x3afdfa(0xd4)]('/dashboard')[_0x3afdfa(0xd5)](0x12e, '', { 'location': _0x3afdfa(0x16a) })[_0x3afdfa(0xd4)](_0x3afdfa(0x13b))[_0x3afdfa(0xd5)](0xc8, _0x3afdfa(0x16b)), request[_0x3afdfa(0x126)]({}, this['fn'], {
                    'url': _0x3afdfa(0x16c),
                    'cookies': ![],
                    'followRedirect': !![]
                })[_0x3afdfa(0xd9)](_0x568583 => {
                    const _0x7f174a = _0x3afdfa;
                    expect(_0x568583['status'])['to']['eq'](0xc8), expect(_0x568583[_0x7f174a(0xfd)])['to']['eq'](_0x7f174a(0x16b)), expect(_0x568583)[_0x7f174a(0xf2)]['to'][_0x7f174a(0xeb)][_0x7f174a(0x16d)](_0x7f174a(0x16e));
                });
            }), it(_0x1f8326(0x16f), function () {
                const _0x446098 = _0x1f8326;
                return nock(_0x446098(0x14c))[_0x446098(0x170)]('/login')[_0x446098(0xd5)](0x12e, '', { 'location': 'http://localhost:8080/dashboard' })[_0x446098(0xd4)]('/dashboard')['reply'](0xc8, _0x446098(0x171)), request[_0x446098(0x126)]({}, this['fn'], {
                    'method': 'POST',
                    'url': _0x446098(0x16a),
                    'cookies': ![]
                })[_0x446098(0xd9)](_0x1a6f6b => {
                    const _0x58294e = _0x446098;
                    expect(_0x1a6f6b[_0x58294e(0x131)])['to']['eq'](0xc8), expect(_0x1a6f6b[_0x58294e(0xfd)])['to']['eq']('dashboard'), expect(_0x1a6f6b)[_0x58294e(0xf2)]['to'][_0x58294e(0xeb)]['property'](_0x58294e(0x16e));
                });
            }), it(_0x1f8326(0x172), function () {
                const _0x52f184 = _0x1f8326;
                return nock(_0x52f184(0x14c))[_0x52f184(0xd4)]('/dashboard')['reply'](0x12e, '', { 'location': _0x52f184(0x16a) })['get'](_0x52f184(0x13b))[_0x52f184(0xd5)](0xc8, _0x52f184(0x16b)), request['sendPromise']({}, this['fn'], {
                    'url': _0x52f184(0x16c),
                    'cookies': ![],
                    'followRedirect': ![]
                })[_0x52f184(0xd9)](_0x3c37fb => {
                    const _0x24b550 = _0x52f184;
                    expect(_0x3c37fb['status'])['to']['eq'](0x12e), expect(_0x3c37fb[_0x24b550(0xfd)])['to']['eq'](''), expect(_0x3c37fb[_0x24b550(0x16e)])['to']['eq']('http://localhost:8080/login');
                });
            }), it(_0x1f8326(0x173), function () {
                const _0x52a57a = _0x1f8326;
                return nock(_0x52a57a(0x14c))['get'](_0x52a57a(0x139))[_0x52a57a(0xd5)](0x12e, '', { 'location': _0x52a57a(0x13b) })[_0x52a57a(0xd4)](_0x52a57a(0x13b))[_0x52a57a(0xd5)](0xc8, _0x52a57a(0x16b)), request[_0x52a57a(0x126)]({}, this['fn'], {
                    'url': _0x52a57a(0x16c),
                    'cookies': ![],
                    'followRedirect': ![]
                })[_0x52a57a(0xd9)](_0x873a9f => {
                    const _0xa96456 = _0x52a57a;
                    expect(_0x873a9f[_0xa96456(0x131)])['to']['eq'](0x12e), expect(_0x873a9f['redirectedToUrl'])['to']['eq'](_0xa96456(0x16a));
                });
            }), it('resolves\x20redirectedToUrl\x20to\x20another\x20domain', function () {
                const _0x4e96e2 = _0x1f8326;
                return nock(_0x4e96e2(0x14c))[_0x4e96e2(0xd4)]('/dashboard')['reply'](0x12d, '', { 'location': _0x4e96e2(0x174) })[_0x4e96e2(0xd4)](_0x4e96e2(0x13b))[_0x4e96e2(0xd5)](0xc8, 'login'), request[_0x4e96e2(0x126)]({}, this['fn'], {
                    'url': _0x4e96e2(0x16c),
                    'cookies': ![],
                    'followRedirect': ![]
                })[_0x4e96e2(0xd9)](_0x54208a => {
                    const _0x319d96 = _0x4e96e2;
                    expect(_0x54208a[_0x319d96(0x131)])['to']['eq'](0x12d), expect(_0x54208a[_0x319d96(0x16e)])['to']['eq'](_0x319d96(0x174));
                });
            }), it(_0x1f8326(0x175), function () {
                const _0xed65eb = _0x1f8326;
                return nock('http://localhost:8080')['get'](_0xed65eb(0x139))['reply'](0x12e, '', { 'location': 'http://localhost:8080/login' })['get'](_0xed65eb(0x13b))[_0xed65eb(0xd5)](0xc8, 'login'), request['sendPromise']({}, this['fn'], {
                    'url': 'http://localhost:8080/dashboard',
                    'cookies': ![]
                })['then'](_0x221920 => {
                    const _0x519990 = _0xed65eb;
                    expect(_0x221920[_0x519990(0x131)])['to']['eq'](0xc8), expect(_0x221920)[_0x519990(0xf2)]['to'][_0x519990(0xeb)][_0x519990(0x16d)](_0x519990(0x16e));
                });
            }), it('gets\x20+\x20attaches\x20the\x20cookies\x20at\x20each\x20redirect', function () {
                return testAttachingCookiesWith(() => {
                    const _0x244a16 = _0x9f75;
                    return request[_0x244a16(0x126)]({}, this['fn'], { 'url': _0x244a16(0x176) });
                });
            });
        }), context(_0x1175d5(0x177), () => {
            const _0x2031fc = _0x1175d5;
            beforeEach(() => {
                const _0x219208 = _0x9f75;
                nock(_0x219208(0x14c))['matchHeader'](_0x219208(0x178), _0x219208(0x179))[_0x219208(0x170)](_0x219208(0x13b), _0x219208(0x17a))[_0x219208(0xd5)](0xc8, _0x219208(0x17b));
            }), it(_0x2031fc(0x17c), function () {
                const _0x227568 = _0x2031fc;
                return request[_0x227568(0x126)]({}, this['fn'], {
                    'url': 'http://localhost:8080/login',
                    'method': _0x227568(0x17d),
                    'cookies': ![],
                    'form': !![],
                    'body': {
                        'foo': 'bar',
                        'baz': _0x227568(0x17e)
                    }
                })['then'](_0x35d25f => {
                    const _0x5ac555 = _0x227568;
                    expect(_0x35d25f['status'])['to']['eq'](0xc8), expect(_0x35d25f[_0x5ac555(0xfd)])['to']['eq'](_0x5ac555(0x17b));
                });
            }), it(_0x2031fc(0x17f), function () {
                const _0xc89cb4 = _0x2031fc, _0x4d2aa0 = sinon['spy'](request['rp'][_0xc89cb4(0x121)][_0xc89cb4(0x122)], _0xc89cb4(0x123)), _0x5d105a = {
                        'foo': _0xc89cb4(0xfc),
                        'baz': 'quux'
                    };
                return request[_0xc89cb4(0x126)]({}, this['fn'], {
                    'url': _0xc89cb4(0x16a),
                    'method': _0xc89cb4(0x17d),
                    'cookies': ![],
                    'form': !![],
                    'json': !![],
                    'body': _0x5d105a
                })[_0xc89cb4(0xd9)](_0x302a01 => {
                    const _0x5bc3dc = _0xc89cb4;
                    expect(_0x302a01[_0x5bc3dc(0x131)])['to']['eq'](0xc8), expect(_0x302a01['body'])['to']['eq']('<html></html>'), expect(_0x4d2aa0)[_0x5bc3dc(0xf2)]['to']['be'][_0x5bc3dc(0x128)]({ 'body': _0x5d105a });
                });
            }), it(_0x2031fc(0x180), function () {
                const _0x1994e1 = _0x2031fc, _0x3c2b9b = sinon[_0x1994e1(0xd1)](request['rp'][_0x1994e1(0x121)][_0x1994e1(0x122)], _0x1994e1(0x123));
                return request[_0x1994e1(0x126)]({}, this['fn'], {
                    'url': _0x1994e1(0x16a),
                    'method': 'POST',
                    'cookies': ![],
                    'form': !![],
                    'json': !![],
                    'body': {
                        'foo': 'bar',
                        'baz': _0x1994e1(0x17e)
                    }
                })[_0x1994e1(0xd9)](_0x371a59 => {
                    const _0x265bf0 = _0x1994e1;
                    expect(_0x371a59[_0x265bf0(0x131)])['to']['eq'](0xc8), expect(_0x371a59['body'])['to']['eq']('<html></html>'), expect(_0x3c2b9b)[_0x265bf0(0xf2)]['to']['be'][_0x265bf0(0x128)]({ 'json': !![] });
                });
            });
        }), context('bad\x20headers', () => {
            const _0x6415ca = _0x1175d5;
            beforeEach(function (_0x23fd69) {
                const _0x50737e = _0x9f75;
                this[_0x50737e(0x10b)] = http['createServer']((_0x48edb2, _0x32b933) => {
                    const _0x33eece = _0x50737e;
                    _0x32b933[_0x33eece(0x106)](0xc8), _0x32b933[_0x33eece(0x181)]();
                }), this[_0x50737e(0x10b)]['listen'](0x2704, _0x23fd69);
            }), afterEach(function () {
                const _0x5158f4 = _0x9f75;
                return this[_0x5158f4(0x10b)][_0x5158f4(0x10d)]();
            }), it('recovers\x20from\x20bad\x20headers', function () {
                const _0x1682b9 = _0x9f75;
                return request[_0x1682b9(0x126)]({}, this['fn'], {
                    'url': 'http://localhost:9988/foo',
                    'cookies': ![],
                    'headers': { 'x-text': _0x1682b9(0x182) }
                })[_0x1682b9(0xd9)](() => {
                    const _0x5c890b = _0x1682b9;
                    throw new Error(_0x5c890b(0x183));
                })[_0x1682b9(0x11f)](_0x210e9f => {
                    const _0x14d588 = _0x1682b9;
                    expect(_0x210e9f[_0x14d588(0x149)])['to']['eq'](_0x14d588(0x184));
                });
            }), it(_0x6415ca(0x185), function () {
                const _0x2f0dbb = _0x6415ca;
                return request[_0x2f0dbb(0x126)]({}, this['fn'], {
                    'url': _0x2f0dbb(0x186),
                    'cookies': ![],
                    'json': !![],
                    'body': { 'x-text': 'אבגד' }
                });
            });
        });
    }), context('#sendStream', () => {
        const _0x81861a = _0x4fae09;
        it('allows\x20overriding\x20user-agent\x20in\x20headers', function () {
            const _0x1a95a9 = _0x9f75;
            nock(_0x1a95a9(0x14c))[_0x1a95a9(0x15a)](_0x1a95a9(0x15b), 'custom-agent')[_0x1a95a9(0xd4)](_0x1a95a9(0x124))['reply'](0xc8, _0x1a95a9(0x15c)), sinon[_0x1a95a9(0xd1)](request, _0x1a95a9(0x111)), this['fn']['resolves']({});
            const _0x604666 = { 'user-agent': 'test' }, _0x1f8db5 = {
                    'url': 'http://localhost:8080/foo',
                    'cookies': ![],
                    'headers': { 'user-agent': _0x1a95a9(0x163) }
                };
            return request[_0x1a95a9(0x187)](_0x604666, this['fn'], _0x1f8db5)[_0x1a95a9(0xd9)](_0x4cfd1a => {
                const _0x13761e = _0x1a95a9;
                _0x4cfd1a(), expect(request['create'])['to']['be'][_0x13761e(0xff)], expect(request[_0x13761e(0x111)])['to']['be'][_0x13761e(0xec)](_0x1f8db5);
            });
        }), it(_0x81861a(0x188), function () {
            return testAttachingCookiesWith(() => {
                const _0x14c3da = _0x9f75;
                return request[_0x14c3da(0x187)]({}, this['fn'], {
                    'url': _0x14c3da(0x176),
                    'followRedirect': _[_0x14c3da(0x189)]
                })[_0x14c3da(0xd9)](_0x2a6643 => {
                    const _0x5134fa = _0x2a6643();
                    return new Promise((_0x144fbd, _0x3d1f28) => {
                        const _0x34bec6 = _0x9f75;
                        _0x5134fa['on'](_0x34bec6(0x18a), _0x144fbd), _0x5134fa['on'](_0x34bec6(0x114), _0x3d1f28);
                    });
                });
            });
        });
    });
});
