const v8=require(`v8`);const fs=require(`fs-extra`);const{createContentDigest}=require(`gatsby-core-utils`);const path=require(`path`);const slash=require(`slash`);const sanitizePageCreatorPluginOptions=e=>{if(e&&e.path){return{...e,path:slash(path.relative(process.cwd(),e.path))}}return e};const sanitiseNode=e=>{if(e&&e.internal&&e.internal.contentDigest){if(e.internal.type===`SiteBuildMetadata`){delete e.buildTime;delete e.internal.contentDigest}if(e.internal.type===`SitePlugin`){delete e.packageJson;delete e.internal.contentDigest;delete e.version;if(e.name===`gatsby-plugin-page-creator`){e.id=createContentDigest(`${e.name}${JSON.stringify(sanitizePageCreatorPluginOptions(e.pluginOptions))}`)}}if(e.internal.type===`SitePage`){delete e.internal.contentDigest;delete e.internal.description;delete e.pluginCreatorId;delete e.pluginCreator___NODE}}delete e.internal.counter;return e};const loadState=e=>{const t=v8.deserialize(fs.readFileSync(e));const n=t.nodes.map(sanitiseNode);const i=new Map;n.sort((e,t)=>e.id.localeCompare(t.id)).forEach(e=>{i.set(e.id,e)});return{nodes:i,diskCacheSnapshot:t.diskCacheSnapshot,queryResults:t.queryResults}};exports.loadState=loadState;