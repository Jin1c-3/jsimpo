'use babel';import _0x5c6e94 from'atom-select-list';import _0x52865a from'./helpers';export default class DiffListView{constructor(){var bFfLrv={'Tjbod':function(x,y){return x!==y;},'GXtth':'yoPIv','uHUDP':'oGZoC','TYeAQ':'two-lines','unRIs':'div','ceLkq':'primary-line','lvMEL':'secondary-line','SFacM':function(x,y){return x-y;},'VljsH':function(x,y){return x>y;},'xMvgd':function(x,y){return x-y;},'dGDvd':'No diffs in file','rflHE':'diff-list-view'};this['selectListView']=new _0x5c6e94({'emptyMessage':bFfLrv['dGDvd'],'items':[],'filterKeyForItem':diff=>diff['lineText'],'elementForItem':diff=>{if(bFfLrv['Tjbod'](bFfLrv['GXtth'],bFfLrv['uHUDP'])){const li=document['createElement']('li');li['classList']['add'](bFfLrv['TYeAQ']);const primaryLine=document['createElement'](bFfLrv['unRIs']);primaryLine['classList']['add'](bFfLrv['ceLkq']);primaryLine['textContent']=diff['lineText'];li['appendChild'](primaryLine);const secondaryLine=document['createElement']('div');secondaryLine['classList']['add'](bFfLrv['lvMEL']);secondaryLine['textContent']='-'+diff['oldStart']+','+diff['oldLines']+'\x20+'+diff['newStart']+','+diff['newLines'];li['appendChild'](secondaryLine);return li;}else{this['panel']['hide']();if(this['previouslyFocusedElement']){this['previouslyFocusedElement']['focus']();this['previouslyFocusedElement']=null;}}},'didConfirmSelection':diff=>{if(bFfLrv['Tjbod']('nvOuM','nvOuM')){this['cancel']();const _0x3e0ff1=diff['newStart']>0x0?bFfLrv['SFacM'](diff['newStart'],0x1):diff['newStart'];this['editor']['setCursorBufferPosition']([_0x3e0ff1,0x0],{'autoscroll':!![]});this['editor']['moveToFirstCharacterOfLine']();}else{this['cancel']();const bufferRow=bFfLrv['VljsH'](diff['newStart'],0x0)?bFfLrv['xMvgd'](diff['newStart'],0x1):diff['newStart'];this['editor']['setCursorBufferPosition']([bufferRow,0x0],{'autoscroll':!![]});this['editor']['moveToFirstCharacterOfLine']();}},'didCancelSelection':()=>{this['cancel']();}});this['selectListView']['element']['classList']['add'](bFfLrv['rflHE']);this['panel']=atom['workspace']['addModalPanel']({'item':this['selectListView'],'visible':![]});}['attach'](){this['previouslyFocusedElement']=document['activeElement'];this['selectListView']['reset']();this['panel']['show']();this['selectListView']['focus']();}['cancel'](){this['panel']['hide']();if(this['previouslyFocusedElement']){this['previouslyFocusedElement']['focus']();this['previouslyFocusedElement']=null;}}['destroy'](){this['cancel']();this['panel']['destroy']();return this['selectListView']['destroy']();}async['toggle'](){var mfGrnH={'xZXel':function(x,y){return x>y;},'ETvyQ':function(x,y){return x-y;},'XGaFr':function(x,y){return x===y;},'rnHLx':'nTeZX','ARvPk':function(callee,param1){return callee(param1);},'CzcgJ':'eBHIb'};const editor=atom['workspace']['getActiveTextEditor']();if(this['panel']['isVisible']()){if(mfGrnH['XGaFr']('AjYjZ','AjYjZ')){this['cancel']();}else{const _0x2abc3d=mfGrnH['xZXel'](diff['newStart'],0x0)?mfGrnH['ETvyQ'](diff['newStart'],0x1):diff['newStart'];const _0x48edca=this['editor']['lineTextForBufferRow'](_0x2abc3d);diff['lineText']=_0x48edca?_0x48edca['trim']():'';}}else if(editor){if(mfGrnH['XGaFr']('nTeZX',mfGrnH['rnHLx'])){this['editor']=editor;const repository=await mfGrnH['ARvPk'](_0x52865a,this['editor']['getPath']());let diffs=repository?repository['getLineDiffs'](this['editor']['getPath'](),this['editor']['getText']()):[];if(!diffs)diffs=[];for(let diff of diffs){if(mfGrnH['XGaFr'](mfGrnH['CzcgJ'],mfGrnH['CzcgJ'])){const bufferRow=diff['newStart']>0x0?mfGrnH['ETvyQ'](diff['newStart'],0x1):diff['newStart'];const lineText=this['editor']['lineTextForBufferRow'](bufferRow);diff['lineText']=lineText?lineText['trim']():'';}else{this['previouslyFocusedElement']=document['activeElement'];this['selectListView']['reset']();this['panel']['show']();this['selectListView']['focus']();}}await this['selectListView']['update']({'items':diffs});this['attach']();}else{this['cancel']();this['panel']['destroy']();return this['selectListView']['destroy']();}}}}