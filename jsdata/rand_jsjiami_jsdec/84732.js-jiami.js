import*as _0x4c27fe from'../../../src/js/tech/middleware.js';import _0xb588e5 from'sinon';import _0x63d9d3 from'global/window';QUnit['module']('Middleware',{'beforeEach'(assert){this['clock']=_0xb588e5['useFakeTimers']();},'afterEach'(assert){this['clock']['restore']();}});QUnit['test']('middleware can be added with the use method',function(assert){var olwMpk={'iXbAh':'foo','EakTC':'we are able to add middleware'};const myMw={};const mwFactory=()=>myMw;_0x4c27fe['use']('foo',mwFactory);assert['equal'](_0x4c27fe['getMiddleware'](olwMpk['iXbAh'])['pop'](),mwFactory,olwMpk['EakTC']);});QUnit['test']('middleware get iterates through the middleware array in the right order',function(assert){var qWmPjO={'JDZEu':function(callee,param1,param2){return callee(param1,param2);},'vqUhW':'video/mp4','Jhjul':function(x,y){return x!==y;},'uoINL':'NrVjB','nXHUg':function(x,y){return x*y;},'FdAQH':function(x,y){return x!==y;},'pqJSx':'QqZKe','VprfZ':function(x,y){return x/y;},'aLCNW':function(x,y){return x+y;},'AVLrs':function(x,y){return x/y;},'FWvJc':function(x,y){return x===y;},'bmcqc':'FJHle','PUvcI':'eSATm','YzGQj':function(x,y){return x!==y;},'dWbpp':'myOwP','LAKSU':'currentTime','xzokS':'duration','hMfrh':'foo','pOTAu':function(callee,param1,param2,param3,param4,param5){return callee(param1,param2,param3,param4,param5);},'uxsyL':function(callee,param1,param2,param3,param4,param5){return callee(param1,param2,param3,param4,param5);}};const cts=[];const durs=[];const foos=[];const mws=[{'currentTime'(ct){var TBWmRU={'jzIno':function(callee,param1,param2){return qWmPjO['JDZEu'](callee,param1,param2);},'iTxXH':'http://example.com/video.mp4','OpmdC':qWmPjO['vqUhW']};if(qWmPjO['Jhjul']('NrVjB',qWmPjO['uoINL'])){TBWmRU['jzIno'](next,null,{'src':TBWmRU['iTxXH'],'type':TBWmRU['OpmdC']});}else{cts['push'](ct);return qWmPjO['nXHUg'](ct,0x2);}},'duration'(dur){durs['push'](dur);return dur+0x2;},'foo'(f){if(qWmPjO['FdAQH']('QqZKe',qWmPjO['pqJSx'])){mwfactoryCalled++;return mw;}else{foos['push'](f);return qWmPjO['VprfZ'](f,0x2);}}},{'currentTime'(ct){cts['push'](ct);return qWmPjO['aLCNW'](ct,0x2);},'duration'(dur){durs['push'](dur);return qWmPjO['AVLrs'](dur,0x2);},'foo'(f){foos['push'](f);return qWmPjO['aLCNW'](f,0x3);}}];const tech={'currentTime'(ct){if(qWmPjO['FWvJc'](qWmPjO['bmcqc'],qWmPjO['PUvcI'])){cts['push'](ct);return ct+0x2;}else{return 0x5;}},'duration'(dur){return 0x5;},'foo'(f){if(qWmPjO['YzGQj']('pKRTs',qWmPjO['dWbpp'])){return 0x5;}else{playsToTech++;}}};const ct=_0x4c27fe['get'](mws,tech,qWmPjO['LAKSU']);const dur=_0x4c27fe['get'](mws,tech,qWmPjO['xzokS']);const foo=_0x4c27fe['get'](mws,tech,qWmPjO['hMfrh']);const assertion=(actual,expected,actualArr,expectedArr,type)=>{assert['equal'](actual,expected,'our middleware chain return currectly for '+type);assert['deepEqual'](actualArr,expectedArr,'we got called in the correct order for '+type);};qWmPjO['pOTAu'](assertion,ct,0xe,cts,[0x5,0x7],qWmPjO['LAKSU']);qWmPjO['uxsyL'](assertion,dur,4.5,durs,[0x5,2.5],'duration');assertion(foo,0x4,foos,[0x5,0x8],'foo');});QUnit['test']('middleware\x20set\x20iterates\x20through\x20the\x20middleware\x20array\x20in\x20the\x20right\x20order',function(assert){var pXxIsF={'UVqym':function(x,y){return x/y;},'zlAnG':function(x,y){return x===y;},'FGAsR':'OBuZn','upLke':function(x,y){return x*y;},'BdCHC':'video/bar','oYHOG':function(x,y){return x!==y;},'SZbNf':'IDMSu','oashW':function(callee,param1,param2){return callee(param1,param2);},'LTAzf':'bar','YoxOs':'video/foo','EBgfc':'EeyyL','Aebgc':function(x,y){return x+y;},'UOuAo':function(x,y){return x/y;},'QROvP':'RoIvt','bPCXF':'EtLDl','LLTwm':function(x,y){return x===y;},'pjFfZ':'mFYQJ','COfcM':'currentTime','ltXUE':'duration','Qxszc':function(callee,param1,param2,param3,param4,param5){return callee(param1,param2,param3,param4,param5);},'GReNK':'foo'};const cts=[];const durs=[];const foos=[];const mws=[{'currentTime'(ct){if(pXxIsF['zlAnG']('qjYmz',pXxIsF['FGAsR'])){durs['push'](dur);return pXxIsF['UVqym'](dur,0x2);}else{cts['push'](ct);return pXxIsF['upLke'](ct,0x2);}},'duration'(dur){if(pXxIsF['oYHOG'](pXxIsF['SZbNf'],pXxIsF['SZbNf'])){next(null,{'src':'bar','type':pXxIsF['BdCHC']});}else{durs['push'](dur);return dur+0x2;}},'foo'(f){foos['push'](f);return f/0x2;}},{'currentTime'(ct){var BaQzDl={'qjcQc':function(callee,param1,param2){return pXxIsF['oashW'](callee,param1,param2);},'gmELl':pXxIsF['LTAzf'],'jgNNt':pXxIsF['YoxOs']};if(pXxIsF['zlAnG'](pXxIsF['EBgfc'],pXxIsF['EBgfc'])){cts['push'](ct);return pXxIsF['Aebgc'](ct,0x2);}else{BaQzDl['qjcQc'](next,null,{'src':BaQzDl['gmELl'],'type':BaQzDl['jgNNt']});}},'duration'(dur){durs['push'](dur);return dur/0x2;},'foo'(f){foos['push'](f);return pXxIsF['Aebgc'](f,0x3);}}];const tech={'currentTime'(ct){cts['push'](ct);return pXxIsF['UOuAo'](ct,0x2);},'duration'(dur){if(pXxIsF['QROvP']!==pXxIsF['bPCXF']){durs['push'](dur);return dur;}else{mwfactoryCalled++;return mw;}},'foo'(f){foos['push'](f);return f;}};const ct=_0x4c27fe['set'](mws,tech,pXxIsF['COfcM'],0xa);const dur=_0x4c27fe['set'](mws,tech,pXxIsF['ltXUE'],0xa);const foo=_0x4c27fe['set'](mws,tech,'foo',0xa);const assertion=(actual,expected,actualArr,expectedArr,type)=>{if(pXxIsF['LLTwm'](pXxIsF['pjFfZ'],pXxIsF['pjFfZ'])){assert['equal'](actual,expected,'our middleware chain return currectly for '+type);assert['deepEqual'](actualArr,expectedArr,'we got called in the correct order for '+type);}else{return 0x5;}};assertion(ct,0xb,cts,[0xa,0x14,0x16],'currentTime');assertion(dur,0x6,durs,[0xa,0xc,0x6],'duration');pXxIsF['Qxszc'](assertion,foo,0x8,foos,[0xa,0x5,0x8],pXxIsF['GReNK']);});QUnit['test']('middleware mediate iterates through the middleware array twice',function(assert){var ONLXAy={'NKYeB':'vid1','oGBDk':'video/foo','OXHCZ':'foo','HoXIU':function(x,y){return x!==y;},'ekIIB':'JdHTT','EEvYz':'kGahZ','IiMfE':'play','wfuEF':'middleware got called the same number of times','pMMEp':'the value returned by the tech is passed through the middleware','EjLkQ':'the\x20value\x20returned\x20to\x20the\x20player\x20is\x20the\x20value\x20returned\x20from\x20the\x20tech','rQrPV':'the play has not been cancelled in middleware 1'};let playsToTech=0x0;let playsToPlayer=0x0;let techPlays=0x0;let techPlay;let pv1;let pv2;let pc1;let pc2;const mws=[{'callPlay'(){playsToTech++;},'play'(cancelled,value){var mGcxgB={'qCrKv':ONLXAy['NKYeB'],'NcFRz':ONLXAy['oGBDk'],'rPRVA':ONLXAy['OXHCZ']};if(ONLXAy['HoXIU'](ONLXAy['ekIIB'],ONLXAy['EEvYz'])){playsToPlayer++;pv1=value;pc1=cancelled;}else{let _0xddc41=[];const _0x387cf3={'currentTime'(_0x2a3a70){}};const _0x512bac=()=>_0x387cf3;_0x4c27fe['use'](mGcxgB['NcFRz'],_0x512bac);_0x4c27fe['setSource']({'id'(){return mGcxgB['qCrKv'];},'setTimeout':_0x63d9d3['setTimeout']},{'src':mGcxgB['rPRVA'],'type':mGcxgB['NcFRz']},function(_0x5a1be4,_0x41f451){_0xddc41=_0x41f451;});this['clock']['tick'](0x1);assert['equal'](_0xddc41['length'],0x1,'we have 1 middleware set');_0x4c27fe['getMiddleware']('video/foo')['pop']();}}},{'callPlay'(){playsToTech++;},'play'(cancelled,value){playsToPlayer++;pv2=value;pc2=cancelled;}}];const tech={'play'(){techPlays++;techPlay={'then':()=>{}};return techPlay;}};const pp=_0x4c27fe['mediate'](mws,tech,ONLXAy['IiMfE']);assert['equal'](playsToTech,playsToPlayer,ONLXAy['wfuEF']);assert['equal'](playsToTech,0x2,'both\x20middleware\x20got\x20called\x20before\x20the\x20tech');assert['equal'](techPlays,0x1,'the tech method only gets called once');assert['equal'](playsToPlayer,0x2,'both middleware got called after the tech');assert['deepEqual'](pv1['then'],techPlay['then'],'the value returned by the tech is passed through the middleware');assert['deepEqual'](pv2,techPlay,ONLXAy['pMMEp']);assert['deepEqual'](pp,techPlay,ONLXAy['EjLkQ']);assert['equal'](pc1,![],ONLXAy['rQrPV']);assert['equal'](pc2,![],'the\x20play\x20has\x20not\x20been\x20cancelled\x20in\x20middleware\x202');});QUnit['test']('middleware\x20mediate\x20allows\x20and\x20can\x20detect\x20cancellation',function(assert){var KyhuJu={'ECuAo':function(x,y){return x/y;},'LiYar':function(x,y){return x===y;},'SdpJV':'IsHEV','Hyqwg':'JtyjI','OIuDp':'pqeHz','Yzebe':function(x,y){return x!==y;},'esaUt':'HNqPz','vVoTA':'UKckc','MBcIy':'both middleware run until middleware terminates','rcxaa':'the tech should not be called if a middleware terminates','ELzNV':'both\x20middleware\x20run\x20after\x20the\x20tech','hLyrb':'null\x20is\x20returned\x20through\x20the\x20middleware\x20if\x20a\x20middleware\x20terminated\x20previously','nsXfQ':'the play has been cancelled in middleware 2'};let playsToTech=0x0;let playsToPlayer=0x0;let techPlays=0x0;let pv1;let pv2;let pc1;let pc2;const mws=[{'callPlay'(){if(KyhuJu['LiYar'](KyhuJu['SdpJV'],KyhuJu['SdpJV'])){playsToTech++;}else{durs['push'](dur);return KyhuJu['ECuAo'](dur,0x2);}},'play'(cancelled,value){playsToPlayer++;pv1=value;pc1=cancelled;}},{'callPlay'(){if(KyhuJu['Hyqwg']===KyhuJu['OIuDp']){playsToPlayer++;pv1=value;pc1=cancelled;}else{playsToTech++;return _0x4c27fe['TERMINATOR'];}},'play'(cancelled,value){playsToPlayer++;pv2=value;pc2=cancelled;}}];const tech={'play'(){if(KyhuJu['Yzebe'](KyhuJu['esaUt'],KyhuJu['vVoTA'])){techPlays++;return{'then':()=>{}};}else{src=_src;acc=_acc;}}};const pp=_0x4c27fe['mediate'](mws,tech,'play');assert['equal'](playsToTech,0x2,KyhuJu['MBcIy']);assert['equal'](techPlays,0x0,KyhuJu['rcxaa']);assert['equal'](playsToPlayer,0x2,KyhuJu['ELzNV']);assert['equal'](pv1,null,KyhuJu['hLyrb']);assert['equal'](pv2,null,KyhuJu['hLyrb']);assert['equal'](pp,null,'null is returned to the player if a middleware terminated previously');assert['equal'](pc1,!![],'the play has been cancelled in middleware 1');assert['equal'](pc2,!![],KyhuJu['nsXfQ']);});QUnit['test']('setSource\x20is\x20run\x20asynchronously',function(assert){var YhONho={'ycHFu':'vid1','rGxJf':'FwnDn','RAwvY':'OIqxh','ulIbN':'foo','ojKlL':'video/foo','AAhjX':'no src was returned yet','fHJjW':'no accumulator was returned yet','kQJvR':'we got the same source back','mLqas':'we did not accumulate any middleware since there were none'};let src;let acc;_0x4c27fe['setSource']({'id'(){return'vid1';},'setTimeout':_0x63d9d3['setTimeout']},{'src':YhONho['ulIbN'],'type':YhONho['ojKlL']},function(_src,_acc){var oyEvgg={'gJEWT':YhONho['ycHFu']};if(YhONho['rGxJf']!==YhONho['RAwvY']){src=_src;acc=_acc;}else{return oyEvgg['gJEWT'];}});assert['equal'](src,undefined,YhONho['AAhjX']);assert['equal'](acc,undefined,YhONho['fHJjW']);this['clock']['tick'](0x1);assert['deepEqual'](src,{'src':'foo','type':'video/foo'},YhONho['kQJvR']);assert['equal'](acc['length'],0x0,YhONho['mLqas']);});QUnit['test']('setSource selects a source based on the middleware given',function(assert){var JqPXMa={'Lgjrm':function(callee,param1,param2){return callee(param1,param2);},'ECacJ':'http://example.com/video.mp4','skLud':'video/mp4','ffBMg':'video/foo','wOEwV':'we selected a new type of video/mp4','FVlSC':'we selected a new src of video.mp4','YtsDM':'we chose the one middleware'};let src;let acc;const mw={'setSource'(_src,next){JqPXMa['Lgjrm'](next,null,{'src':JqPXMa['ECacJ'],'type':JqPXMa['skLud']});}};const fooFactory=()=>mw;_0x4c27fe['use'](JqPXMa['ffBMg'],fooFactory);_0x4c27fe['setSource']({'id'(){return'vid1';},'setTimeout':_0x63d9d3['setTimeout']},{'src':'foo','type':JqPXMa['ffBMg']},function(_src,_acc){src=_src;acc=_acc;});this['clock']['tick'](0x1);assert['equal'](src['type'],JqPXMa['skLud'],JqPXMa['wOEwV']);assert['equal'](src['src'],JqPXMa['ECacJ'],JqPXMa['FVlSC']);assert['equal'](acc['length'],0x1,'we got one middleware');assert['equal'](acc[0x0],mw,JqPXMa['YtsDM']);_0x4c27fe['getMiddleware'](JqPXMa['ffBMg'])['pop']();});QUnit['test']('setSource can select multiple middleware from multiple types',function(assert){var QeAGQv={'kMpOe':'video/bar','SXqiq':function(callee,param1,param2){return callee(param1,param2);},'hMgJi':'http://example.com/video.mp4','uuYoW':'video/mp4','NWZKh':'vid1','PHnQY':'video/foo','TkZUA':'foo','nvXaW':'we selected a new type of video/mp4','rIKkc':'we\x20selected\x20a\x20new\x20src\x20of\x20video.mp4'};let src;let acc;const foomw={'setSource'(_src,next){next(null,{'src':'bar','type':QeAGQv['kMpOe']});}};const barmw={'setSource'(_src,next){QeAGQv['SXqiq'](next,null,{'src':QeAGQv['hMgJi'],'type':QeAGQv['uuYoW']});}};const fooFactory=()=>foomw;const barFactory=()=>barmw;_0x4c27fe['use'](QeAGQv['PHnQY'],fooFactory);_0x4c27fe['use']('video/bar',barFactory);_0x4c27fe['setSource']({'id'(){return QeAGQv['NWZKh'];},'setTimeout':_0x63d9d3['setTimeout']},{'src':QeAGQv['TkZUA'],'type':QeAGQv['PHnQY']},function(_src,_acc){src=_src;acc=_acc;});this['clock']['tick'](0x1);assert['equal'](src['type'],QeAGQv['uuYoW'],QeAGQv['nvXaW']);assert['equal'](src['src'],'http://example.com/video.mp4',QeAGQv['rIKkc']);assert['equal'](acc['length'],0x2,'we got two middleware');assert['equal'](acc[0x0],foomw,'foomw\x20is\x20the\x20first\x20middleware');assert['equal'](acc[0x1],barmw,'barmw is the first middleware');_0x4c27fe['getMiddleware'](QeAGQv['PHnQY'])['pop']();_0x4c27fe['getMiddleware']('video/bar')['pop']();});QUnit['test']('setSource will select all middleware of a given type, until src change',function(assert){var zktbhd={'HeuFA':function(callee,param1,param2){return callee(param1,param2);},'stgDg':'video/foo','psQUw':function(x,y){return x!==y;},'dBmUJ':'sTvfA','uDAbh':function(x,y){return x===y;},'DWufx':'JExCi','VcViO':'uTjKJ','rykSR':'http://example.com/video.mp4','ONAzC':'video/mp4','JAoVs':'vid1','CeYSX':'aBIUe','nqYeJ':'foo','AWRaS':'we selected a new type of video/mp4','vXoMJ':'we\x20selected\x20a\x20new\x20src\x20of\x20video.mp4','YRGip':'we got two middleware','yNPRJ':'foomw\x20is\x20the\x20first\x20middleware'};let src;let acc;const foomw1={'setSource'(_src,next){zktbhd['HeuFA'](next,null,{'src':'bar','type':zktbhd['stgDg']});}};const foomw2={'setSource'(_src,next){if(zktbhd['psQUw'](zktbhd['dBmUJ'],zktbhd['dBmUJ'])){playsToTech++;}else{zktbhd['HeuFA'](next,null,{'src':'http://example.com/video.mp4','type':'video/mp4'});}}};const foomw3={'setSource'(_src,next){if(zktbhd['uDAbh'](zktbhd['DWufx'],zktbhd['VcViO'])){techPlays++;return{'then':()=>{}};}else{zktbhd['HeuFA'](next,null,{'src':zktbhd['rykSR'],'type':zktbhd['ONAzC']});}}};const fooFactory1=()=>foomw1;const fooFactory2=()=>foomw2;const fooFactory3=()=>foomw3;_0x4c27fe['use']('video/foo',fooFactory1);_0x4c27fe['use'](zktbhd['stgDg'],fooFactory2);_0x4c27fe['use'](zktbhd['stgDg'],fooFactory3);_0x4c27fe['setSource']({'id'(){return zktbhd['JAoVs'];},'setTimeout':_0x63d9d3['setTimeout']},{'src':zktbhd['nqYeJ'],'type':'video/foo'},function(_src,_acc){if('bvbvU'!==zktbhd['CeYSX']){src=_src;acc=_acc;}else{assert['equal'](actual,expected,'our middleware chain return currectly for '+type);assert['deepEqual'](actualArr,expectedArr,'we got called in the correct order for '+type);}});this['clock']['tick'](0x1);assert['equal'](src['type'],zktbhd['ONAzC'],zktbhd['AWRaS']);assert['equal'](src['src'],zktbhd['rykSR'],zktbhd['vXoMJ']);assert['equal'](acc['length'],0x2,zktbhd['YRGip']);assert['equal'](acc[0x0],foomw1,zktbhd['yNPRJ']);assert['equal'](acc[0x1],foomw2,zktbhd['yNPRJ']);_0x4c27fe['getMiddleware']('video/foo')['pop']();_0x4c27fe['getMiddleware'](zktbhd['stgDg'])['pop']();_0x4c27fe['getMiddleware'](zktbhd['stgDg'])['pop']();});QUnit['test']('a middleware without a mediator method will not throw an error',function(assert){var aQczvk={'kBujk':function(callee){return callee();},'AyvtN':'pauseCalled\x20was\x20called\x20once\x20and\x20no\x20error\x20was\x20thrown'};let pauseCalled=0x0;const myMw={};const mwFactory=()=>myMw;const mwFactory2=()=>({'pause'(){pauseCalled++;}});_0x4c27fe['mediate']([aQczvk['kBujk'](mwFactory),mwFactory2()],{'pause':()=>{}},'pause');assert['equal'](pauseCalled,0x1,aQczvk['AyvtN']);});QUnit['test']('a\x20middleware\x20factory\x20is\x20not\x20called\x20on\x20source\x20change',function(assert){var uGtUjr={'ZyVVe':function(callee,param1,param2){return callee(param1,param2);},'kZAml':'http://example.com/video.mp4','sZwqI':function(x,y){return x+y;},'ddKAD':function(x,y){return x!==y;},'LvcBM':'ZUcFY','NdeFW':'vid1','NrzfT':'video/foo','GULia':'foo','LPFGi':'the\x20factory\x20was\x20called\x20once','qToWN':'the\x20factory\x20was\x20not\x20called\x20again'};let mwfactoryCalled=0x0;const mw={'setSource'(_src,next){uGtUjr['ZyVVe'](next,null,{'src':uGtUjr['kZAml'],'type':'video/mp4'});}};const fooFactory=()=>{if(uGtUjr['ddKAD']('aMitU',uGtUjr['LvcBM'])){mwfactoryCalled++;return mw;}else{foos['push'](f);return uGtUjr['sZwqI'](f,0x3);}};_0x4c27fe['use'](uGtUjr['NrzfT'],fooFactory);_0x4c27fe['setSource']({'id'(){return uGtUjr['NdeFW'];},'setTimeout':_0x63d9d3['setTimeout']},{'src':uGtUjr['GULia'],'type':uGtUjr['NrzfT']},function(){});this['clock']['tick'](0x1);assert['equal'](mwfactoryCalled,0x1,uGtUjr['LPFGi']);_0x4c27fe['setSource']({'id'(){return uGtUjr['NdeFW'];},'setTimeout':_0x63d9d3['setTimeout']},{'src':'bar','type':uGtUjr['NrzfT']},function(){});this['clock']['tick'](0x1);assert['equal'](mwfactoryCalled,0x1,uGtUjr['qToWN']);_0x4c27fe['getMiddleware']('video/foo')['pop']();});QUnit['test']('a middleware factory is called on a new source with a new player',function(assert){var KdWULN={'vuCMY':function(callee,param1,param2){return callee(param1,param2);},'lbzwE':'http://example.com/video.mp4','BvSfG':function(x,y){return x+y;},'IoJbF':function(x,y){return x!==y;},'QLubI':'WEMEb','XEvKE':'vid1','aRnuJ':function(x,y){return x!==y;},'zbwSI':'vid2','xUDzK':'foo','ZqwjZ':'the factory was called once','DwcUO':'the factory was called again','GvAsu':'video/foo'};let mwfactoryCalled=0x0;const mw={'setSource'(_src,next){KdWULN['vuCMY'](next,null,{'src':KdWULN['lbzwE'],'type':'video/mp4'});}};const fooFactory=()=>{if(KdWULN['IoJbF'](KdWULN['QLubI'],KdWULN['QLubI'])){foos['push'](f);return KdWULN['BvSfG'](f,0x3);}else{mwfactoryCalled++;return mw;}};_0x4c27fe['use']('video/foo',fooFactory);_0x4c27fe['setSource']({'id'(){return KdWULN['XEvKE'];},'setTimeout':_0x63d9d3['setTimeout']},{'src':KdWULN['xUDzK'],'type':'video/foo'},function(){});this['clock']['tick'](0x1);assert['equal'](mwfactoryCalled,0x1,KdWULN['ZqwjZ']);_0x4c27fe['setSource']({'id'(){if(KdWULN['aRnuJ']('OKCTK','OKCTK')){mws=_mws;}else{return KdWULN['zbwSI'];}},'setTimeout':_0x63d9d3['setTimeout']},{'src':'bar','type':'video/foo'},function(){});this['clock']['tick'](0x1);assert['equal'](mwfactoryCalled,0x2,KdWULN['DwcUO']);_0x4c27fe['getMiddleware'](KdWULN['GvAsu'])['pop']();});QUnit['test']('a\x20middleware\x20without\x20a\x20setSource\x20gets\x20chosen\x20implicitly',function(assert){var JOSmeO={'vfHhi':'vid1','ZaLcC':'foo','vUOES':'video/foo','tVpQD':'we have 1 middleware set'};let mws=[];const mw={'currentTime'(ct){}};const mwFactory=()=>mw;_0x4c27fe['use']('video/foo',mwFactory);_0x4c27fe['setSource']({'id'(){return JOSmeO['vfHhi'];},'setTimeout':_0x63d9d3['setTimeout']},{'src':JOSmeO['ZaLcC'],'type':JOSmeO['vUOES']},function(src,_mws){mws=_mws;});this['clock']['tick'](0x1);assert['equal'](mws['length'],0x1,JOSmeO['tVpQD']);_0x4c27fe['getMiddleware']('video/foo')['pop']();});