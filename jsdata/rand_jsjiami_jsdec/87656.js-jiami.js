import _0x3cfbd8 from'./platform.base';import{_getParentNode,getRelativePosition,supportsEventListenerOptions,readUsedSize,getMaximumSize}from'../helpers/helpers.dom';import{throttled}from'../helpers/helpers.extras';import{isNullOrUndef}from'../helpers/helpers.core';const EXPANDO_KEY='$chartjs';const EVENT_TYPES={'touchstart':'mousedown','touchmove':'mousemove','touchend':'mouseup','pointerenter':'mouseenter','pointerdown':'mousedown','pointermove':'mousemove','pointerup':'mouseup','pointerleave':'mouseout','pointerout':'mouseout'};const isNullOrEmpty=value=>value===null||value==='';function initCanvas(canvas,aspectRatio){var hSsxse={'qOmTV':function(x,y){return x===y;},'mZPRb':function(x,y){return x/y;},'iIdIu':function(x,y){return x||y;},'rPjmj':function(callee,param1,param2){return callee(param1,param2);},'XYkXr':'height','ssVue':function(x,y){return x!==y;},'ogVUO':function(x,y){return x!==y;},'sawUn':'width','mBsdo':'block','OJXtB':function(callee,param1){return callee(param1);},'NWZjs':function(callee,param1,param2){return callee(param1,param2);},'petIb':function(x,y){return x===y;},'xYezs':'KhfJN','mfTVt':function(x,y){return x!==y;},'bosyH':'plrJW'};const style=canvas['style'];const renderHeight=canvas['getAttribute'](hSsxse['XYkXr']);const renderWidth=canvas['getAttribute'](hSsxse['sawUn']);canvas[EXPANDO_KEY]={'initial':{'height':renderHeight,'width':renderWidth,'style':{'display':style['display'],'height':style['height'],'width':style['width']}}};style['display']=style['display']||hSsxse['mBsdo'];style['boxSizing']=style['boxSizing']||'border-box';if(hSsxse['OJXtB'](isNullOrEmpty,renderWidth)){const displayWidth=hSsxse['NWZjs'](readUsedSize,canvas,'width');if(displayWidth!==undefined){canvas['width']=displayWidth;}}if(isNullOrEmpty(renderHeight)){if(hSsxse['petIb'](canvas['style']['height'],'')){canvas['height']=canvas['width']/hSsxse['iIdIu'](aspectRatio,0x2);}else{if(hSsxse['petIb']('KhfJN',hSsxse['xYezs'])){const displayHeight=readUsedSize(canvas,hSsxse['XYkXr']);if(hSsxse['mfTVt'](displayHeight,undefined)){if('plrJW'===hSsxse['bosyH']){canvas['height']=displayHeight;}else{if(hSsxse['qOmTV'](canvas['style']['height'],'')){canvas['height']=hSsxse['mZPRb'](canvas['width'],hSsxse['iIdIu'](aspectRatio,0x2));}else{const _0x5e9530=hSsxse['rPjmj'](readUsedSize,canvas,hSsxse['XYkXr']);if(_0x5e9530!==undefined){canvas['height']=_0x5e9530;}}}}}else{const _0x3aa622=EVENT_TYPES[event['type']]||event['type'];const {x,y}=getRelativePosition(event,chart);return{'type':_0x3aa622,'chart':chart,'native':event,'x':hSsxse['ssVue'](x,undefined)?x:null,'y':hSsxse['ogVUO'](y,undefined)?y:null};}}}return canvas;}const eventListenerOptions=supportsEventListenerOptions?{'passive':!![]}:![];function addListener(node,type,listener){node['addEventListener'](type,listener,eventListenerOptions);}function removeListener(chart,type,listener){chart['canvas']['removeEventListener'](type,listener,eventListenerOptions);}function fromNativeEvent(event,chart){var VdYvhb={'NoNUz':function(callee,param1,param2){return callee(param1,param2);},'YQyuE':function(x,y){return x!==y;}};const type=EVENT_TYPES[event['type']]||event['type'];const {x,y}=VdYvhb['NoNUz'](getRelativePosition,event,chart);return{'type':type,'chart':chart,'native':event,'x':VdYvhb['YQyuE'](x,undefined)?x:null,'y':y!==undefined?y:null};}function createAttachObserver(chart,type,listener){var HeYcOs={'LVXCG':function(x,y){return x!==y;},'tHLQr':'EoIFS','POFfJ':function(x,y){return x===y;},'yvIzJ':function(callee){return callee();}};const canvas=chart['canvas'];const observer=new MutationObserver(entries=>{if(HeYcOs['LVXCG'](HeYcOs['tHLQr'],'EoIFS')){canvas['width']=displayWidth;}else{for(const entry of entries){for(const node of entry['addedNodes']){if(HeYcOs['POFfJ'](node,canvas)||node['contains'](canvas)){return HeYcOs['yvIzJ'](listener);}}}}});observer['observe'](document,{'childList':!![],'subtree':!![]});return observer;}function createDetachObserver(chart,type,listener){var GQnAPM={'zsfqG':function(callee,param1,param2,param3){return callee(param1,param2,param3);},'UIZdB':function(x,y){return x!==y;},'CmcgZ':'aiBUM','VYBJC':'FAUDH','CHXsn':function(x,y){return x===y;},'MMXEg':function(callee){return callee();}};const canvas=chart['canvas'];const observer=new MutationObserver(entries=>{if(GQnAPM['UIZdB']('aiBUM',GQnAPM['CmcgZ'])){const _0x1de8cf=chart['canvas'];const _0x2bab86=GQnAPM['zsfqG'](throttled,_0x566a0a=>{if(chart['ctx']!==null){listener(fromNativeEvent(_0x566a0a,chart));}},chart,_0x18f89d=>{const _0x1c00ed=_0x18f89d[0x0];return[_0x1c00ed,_0x1c00ed['offsetX'],_0x1c00ed['offsetY']];});GQnAPM['zsfqG'](addListener,_0x1de8cf,type,_0x2bab86);return _0x2bab86;}else{for(const entry of entries){if(GQnAPM['VYBJC']!==GQnAPM['VYBJC']){observer['disconnect']();}else{for(const node of entry['removedNodes']){if(GQnAPM['CHXsn'](node,canvas)||node['contains'](canvas)){return GQnAPM['MMXEg'](listener);}}}}}});observer['observe'](document,{'childList':!![],'subtree':!![]});return observer;}const drpListeningCharts=new Map();let oldDevicePixelRatio=0x0;function onWindowResize(){var BPSPMA={'IOuIO':function(x,y){return x===y;}};const dpr=window['devicePixelRatio'];if(BPSPMA['IOuIO'](dpr,oldDevicePixelRatio)){return;}oldDevicePixelRatio=dpr;drpListeningCharts['forEach']((resize,chart)=>{if(chart['currentDevicePixelRatio']!==dpr){resize();}});}function listenDevicePixelRatioChanges(chart,resize){var zUPLOK={'hdkyi':function(x,y){return x===y;},'qRppw':'AfpcQ','XxaKi':'xmADk','dVNmS':'resize'};if(!drpListeningCharts['size']){if(zUPLOK['hdkyi'](zUPLOK['qRppw'],zUPLOK['XxaKi'])){return window['devicePixelRatio'];}else{window['addEventListener'](zUPLOK['dVNmS'],onWindowResize);}}drpListeningCharts['set'](chart,resize);}function unlistenDevicePixelRatioChanges(chart){var YbXuqa={'LPQzb':'resize'};drpListeningCharts['delete'](chart);if(!drpListeningCharts['size']){window['removeEventListener'](YbXuqa['LPQzb'],onWindowResize);}}function createResizeObserver(chart,type,listener){var zgzzdc={'AUPJd':function(callee){return callee();},'owLCb':function(x,y){return x!==y;},'jOUXr':function(callee,param1,param2){return callee(param1,param2);},'PGhIY':function(x,y){return x<y;},'QKWrH':function(x,y){return x===y;},'UaWdU':function(x,y){return x===y;}};const canvas=chart['canvas'];const container=canvas&&_getParentNode(canvas);if(!container){return;}const resize=zgzzdc['jOUXr'](throttled,(width,height)=>{var lkoAaI={'tlaIs':function(callee){return zgzzdc['AUPJd'](callee);}};if(zgzzdc['owLCb']('UUnxV','UUnxV')){if(chart['currentDevicePixelRatio']!==dpr){lkoAaI['tlaIs'](resize);}}else{const w=container['clientWidth'];zgzzdc['jOUXr'](listener,width,height);if(zgzzdc['PGhIY'](w,container['clientWidth'])){zgzzdc['AUPJd'](listener);}}},window);const observer=new ResizeObserver(entries=>{const entry=entries[0x0];const width=entry['contentRect']['width'];const height=entry['contentRect']['height'];if(zgzzdc['QKWrH'](width,0x0)&&zgzzdc['UaWdU'](height,0x0)){return;}zgzzdc['jOUXr'](resize,width,height);});observer['observe'](container);zgzzdc['jOUXr'](listenDevicePixelRatioChanges,chart,resize);return observer;}function releaseObserver(chart,type,observer){var VPVDuY={'DXljs':'resize','cskkV':function(callee,param1){return callee(param1);}};if(observer){observer['disconnect']();}if(type===VPVDuY['DXljs']){VPVDuY['cskkV'](unlistenDevicePixelRatioChanges,chart);}}function createProxyAndListen(chart,type,listener){var fNkiNU={'guSDL':function(callee,param1,param2){return callee(param1,param2);},'kNVTI':function(x,y){return x===y;},'ezxRP':'kLKCk','uiDQi':function(callee,param1,param2,param3){return callee(param1,param2,param3);}};const canvas=chart['canvas'];const proxy=throttled(event=>{if(chart['ctx']!==null){listener(fNkiNU['guSDL'](fromNativeEvent,event,chart));}},chart,args=>{if(fNkiNU['kNVTI'](fNkiNU['ezxRP'],fNkiNU['ezxRP'])){const event=args[0x0];return[event,event['offsetX'],event['offsetY']];}else{window['addEventListener']('resize',onWindowResize);}});fNkiNU['uiDQi'](addListener,canvas,type,proxy);return proxy;}export default class DomPlatform extends _0x3cfbd8{['acquireContext'](canvas,aspectRatio){var BhCYka={'LPEoA':function(x,y){return x===y;}};const context=canvas&&canvas['getContext']&&canvas['getContext']('2d');if(context&&BhCYka['LPEoA'](context['canvas'],canvas)){initCanvas(canvas,aspectRatio);return context;}return null;}['releaseContext'](context){var zQMpvM={'zrTSI':function(x,y){return x!==y;},'qgksE':'OYQNB','VzSEc':function(x,y){return x===y;},'XFyMu':'KhgjC','yDnjq':'EoCIQ','pGcGh':'height','WZffk':'width'};const canvas=context['canvas'];if(!canvas[EXPANDO_KEY]){if(zQMpvM['VzSEc'](zQMpvM['yDnjq'],'EoCIQ')){return![];}else{listener();}}const initial=canvas[EXPANDO_KEY]['initial'];[zQMpvM['pGcGh'],zQMpvM['WZffk']]['forEach'](prop=>{var CoTOVC={'eqWFg':function(x,y){return x===y;}};const value=initial[prop];if(isNullOrUndef(value)){if(zQMpvM['zrTSI'](zQMpvM['qgksE'],'OYQNB')){canvas['setAttribute'](prop,value);}else{canvas['removeAttribute'](prop);}}else{if(zQMpvM['VzSEc']('vHKIR',zQMpvM['XFyMu'])){var QoEjJo={'mSLPI':function(callee){return callee();}};const _0x396df9=window['devicePixelRatio'];if(CoTOVC['eqWFg'](_0x396df9,oldDevicePixelRatio)){return;}oldDevicePixelRatio=_0x396df9;drpListeningCharts['forEach']((_0x308082,_0x44f1ee)=>{if(_0x44f1ee['currentDevicePixelRatio']!==_0x396df9){QoEjJo['mSLPI'](_0x308082);}});}else{canvas['setAttribute'](prop,value);}}});const style=initial['style']||{};Object['keys'](style)['forEach'](key=>{canvas['style'][key]=style[key];});canvas['width']=canvas['width'];delete canvas[EXPANDO_KEY];return!![];}['addEventListener'](chart,type,listener){var eYymiW={'JjcML':function(callee,param1,param2,param3){return callee(param1,param2,param3);}};this['removeEventListener'](chart,type);const proxies=chart['$proxies']||(chart['$proxies']={});const handlers={'attach':createAttachObserver,'detach':createDetachObserver,'resize':createResizeObserver};const handler=handlers[type]||createProxyAndListen;proxies[type]=eYymiW['JjcML'](handler,chart,type,listener);}['removeEventListener'](chart,type){const proxies=chart['$proxies']||(chart['$proxies']={});const proxy=proxies[type];if(!proxy){return;}const handlers={'attach':releaseObserver,'detach':releaseObserver,'resize':releaseObserver};const handler=handlers[type]||removeListener;handler(chart,type,proxy);proxies[type]=undefined;}['getDevicePixelRatio'](){return window['devicePixelRatio'];}['getMaximumSize'](canvas,width,height,aspectRatio){var VFWOZW={'ITzGS':function(callee,param1,param2,param3,param4){return callee(param1,param2,param3,param4);}};return VFWOZW['ITzGS'](getMaximumSize,canvas,width,height,aspectRatio);}['isAttached'](canvas){var VVXolc={'HGmJj':function(callee,param1){return callee(param1);}};const container=VVXolc['HGmJj'](_getParentNode,canvas);return!!(container&&container['isConnected']);}}