import _0x192036 from'../tool-testing/selftest.js';import{parse,markBottom}from'../utils/parse-stack';import _0x450354 from'underscore';import _0x4cf68e from'fibers';import _0x44662e from'fibers/future';import _0x5e6e07 from'../fs/files';_0x192036['define']('parse-stack\x20-\x20parse\x20stack\x20traces\x20without\x20fibers',()=>{var uVVAif={'bnVph':function(callee,param1){return callee(param1);},'RcWpI':'parse-stack-test.js','NQhKz':'selftest.js'};const err=new Error();const parsedStack=uVVAif['bnVph'](parse,err)['outsideFiber'];const firstFilePath=_0x5e6e07['convertToStandardPath'](parsedStack[0x0]['file']);_0x192036['expectEqual'](_0x450354['last'](firstFilePath['split']('/')),uVVAif['RcWpI']);const lastFilePath=_0x5e6e07['convertToStandardPath'](_0x450354['last'](parsedStack)['file']);_0x192036['expectEqual'](_0x450354['last'](lastFilePath['split']('/')),uVVAif['NQhKz']);uVVAif['bnVph'](markBottom,()=>{const markedErr=new Error();const {outsideFiber,insideFiber}=uVVAif['bnVph'](parse,markedErr);_0x192036['expectEqual'](insideFiber,undefined);_0x192036['expectEqual'](outsideFiber['length'],0x1);const firstOutsideFiberPath=_0x5e6e07['convertToStandardPath'](outsideFiber[0x0]['file']);_0x192036['expectEqual'](_0x450354['last'](firstOutsideFiberPath['split']('/')),'parse-stack-test.js');})();});_0x192036['define']('parse-stack - parse stack traces with fibers',()=>{var yUjbmq={'HudJH':'template-compiler.js'};const parsedStack=parse({'stack':exampleStackTrace});_0x192036['expectEqual'](parsedStack['insideFiber'][0x0]['file'],yUjbmq['HudJH']);_0x192036['expectEqual'](_0x450354['last'](parsedStack['outsideFiber'])['file'],yUjbmq['HudJH']);});const exampleStackTrace='TypeError:\x20object\x20is\x20not\x20a\x20function\x0a\x20\x20\x20\x20at\x20Object.Future.wait\x20(/Users/sashko/git/meteor/dev_bundle/lib/node_modules/fibers/future.js:395:16)\x0a\x20\x20\x20\x20at\x20TemplateCompiler.processFilesForTarget\x20(caching-compiler.js:312:12)\x0a\x20\x20\x20\x20at\x20TemplateCompiler.processFilesForTarget\x20(template-compiler.js:28:32)\x0a\x20\x20\x20\x20at\x20__bottom_mark__\x20(/Users/sashko/git/meteor/tools/parse-stack.js:92:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/isobuild/compiler-plugin.js:141:13\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:356:18\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:349:34\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:347:23\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20Object.enterJob\x20(/Users/sashko/git/meteor/tools/buildmessage.js:321:26)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/isobuild/compiler-plugin.js:130:22\x0a\x20\x20\x20\x20at\x20Function.time\x20(/Users/sashko/git/meteor/tools/profile.js:232:28)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/isobuild/compiler-plugin.js:129:15\x0a\x20\x20\x20\x20at\x20Function._.each._.forEach\x20(/Users/sashko/git/meteor/dev_bundle/lib/node_modules/underscore/underscore.js:87:22)\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.runCompilerPlugins\x20(/Users/sashko/git/meteor/tools/isobuild/compiler-plugin.js:118:7)\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend._runCompilerPlugins\x20(/Users/sashko/git/meteor/tools/isobuild/bundler.js:702:22)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/isobuild/bundler.js:504:34\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:356:18\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:349:34\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:347:23\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20Object.enterJob\x20(/Users/sashko/git/meteor/tools/buildmessage.js:321:26)\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.make\x20(/Users/sashko/git/meteor/tools/isobuild/bundler.js:498:18)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/isobuild/bundler.js:2044:14\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/isobuild/bundler.js:2126:20\x0a\x20\x20\x20\x20at\x20Array.forEach\x20(native)\x0a\x20\x20\x20\x20at\x20Function._.each._.forEach\x20(/Users/sashko/git/meteor/dev_bundle/lib/node_modules/underscore/underscore.js:79:11)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/isobuild/bundler.js:2125:7\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:268:13\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:261:29\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:259:18\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:250:23\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20Object.capture\x20(/Users/sashko/git/meteor/tools/buildmessage.js:249:19)\x0a\x20\x20\x20\x20at\x20Object.exports.bundle\x20(/Users/sashko/git/meteor/tools/isobuild/bundler.js:2029:31)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/run-app.js:557:36\x0a\x20\x20\x20\x20at\x20time\x20(/Users/sashko/git/meteor/tools/profile.js:232:28)\x0a\x20\x20\x20\x20at\x20Function.run\x20(/Users/sashko/git/meteor/tools/profile.js:377:12)\x0a\x20\x20\x20\x20at\x20bundleApp\x20(/Users/sashko/git/meteor/tools/run-app.js:547:34)\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend._runOnce\x20(/Users/sashko/git/meteor/tools/run-app.js:600:35)\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend._fiber\x20(/Users/sashko/git/meteor/tools/run-app.js:848:28)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/run-app.js:402:12\x0a\x20\x20\x20\x20-\x20-\x20-\x20-\x20-\x0a\x20\x20\x20\x20at\x20TemplateCompiler.compileOneFile\x20(template-compiler.js:43:23)\x0a\x20\x20\x20\x20at\x20caching-compiler.js:292:32\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/packages/caching-compiler/.npm/package/node_modules/async/lib/async.js:182:20\x0a\x20\x20\x20\x20at\x20replenish\x20(/Users/sashko/git/meteor/packages/caching-compiler/.npm/package/node_modules/async/lib/async.js:317:21)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/packages/caching-compiler/.npm/package/node_modules/async/lib/async.js:328:15\x0a\x20\x20\x20\x20at\x20Object.async.forEachLimit.async.eachLimit\x20(/Users/sashko/git/meteor/packages/caching-compiler/.npm/package/node_modules/async/lib/async.js:221:35)\x0a\x20\x20\x20\x20at\x20TemplateCompiler.processFilesForTarget\x20(caching-compiler.js:277:11)\x0a\x20\x20\x20\x20at\x20TemplateCompiler.processFilesForTarget\x20(template-compiler.js:28:32)\x0a\x20\x20\x20\x20at\x20__bottom_mark__\x20(/Users/sashko/git/meteor/tools/parse-stack.js:92:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/isobuild/compiler-plugin.js:141:13\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:356:18\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:349:34\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:347:23\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20Object.enterJob\x20(/Users/sashko/git/meteor/tools/buildmessage.js:321:26)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/isobuild/compiler-plugin.js:130:22\x0a\x20\x20\x20\x20at\x20Function.time\x20(/Users/sashko/git/meteor/tools/profile.js:232:28)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/isobuild/compiler-plugin.js:129:15\x0a\x20\x20\x20\x20at\x20Function._.each._.forEach\x20(/Users/sashko/git/meteor/dev_bundle/lib/node_modules/underscore/underscore.js:87:22)\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.runCompilerPlugins\x20(/Users/sashko/git/meteor/tools/isobuild/compiler-plugin.js:118:7)\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend._runCompilerPlugins\x20(/Users/sashko/git/meteor/tools/isobuild/bundler.js:702:22)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/isobuild/bundler.js:504:34\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:356:18\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:349:34\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:347:23\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20Object.enterJob\x20(/Users/sashko/git/meteor/tools/buildmessage.js:321:26)\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.make\x20(/Users/sashko/git/meteor/tools/isobuild/bundler.js:498:18)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/isobuild/bundler.js:2044:14\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/isobuild/bundler.js:2126:20\x0a\x20\x20\x20\x20at\x20Array.forEach\x20(native)\x0a\x20\x20\x20\x20at\x20Function._.each._.forEach\x20(/Users/sashko/git/meteor/dev_bundle/lib/node_modules/underscore/underscore.js:79:11)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/isobuild/bundler.js:2125:7\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:268:13\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:261:29\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:259:18\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/buildmessage.js:250:23\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend.withValue\x20(/Users/sashko/git/meteor/tools/fiber-helpers.js:114:14)\x0a\x20\x20\x20\x20at\x20Object.capture\x20(/Users/sashko/git/meteor/tools/buildmessage.js:249:19)\x0a\x20\x20\x20\x20at\x20Object.exports.bundle\x20(/Users/sashko/git/meteor/tools/isobuild/bundler.js:2029:31)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/run-app.js:557:36\x0a\x20\x20\x20\x20at\x20time\x20(/Users/sashko/git/meteor/tools/profile.js:232:28)\x0a\x20\x20\x20\x20at\x20Function.run\x20(/Users/sashko/git/meteor/tools/profile.js:377:12)\x0a\x20\x20\x20\x20at\x20bundleApp\x20(/Users/sashko/git/meteor/tools/run-app.js:547:34)\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend._runOnce\x20(/Users/sashko/git/meteor/tools/run-app.js:600:35)\x0a\x20\x20\x20\x20at\x20[object\x20Object]._.extend._fiber\x20(/Users/sashko/git/meteor/tools/run-app.js:848:28)\x0a\x20\x20\x20\x20at\x20/Users/sashko/git/meteor/tools/run-app.js:402:12';