import{expect}from'chai';import{getCredentials,api,request,credentials}from'../../../data/api-data.js';import{updatePermission,updateSetting}from'../../../data/permissions.helper';import{createDepartment}from'../../../data/livechat/department.js';describe('LIVECHAT - departments',function(){var DXgzDS={'MMNhw':function(callee,param1,param2){return callee(param1,param2);},'RYdPA':function(callee,param1){return callee(param1);},'ntVyA':'success','bZUox':'error-not-authorized','llZEQ':'application/json','VtUvW':function(x,y){return x!==y;},'ndwGm':'sjjXC','cLnsE':'total','nEBOu':'count','NmZiD':function(callee,param1,param2){return callee(param1,param2);},'dkcXw':'view-l-room','MhACB':function(callee,param1){return callee(param1);},'WBaty':'livechat/department','irFoo':'department','nMssH':'agents','FgriU':function(callee,param1){return callee(param1);},'PMlTs':function(x,y){return x===y;},'ciqnC':'hwsqM','iGbob':'EMxPR','POVQJ':function(callee,param1,param2){return callee(param1,param2);},'SjFLY':'should return an "unauthorized error" when the user does not have the necessary permission ["view-livechat-departments", "view-l-room"]','QagBh':function(callee,param1,param2){return callee(param1,param2);},'EGRgW':'should return an array of departments','QGNdy':function(callee,param1){return callee(param1);},'gVhdo':'gBbyw','UpTIN':function(callee,param1,param2){return callee(param1,param2);},'ZhQvf':'admin','KFLmg':function(callee,param1,param2){return callee(param1,param2);},'ftMvC':function(callee,param1){return callee(param1);},'ccQfG':'Content-Type','tYWuF':function(callee,param1,param2){return callee(param1,param2);},'PzXPq':'array','xVAcP':'offset','Qjlxx':'SuMtP','FqnOf':'SoDsZ','Zyazy':function(callee,param1){return callee(param1);},'WmTxx':'LHwPT','SfejS':function(callee,param1,param2){return callee(param1,param2);},'nRbVr':'should return the created department without the agents if the user does not have the necessary permission','gmuDe':function(callee,param1,param2){return callee(param1,param2);},'mQBpG':'should return the created department without the agents if the user does have the permission but request to no include the agents','fUnvM':function(callee,param1,param2){return callee(param1,param2);},'ZivNU':'should\x20return\x20the\x20created\x20department','zMJmT':function(callee,param1){return callee(param1);},'bdwPb':function(callee,param1){return callee(param1);}};this['retries'](0x0);let department;DXgzDS['zMJmT'](before,done=>getCredentials(done));DXgzDS['bdwPb'](before,done=>{DXgzDS['MMNhw'](updateSetting,'Livechat_enabled',!![])['then'](()=>createDepartment())['then'](createdDepartment=>{department=createdDepartment;done();})['catch'](console['log']);});describe('livechat/department',()=>{var PsPwyT={'OiTJG':function(callee,param1){return DXgzDS['MhACB'](callee,param1);},'GpwnG':DXgzDS['cLnsE'],'hyRSq':function(callee,param1){return DXgzDS['MhACB'](callee,param1);},'dBsGG':DXgzDS['WBaty'],'VgfYo':function(callee,param1,param2){return DXgzDS['NmZiD'](callee,param1,param2);},'cabYC':DXgzDS['dkcXw'],'tYvJM':DXgzDS['irFoo'],'RZJWA':DXgzDS['nMssH'],'CsNWo':function(callee,param1){return DXgzDS['FgriU'](callee,param1);},'anKxI':'Content-Type','POKVv':DXgzDS['llZEQ']};if(DXgzDS['PMlTs'](DXgzDS['ciqnC'],DXgzDS['iGbob'])){var lOamgs={'QKttK':function(callee,param1){return callee(param1);},'XMpyz':'array','iNfla':function(callee,param1){return PsPwyT['OiTJG'](callee,param1);},'moKmu':PsPwyT['GpwnG'],'oufJi':function(callee,param1){return PsPwyT['hyRSq'](callee,param1);},'pguvk':PsPwyT['dBsGG'],'xryzr':'application/json'};PsPwyT['VgfYo'](updatePermission,PsPwyT['cabYC'],['admin'])['then'](()=>updatePermission('view-livechat-departments',['admin']))['then'](()=>{request['get'](lOamgs['oufJi'](api,lOamgs['pguvk']))['set'](credentials)['expect']('Content-Type',lOamgs['xryzr'])['expect'](0xc8)['expect'](_0x4b1a3b=>{expect(_0x4b1a3b['body'])['to']['have']['property']('success',!![]);lOamgs['QKttK'](expect,_0x4b1a3b['body']['departments'])['to']['be']['an'](lOamgs['XMpyz']);lOamgs['iNfla'](expect,_0x4b1a3b['body'])['to']['have']['property']('offset');expect(_0x4b1a3b['body'])['to']['have']['property'](lOamgs['moKmu']);lOamgs['iNfla'](expect,_0x4b1a3b['body'])['to']['have']['property']('count');})['end'](done);});}else{DXgzDS['POVQJ'](it,DXgzDS['SjFLY'],done=>{var vAteWx={'vYEls':function(callee,param1){return DXgzDS['RYdPA'](callee,param1);},'zaLFW':'Content-Type','odjII':DXgzDS['ntVyA'],'bNLQm':DXgzDS['bZUox'],'MDnxu':function(callee,param1){return callee(param1);},'nerkp':function(x,y){return x!==y;},'HcXME':DXgzDS['llZEQ']};DXgzDS['MMNhw'](updatePermission,'view-l-room',[])['then'](()=>updatePermission('view-livechat-departments',[]))['then'](()=>{var SKLhiS={'LNVno':function(callee,param1){return callee(param1);},'QQlqV':vAteWx['odjII'],'MsTeK':vAteWx['bNLQm'],'RBNPQ':function(callee,param1){return vAteWx['MDnxu'](callee,param1);}};if(vAteWx['nerkp']('uZTMT','uZTMT')){request['get'](vAteWx['vYEls'](api,'livechat/department/'+department['_id']))['set'](credentials)['expect'](vAteWx['zaLFW'],'application/json')['expect'](0x190)['expect'](_0xb1130e=>{SKLhiS['LNVno'](expect,_0xb1130e['body'])['to']['have']['property'](SKLhiS['QQlqV'],![]);SKLhiS['LNVno'](expect,_0xb1130e['body']['error'])['to']['be']['equal'](SKLhiS['MsTeK']);})['end'](done);}else{request['get'](vAteWx['MDnxu'](api,'livechat/department'))['set'](credentials)['expect'](vAteWx['zaLFW'],vAteWx['HcXME'])['expect'](0x190)['expect'](res=>{SKLhiS['RBNPQ'](expect,res['body'])['to']['have']['property'](SKLhiS['QQlqV'],![]);expect(res['body']['error'])['to']['be']['equal'](SKLhiS['MsTeK']);})['end'](done);}});});DXgzDS['QagBh'](it,DXgzDS['EGRgW'],done=>{var WAurdZ={'JKwGV':function(x,y){return DXgzDS['VtUvW'](x,y);},'eUxtS':DXgzDS['ndwGm'],'ujDKC':function(callee,param1){return DXgzDS['RYdPA'](callee,param1);},'OCDqt':'success','tGmva':function(callee,param1){return DXgzDS['RYdPA'](callee,param1);},'EjnxD':DXgzDS['cLnsE'],'hwHDF':'array','NgCgF':DXgzDS['nEBOu']};DXgzDS['NmZiD'](updatePermission,DXgzDS['dkcXw'],['admin'])['then'](()=>updatePermission('view-livechat-departments',['admin']))['then'](()=>{var VbHPUI={'ulcWi':function(callee,param1){return callee(param1);},'inrWZ':'success','NqUpQ':PsPwyT['tYvJM'],'zSzcb':PsPwyT['RZJWA']};request['get'](PsPwyT['CsNWo'](api,'livechat/department'))['set'](credentials)['expect'](PsPwyT['anKxI'],PsPwyT['POKVv'])['expect'](0xc8)['expect'](res=>{if(WAurdZ['JKwGV']('Oyyth',WAurdZ['eUxtS'])){var GEEfJy='1|3|0|2|4'['split']('|'),WWrXoJ=0x0;while(!![]){switch(GEEfJy[WWrXoJ++]){case'0':WAurdZ['ujDKC'](expect,res['body'])['to']['have']['property']('offset');continue;case'1':WAurdZ['ujDKC'](expect,res['body'])['to']['have']['property'](WAurdZ['OCDqt'],!![]);continue;case'2':WAurdZ['tGmva'](expect,res['body'])['to']['have']['property'](WAurdZ['EjnxD']);continue;case'3':WAurdZ['tGmva'](expect,res['body']['departments'])['to']['be']['an'](WAurdZ['hwHDF']);continue;case'4':expect(res['body'])['to']['have']['property'](WAurdZ['NgCgF']);continue;}break;}}else{VbHPUI['ulcWi'](expect,res['body'])['to']['have']['property'](VbHPUI['inrWZ'],!![]);VbHPUI['ulcWi'](expect,res['body'])['to']['have']['property'](VbHPUI['NqUpQ']);VbHPUI['ulcWi'](expect,res['body'])['to']['not']['have']['property'](VbHPUI['zSzcb']);expect(res['body']['department']['_id'])['to']['be']['equal'](department['_id']);}})['end'](done);});});}});describe('livechat/department/id',()=>{var ZtpftU={'cDdWQ':function(callee,param1){return callee(param1);},'hKeBp':function(callee,param1){return DXgzDS['ftMvC'](callee,param1);},'NgOVP':DXgzDS['ccQfG'],'dDKEI':function(callee,param1,param2){return DXgzDS['tYWuF'](callee,param1,param2);},'OYTXt':DXgzDS['dkcXw'],'TiAqb':DXgzDS['WBaty'],'cLpjB':DXgzDS['ntVyA'],'tOAPY':DXgzDS['nMssH'],'rGtnI':DXgzDS['bZUox'],'jzVtD':DXgzDS['PzXPq'],'ixPwa':function(callee,param1){return DXgzDS['ftMvC'](callee,param1);},'LulFk':DXgzDS['xVAcP'],'WncOC':function(callee,param1){return DXgzDS['ftMvC'](callee,param1);},'LpolS':DXgzDS['nEBOu'],'jfoer':DXgzDS['Qjlxx'],'nRDDv':function(callee,param1,param2){return callee(param1,param2);},'HqGtS':'view-livechat-departments','KnbNf':DXgzDS['ZhQvf'],'Rlzqd':function(x,y){return x===y;},'CCZaF':DXgzDS['FqnOf'],'hmCTH':function(callee,param1){return DXgzDS['Zyazy'](callee,param1);},'sUyPy':'application/json','eEdNp':DXgzDS['irFoo'],'iktZK':function(callee,param1,param2){return callee(param1,param2);}};if('LHwPT'===DXgzDS['WmTxx']){DXgzDS['tYWuF'](it,'should return an "unauthorized error" when the user does not have the necessary permission ["view-livechat-departments", "view-l-room"]',done=>{var WPMNRk={'ovuBV':function(callee,param1){return ZtpftU['cDdWQ'](callee,param1);},'tdYCc':function(callee,param1){return ZtpftU['hKeBp'](callee,param1);},'qeRRN':ZtpftU['NgOVP'],'vwGdF':'application/json'};ZtpftU['dDKEI'](updatePermission,ZtpftU['OYTXt'],[])['then'](()=>updatePermission('view-livechat-departments',[]))['then'](()=>{request['get'](WPMNRk['tdYCc'](api,'livechat/department/'+department['_id']))['set'](credentials)['expect'](WPMNRk['qeRRN'],WPMNRk['vwGdF'])['expect'](0x190)['expect'](res=>{WPMNRk['ovuBV'](expect,res['body'])['to']['have']['property']('success',![]);WPMNRk['tdYCc'](expect,res['body']['error'])['to']['be']['equal']('error-not-authorized');})['end'](done);});});DXgzDS['SfejS'](it,DXgzDS['nRbVr'],done=>{var YzKTrV={'HgXUq':function(callee,param1){return DXgzDS['QGNdy'](callee,param1);},'aGdHq':'success','qjWIu':'agents','UOqVD':'application/json','cWzBa':DXgzDS['irFoo'],'MkcnY':function(callee,param1){return DXgzDS['QGNdy'](callee,param1);},'Lodkb':'Content-Type'};if(DXgzDS['VtUvW'](DXgzDS['gVhdo'],DXgzDS['gVhdo'])){request['get'](YzKTrV['HgXUq'](api,'livechat/department/'+department['_id']))['set'](credentials)['expect']('Content-Type',YzKTrV['UOqVD'])['expect'](0xc8)['expect'](_0x5b4166=>{YzKTrV['HgXUq'](expect,_0x5b4166['body'])['to']['have']['property'](YzKTrV['aGdHq'],!![]);expect(_0x5b4166['body'])['to']['have']['property']('department');expect(_0x5b4166['body'])['to']['not']['have']['property'](YzKTrV['qjWIu']);expect(_0x5b4166['body']['department']['_id'])['to']['be']['equal'](department['_id']);})['end'](done);}else{DXgzDS['UpTIN'](updatePermission,DXgzDS['dkcXw'],[DXgzDS['ZhQvf']])['then'](()=>updatePermission('view-livechat-departments',[]))['then'](()=>{var BEBwQZ={'pIDZm':function(callee,param1){return YzKTrV['HgXUq'](callee,param1);},'DZfBz':YzKTrV['cWzBa'],'lKsOS':function(callee,param1){return YzKTrV['HgXUq'](callee,param1);},'msmeg':YzKTrV['qjWIu'],'hmobV':function(callee,param1){return YzKTrV['MkcnY'](callee,param1);}};request['get'](YzKTrV['MkcnY'](api,'livechat/department/'+department['_id']))['set'](credentials)['expect'](YzKTrV['Lodkb'],YzKTrV['UOqVD'])['expect'](0xc8)['expect'](res=>{expect(res['body'])['to']['have']['property']('success',!![]);BEBwQZ['pIDZm'](expect,res['body'])['to']['have']['property'](BEBwQZ['DZfBz']);BEBwQZ['lKsOS'](expect,res['body'])['to']['not']['have']['property'](BEBwQZ['msmeg']);BEBwQZ['hmobV'](expect,res['body']['department']['_id'])['to']['be']['equal'](department['_id']);})['end'](done);});}});DXgzDS['gmuDe'](it,DXgzDS['mQBpG'],done=>{var ZQVVWk={'TpfIq':function(x,y){return x===y;},'aiZBI':'mJFlI','dCKCe':function(callee,param1){return callee(param1);},'HSrEe':ZtpftU['cLpjB'],'LwkcZ':function(callee,param1){return ZtpftU['hKeBp'](callee,param1);},'VpnrE':'department','lDqpE':ZtpftU['tOAPY'],'mTIGe':function(callee,param1){return ZtpftU['hKeBp'](callee,param1);},'GVDHX':ZtpftU['rGtnI'],'OUtwH':function(callee,param1,param2){return ZtpftU['dDKEI'](callee,param1,param2);},'dTKbJ':'Content-Type','iTKdy':ZtpftU['jzVtD'],'PTZEo':function(callee,param1){return ZtpftU['ixPwa'](callee,param1);},'EEPnw':ZtpftU['LulFk'],'EWxtO':'total','kgWCN':function(callee,param1){return ZtpftU['WncOC'](callee,param1);},'deWFB':ZtpftU['LpolS']};if('SuMtP'===ZtpftU['jfoer']){ZtpftU['nRDDv'](updatePermission,ZtpftU['HqGtS'],['admin'])['then'](()=>{var dbLNVy={'OWFPu':function(callee,param1){return ZQVVWk['mTIGe'](callee,param1);},'qiTrW':ZQVVWk['GVDHX'],'vDbIn':function(callee,param1,param2){return ZQVVWk['OUtwH'](callee,param1,param2);}};request['get'](ZQVVWk['mTIGe'](api,'livechat/department/'+department['_id']+'?includeAgents=false'))['set'](credentials)['expect'](ZQVVWk['dTKbJ'],'application/json')['expect'](0xc8)['expect'](res=>{if(ZQVVWk['TpfIq'](ZQVVWk['aiZBI'],ZQVVWk['aiZBI'])){ZQVVWk['dCKCe'](expect,res['body'])['to']['have']['property'](ZQVVWk['HSrEe'],!![]);ZQVVWk['LwkcZ'](expect,res['body'])['to']['have']['property'](ZQVVWk['VpnrE']);expect(res['body'])['to']['not']['have']['property'](ZQVVWk['lDqpE']);ZQVVWk['LwkcZ'](expect,res['body']['department']['_id'])['to']['be']['equal'](department['_id']);}else{var AGsTEI={'cVtOh':function(callee,param1){return dbLNVy['OWFPu'](callee,param1);},'NeURj':dbLNVy['qiTrW'],'vuRhg':'Content-Type'};dbLNVy['vDbIn'](updatePermission,'view-l-room',[])['then'](()=>updatePermission('view-livechat-departments',[]))['then'](()=>{var mqiGJZ={'TWmaP':function(callee,param1){return AGsTEI['cVtOh'](callee,param1);},'InqoZ':AGsTEI['NeURj']};request['get'](api('livechat/department/'+department['_id']))['set'](credentials)['expect'](AGsTEI['vuRhg'],'application/json')['expect'](0x190)['expect'](_0x4edfce=>{mqiGJZ['TWmaP'](expect,_0x4edfce['body'])['to']['have']['property']('success',![]);expect(_0x4edfce['body']['error'])['to']['be']['equal'](mqiGJZ['InqoZ']);})['end'](done);});}})['end'](done);});}else{request['get'](ZtpftU['hKeBp'](api,ZtpftU['TiAqb']))['set'](credentials)['expect'](ZtpftU['NgOVP'],'application/json')['expect'](0xc8)['expect'](_0x2b67db=>{expect(_0x2b67db['body'])['to']['have']['property']('success',!![]);ZQVVWk['mTIGe'](expect,_0x2b67db['body']['departments'])['to']['be']['an'](ZQVVWk['iTKdy']);ZQVVWk['PTZEo'](expect,_0x2b67db['body'])['to']['have']['property'](ZQVVWk['EEPnw']);expect(_0x2b67db['body'])['to']['have']['property'](ZQVVWk['EWxtO']);ZQVVWk['kgWCN'](expect,_0x2b67db['body'])['to']['have']['property'](ZQVVWk['deWFB']);})['end'](done);}});DXgzDS['fUnvM'](it,DXgzDS['ZivNU'],done=>{var ppovCQ={'FWzuQ':function(x,y){return DXgzDS['PMlTs'](x,y);},'ehmsv':'kDEMd','yhHBb':function(callee,param1){return callee(param1);},'hUhsc':DXgzDS['ntVyA'],'dcGDp':DXgzDS['nMssH'],'VWyfJ':function(callee,param1){return DXgzDS['QGNdy'](callee,param1);},'nhfUj':DXgzDS['irFoo']};DXgzDS['KFLmg'](updatePermission,DXgzDS['dkcXw'],[DXgzDS['ZhQvf']])['then'](()=>updatePermission('view-livechat-departments',['admin']))['then'](()=>{var slBqza={'LIfmg':function(callee,param1){return callee(param1);},'mKcef':'department','PrJVn':'Content-Type','HIXwY':function(callee,param1,param2){return callee(param1,param2);},'zzSYy':ZtpftU['OYTXt'],'DlPwU':ZtpftU['KnbNf']};if(ZtpftU['Rlzqd'](ZtpftU['CCZaF'],ZtpftU['CCZaF'])){request['get'](ZtpftU['hmCTH'](api,'livechat/department/'+department['_id']))['set'](credentials)['expect']('Content-Type',ZtpftU['sUyPy'])['expect'](0xc8)['expect'](res=>{if(ppovCQ['FWzuQ'](ppovCQ['ehmsv'],ppovCQ['ehmsv'])){ppovCQ['yhHBb'](expect,res['body'])['to']['have']['property'](ppovCQ['hUhsc'],!![]);expect(res['body'])['to']['have']['property']('department');expect(res['body'])['to']['have']['property'](ppovCQ['dcGDp']);ppovCQ['yhHBb'](expect,res['body']['department']['_id'])['to']['be']['equal'](department['_id']);}else{var bJzfWD={'DsGlq':function(callee,param1){return slBqza['LIfmg'](callee,param1);},'iJiUu':slBqza['mKcef'],'LeaBe':function(callee,param1){return callee(param1);},'uXgPA':function(callee,param1){return slBqza['LIfmg'](callee,param1);},'XooCW':slBqza['PrJVn'],'daJNT':'application/json'};slBqza['HIXwY'](updatePermission,slBqza['zzSYy'],[slBqza['DlPwU']])['then'](()=>updatePermission('view-livechat-departments',[]))['then'](()=>{var UxeRbq={'oLPul':function(callee,param1){return bJzfWD['DsGlq'](callee,param1);},'ioUjv':bJzfWD['iJiUu'],'CoKPH':function(callee,param1){return bJzfWD['LeaBe'](callee,param1);}};request['get'](bJzfWD['uXgPA'](api,'livechat/department/'+department['_id']))['set'](credentials)['expect'](bJzfWD['XooCW'],bJzfWD['daJNT'])['expect'](0xc8)['expect'](_0x3cc975=>{UxeRbq['oLPul'](expect,_0x3cc975['body'])['to']['have']['property']('success',!![]);UxeRbq['oLPul'](expect,_0x3cc975['body'])['to']['have']['property'](UxeRbq['ioUjv']);expect(_0x3cc975['body'])['to']['not']['have']['property']('agents');UxeRbq['CoKPH'](expect,_0x3cc975['body']['department']['_id'])['to']['be']['equal'](department['_id']);})['end'](done);});}})['end'](done);}else{expect(res['body'])['to']['have']['property'](ppovCQ['hUhsc'],!![]);ppovCQ['VWyfJ'](expect,res['body'])['to']['have']['property'](ppovCQ['nhfUj']);expect(res['body'])['to']['have']['property'](ppovCQ['dcGDp']);ppovCQ['VWyfJ'](expect,res['body']['department']['_id'])['to']['be']['equal'](department['_id']);}});});}else{var dsnjiB={'uhCMq':function(callee,param1){return callee(param1);},'vJLPT':ZtpftU['eEdNp'],'JckVq':ZtpftU['NgOVP']};ZtpftU['iktZK'](updatePermission,ZtpftU['OYTXt'],[ZtpftU['KnbNf']])['then'](()=>updatePermission('view-livechat-departments',['admin']))['then'](()=>{var peIdvy={'BuhKy':'success','mOXOd':function(callee,param1){return dsnjiB['uhCMq'](callee,param1);},'TsOkj':dsnjiB['vJLPT'],'EAJxt':function(callee,param1){return callee(param1);},'iRgXQ':'agents'};request['get'](dsnjiB['uhCMq'](api,'livechat/department/'+department['_id']))['set'](credentials)['expect'](dsnjiB['JckVq'],'application/json')['expect'](0xc8)['expect'](_0x24a1a8=>{expect(_0x24a1a8['body'])['to']['have']['property'](peIdvy['BuhKy'],!![]);peIdvy['mOXOd'](expect,_0x24a1a8['body'])['to']['have']['property'](peIdvy['TsOkj']);peIdvy['EAJxt'](expect,_0x24a1a8['body'])['to']['have']['property'](peIdvy['iRgXQ']);expect(_0x24a1a8['body']['department']['_id'])['to']['be']['equal'](department['_id']);})['end'](done);});}});});