'use strict';/* eslint-disable no-unused-expressions */const crypto=require('crypto');const fs=require('fs');const path=require('path');const globby=require('globby');const sandbox=require('sinon');const chai=require('chai');const proxyquire=require('proxyquire');const normalizeFiles=require('../../../../../../../lib/plugins/aws/lib/normalizeFiles');const AwsProvider=require('../../../../../../../lib/plugins/aws/provider');const AwsDeploy=require('../../../../../../../lib/plugins/aws/deploy/index');const Serverless=require('../../../../../../../lib/Serverless');const ServerlessError=require('../../../../../../../lib/serverless-error');const runServerless=require('../../../../../../utils/run-serverless');chai['use'](require('chai-as-promised'));chai['use'](require('sinon-chai'));const expect=require('chai')['expect'];describe('checkForChanges',()=>{var _0x684bae={'BYTIn':function(_0x1efee6,_0x4dc82a){return _0x1efee6(_0x4dc82a);},'adiCR':function(_0x36ff3d,_0x183225){return _0x36ff3d!==_0x183225;},'qavpq':'tLJVy','IhqWS':'dev','fEzcB':'us-east-1','uKixc':'my-service','tVLtw':'deployment-bucket','Pvesf':'bar','cwuBa':'../../../../../../../lib/plugins/aws/deploy/lib/checkForChanges.js','sipCs':function(_0x3bc525,_0x193378){return _0x3bc525(_0x193378);},'oVIec':function(_0xb84b1d,_0x33626a){return _0xb84b1d(_0x33626a);},'QMUJf':'**.zip','cttoB':'.serverless','NwuJv':function(_0x4ea695,_0x498205){return _0x4ea695(_0x498205);},'xHxtZ':'.serverless/my-service.zip','pwlje':'sha256','XJoXQ':'data','OTXpl':'close','rtWrs':function(_0x3bbda1,_0x13e3e8){return _0x3bbda1!==_0x13e3e8;},'iNDIr':'KiveB','ejKva':'getMostRecentObjects','adDGX':'getObjectMetadata','TpCdJ':'checkIfDeploymentIsNecessary','RDRim':'checkLogGroupSubscriptionFilterResourceLimitExceeded','XZROB':function(_0x299b07,_0x14cad0){return _0x299b07(_0x14cad0);},'ISlgI':function(_0x41ca33,_0x259ca6){return _0x41ca33(_0x259ca6);},'nUKsA':'oRCrw','AkprZ':function(_0x400118,_0x7e1989){return _0x400118(_0x7e1989);},'bxSWj':function(_0x5eae0c,_0x1283bf){return _0x5eae0c(_0x1283bf);},'ZcKvc':function(_0x38dadb,_0x145ba5,_0x20b839){return _0x38dadb(_0x145ba5,_0x20b839);},'tZSvP':'The specified bucket does not exist','Mxwgl':function(_0x48891c,_0x40a8d8){return _0x48891c(_0x40a8d8);},'GoFzx':'Create it manually if you want to reuse the CloudFormation stack "my-service-dev",','etdLj':'or delete the stack if it is no longer required.','RUCpB':'Other reason','gucZc':function(_0x507869,_0x10ade9){return _0x507869===_0x10ade9;},'amFel':'ROgcd','ygaYj':function(_0x89996f,_0x528ece){return _0x89996f(_0x528ece);},'FJCuX':function(_0x2eb3e1,_0x11700e){return _0x2eb3e1(_0x11700e);},'DGcGU':function(_0x30e48e,_0x4803f6){return _0x30e48e(_0x4803f6);},'oRepI':'my-service.zip','aNeUI':'local-hash-zip-file-1','QvvJU':function(_0x804ab0,_0x480def){return _0x804ab0===_0x480def;},'DqDyn':'tfvUT','CHsPO':'EVpzC','Sjbmq':'listObjectsV2','BqzTp':'serverless/my-service/dev','QKswr':'aws','sDRUJ':function(_0x3a6395,_0x20caf2,_0x3c6216){return _0x3a6395(_0x20caf2,_0x3c6216);},'vWrtx':'GGUFL','hMZTT':'AIKBc','JbuHY':'ZkSaf','UhFwJ':function(_0xce846f,_0x17f7f0){return _0xce846f(_0x17f7f0);},'SLGDH':function(_0x274b06,_0x34395f,_0x154786){return _0x274b06(_0x34395f,_0x154786);},'dQlKO':'should\x20resolve\x20if\x20no\x20result\x20is\x20returned','ufmor':function(_0xabd80c,_0x3d7ecd,_0x36bc47){return _0xabd80c(_0x3d7ecd,_0x36bc47);},'NxMVQ':'should translate error if rejected due to missing bucket','sBiCX':'should throw original error if rejected not due to missing bucket','NzHSD':function(_0x1d1f11,_0x9aa4db,_0x1ed9d6){return _0x1d1f11(_0x9aa4db,_0x1ed9d6);},'OWXWk':'should resolve with the most recently deployed objects','INGSf':'request','dmTJi':'remote-hash-cf-template','xstio':'SFzWk','ugVKB':'yKbvf','NRpug':'FzNiT','QUDTo':'GHMZb','DtQng':'Fn1','KwNhy':function(_0x4d378f,_0x2a3a4f){return _0x4d378f(_0x2a3a4f);},'Ymxai':'1|3|5|0|2|6|7|4','DRxOR':function(_0x21b41a,_0x2926eb){return _0x21b41a!==_0x2926eb;},'JlxUR':'fQrkG','IvKLB':'fn1','iIqSc':function(_0x52aa83,_0x155f5f){return _0x52aa83(_0x155f5f);},'ouDie':function(_0x3b46c7,_0x5e82ef){return _0x3b46c7(_0x5e82ef);},'BpaOi':'should resolve if no input is provided','byFuc':function(_0x25c544,_0x1a9573,_0x4a4939){return _0x25c544(_0x1a9573,_0x4a4939);},'YJWjR':'should resolve if no objects are provided as input','exHBB':function(_0x291298,_0x45a01a){return _0x291298(_0x45a01a);},'IkIGH':function(_0x58ca7e,_0x3d6434){return _0x58ca7e(_0x3d6434);},'OiPHx':function(_0x190512,_0xac783a){return _0x190512(_0xac783a);},'Okqtw':function(_0x10752a,_0x492f2a){return _0x10752a!==_0x492f2a;},'MWZlX':'rFtmU','QchaM':function(_0x36a568,_0x2891c6){return _0x36a568(_0x2891c6);},'KRUvk':'3|5|0|2|4|6|1|7','wfQvm':function(_0x37578e,_0x4e08ce){return _0x37578e(_0x4e08ce);},'MnaXf':'1|5|6|0|7|2|4|3','IvufD':'hash-cf-template','YBPMm':'XeGnM','WGjoV':'doksg','NSAMC':'local-hash-cf-template','GApjV':'remote-hash-zip-file-1','sjrLr':'4|0|2|7|1|6|5|3','ecIiw':'hash-zip-file-1','fcxFx':'WbsuB','HJOGL':'3|5|6|7|2|4|0|1|8','ZHCCB':'.serverless/func1.zip','XlMEM':'func1.zip','PzlzN':'func2.zip','mmBBH':'4|6|0|7|3|1|5|2','HyFqK':function(_0x18fb57,_0x98d782){return _0x18fb57(_0x98d782);},'bRCAI':'ZUIHP','Xolft':function(_0x191e48,_0x90ed01){return _0x191e48(_0x90ed01);},'fUAqD':function(_0x3e9232,_0x8bc916){return _0x3e9232(_0x8bc916);},'goSuj':function(_0x38f980,_0x233978){return _0x38f980(_0x233978);},'pkHHD':'foo/bar/my-own.zip','OknZT':'local-my-own-hash','EHfZY':'remote-my-own-hash','hgBIB':function(_0x3a8d6c,_0x2fae3a){return _0x3a8d6c(_0x2fae3a);},'DysBE':'MlSnl','gNZsk':'normalizeCloudFormationTemplate','fcYgG':function(_0x56200b,_0x571205){return _0x56200b(_0x571205);},'ZrWoj':function(_0x34bda0,_0x5905ca){return _0x34bda0(_0x5905ca);},'HKqDX':function(_0x195c60,_0x5462b4){return _0x195c60(_0x5462b4);},'geepb':'/artifact.zip','cgoQL':'4|3|6|7|2|5|1|0','ahMmD':function(_0x3537f7,_0x59de0b){return _0x3537f7(_0x59de0b);},'PfOxd':function(_0x3b83c3,_0x406ceb){return _0x3b83c3(_0x406ceb);},'TbMQr':function(_0x2e2ff6,_0x21af76){return _0x2e2ff6-_0x21af76;},'RErNp':'.serverless/func2.zip','HwBEn':function(_0x297a64,_0x117e07){return _0x297a64!==_0x117e07;},'EYRQv':'Mrvck','aBHfW':'6|7|5|0|4|3|2|1','BvRWI':function(_0x4160af,_0x42b2a1){return _0x4160af(_0x42b2a1);},'RlIoc':function(_0x3e71b7,_0x173331,_0x1d2bfd){return _0x3e71b7(_0x173331,_0x1d2bfd);},'oqNqd':'should resolve if objects are given, but no function last modified date','rypxA':'should not set a flag if there are more remote hashes','pcJcf':function(_0x2f8599,_0x35400e,_0x4c150c){return _0x2f8599(_0x35400e,_0x4c150c);},'XIDwp':'should not set a flag if remote and local hashes are different','oVeqs':function(_0x2e8ed8,_0x4d4290,_0x1d23da){return _0x2e8ed8(_0x4d4290,_0x1d23da);},'OSDfy':'should not set a flag if the hashes are equal, but the objects were modified after their functions','AcZrR':'should set a flag if the remote and local hashes are equal','NskIF':function(_0x3ccbd3,_0x47e538,_0x5ddfec){return _0x3ccbd3(_0x47e538,_0x5ddfec);},'PUneM':'should\x20set\x20a\x20flag\x20if\x20the\x20remote\x20and\x20local\x20hashes\x20are\x20equal,\x20and\x20the\x20edit\x20times\x20are\x20ordered','PlrYv':function(_0x1e42a4,_0x329c9c,_0x29b3f9){return _0x1e42a4(_0x329c9c,_0x29b3f9);},'JOHLP':'should set a flag if the remote and local hashes are duplicated and equal','AhcwO':'should not set a flag if the remote and local hashes are different for package.artifact','lCEkz':'#getMostRecentObjects()','lcSsc':'#getObjectMetadata()'};let _0x1215db;let _0x1856c6;let _0x58eb08;let _0x14d70a;let _0x33af28;_0x684bae['BvRWI'](beforeEach,()=>{var _0x20472c={'WqnoA':function(_0x875e57,_0x5d801c){return _0x684bae['BYTIn'](_0x875e57,_0x5d801c);},'XgrPa':function(_0x2adfbb,_0x3a865d){return _0x684bae['adiCR'](_0x2adfbb,_0x3a865d);},'gTwOl':'TXWyI','ZUVzE':_0x684bae['qavpq']};const _0xc7c8c1={'stage':_0x684bae['IhqWS'],'region':_0x684bae['fEzcB']};_0x1215db=new Serverless();_0x1215db['serviceDir']='my-service';_0x1856c6=new AwsProvider(_0x1215db,_0xc7c8c1);_0x1215db['setProvider']('aws',_0x1856c6);_0x1215db['service']['service']=_0x684bae['uKixc'];_0x58eb08=new AwsDeploy(_0x1215db,_0xc7c8c1);_0x58eb08['bucketName']=_0x684bae['tVLtw'];_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']={'foo':_0x684bae['Pvesf']};_0x14d70a='serverless/'+_0x1215db['service']['service']+'/'+_0x1856c6['getStage']();_0x58eb08['serverless']['cli']={'log':sandbox['spy']()};_0x33af28={'createHash'(){if(_0x20472c['XgrPa'](_0x20472c['gTwOl'],_0x20472c['ZUVzE'])){return this;}else{expect(headObjectStub)['to']['not']['have']['been']['called'];_0x20472c['WqnoA'](expect,result)['to']['deep']['equal']([]);}},'update'(){return this;},'digest':sandbox['stub']()};const _0x37ced4=proxyquire(_0x684bae['cwuBa'],{'crypto':_0x33af28});Object['assign'](_0x58eb08,_0x37ced4);});_0x684bae['PlrYv'](describe,'#checkForChanges()',()=>{var _0x5397c7={'czrKT':_0x684bae['pwlje'],'QGyUN':_0x684bae['XJoXQ'],'XEhRZ':_0x684bae['OTXpl'],'jrDEd':function(_0x12a0b0,_0x15a676){return _0x684bae['rtWrs'](_0x12a0b0,_0x15a676);},'Aqjvu':_0x684bae['iNDIr'],'lIyEa':_0x684bae['ejKva'],'eeIlg':_0x684bae['adDGX'],'hinHh':_0x684bae['TpCdJ'],'ANlOk':_0x684bae['RDRim'],'SoSsQ':function(_0x1a98f7,_0x5710e6){return _0x684bae['XZROB'](_0x1a98f7,_0x5710e6);},'elegQ':function(_0x251d3a,_0x267c6d){return _0x684bae['ISlgI'](_0x251d3a,_0x267c6d);},'gPFli':function(_0x28881c,_0xcec252){return _0x28881c(_0xcec252);}};if('HocSj'!==_0x684bae['nUKsA']){let _0x522cd9;let _0x2c9198;let _0x55d0fb;let _0x12dc41;_0x684bae['AkprZ'](beforeEach,()=>{if(_0x5397c7['jrDEd'](_0x5397c7['Aqjvu'],_0x5397c7['Aqjvu'])){const _0x599da6=crypto['createHash'](_0x5397c7['czrKT']);const _0x381cdd=fs['createReadStream'](_0x1215db['serviceDir']+'/.serverless/'+fileName);_0x381cdd['on'](_0x5397c7['QGyUN'],_0x34b738=>_0x599da6['update'](_0x34b738));_0x381cdd['on'](_0x5397c7['XEhRZ'],()=>resolve(_0x599da6['digest']('base64')));}else{_0x522cd9=sandbox['stub'](_0x58eb08,_0x5397c7['lIyEa'])['resolves']();_0x2c9198=sandbox['stub'](_0x58eb08,_0x5397c7['eeIlg'])['resolves']();_0x55d0fb=sandbox['stub'](_0x58eb08,_0x5397c7['hinHh'])['resolves']();_0x12dc41=sandbox['stub'](_0x58eb08,_0x5397c7['ANlOk'])['resolves']();}});_0x684bae['bxSWj'](afterEach,()=>{var _0x50583c='0|1|3|4|2'['split']('|'),_0x57621b=0x0;while(!![]){switch(_0x50583c[_0x57621b++]){case'0':_0x58eb08['getMostRecentObjects']['restore']();continue;case'1':_0x58eb08['getObjectMetadata']['restore']();continue;case'2':_0x12dc41['restore']();continue;case'3':_0x58eb08['checkIfDeploymentIsNecessary']['restore']();continue;case'4':_0x58eb08['checkLogGroupSubscriptionFilterResourceLimitExceeded']['restore']();continue;}break;}});_0x684bae['ZcKvc'](it,'should resolve if the "force" option is used',()=>{_0x58eb08['options']['force']=!![];return _0x5397c7['gPFli'](expect,_0x58eb08['checkForChanges']())['to']['be']['fulfilled']['then'](()=>{_0x5397c7['SoSsQ'](expect,_0x522cd9)['to']['not']['have']['been']['called'];_0x5397c7['SoSsQ'](expect,_0x2c9198)['to']['not']['have']['been']['called'];_0x5397c7['elegQ'](expect,_0x55d0fb)['to']['not']['have']['been']['called'];_0x5397c7['gPFli'](expect,_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](![]);});});}else{_0x684bae['sipCs'](expect,normalizeCloudFormationTemplateStub)['to']['have']['been']['calledOnce'];_0x684bae['oVIec'](expect,globbySyncStub)['to']['have']['been']['calledOnce'];_0x684bae['oVIec'](expect,readFileStub)['to']['have']['been']['calledOnce'];_0x684bae['oVIec'](expect,_0x58eb08['serverless']['cli']['log'])['to']['not']['have']['been']['called'];expect(normalizeCloudFormationTemplateStub)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);_0x684bae['oVIec'](expect,globbySyncStub)['to']['have']['been']['calledWithExactly']([_0x684bae['QMUJf']],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],_0x684bae['cttoB']),'dot':!![],'silent':!![]});_0x684bae['NwuJv'](expect,readFileStub)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x684bae['xHxtZ']));_0x684bae['NwuJv'](expect,_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](undefined);}});describe(_0x684bae['lCEkz'],()=>{var _0x12c12b={'OWenk':_0x684bae['CHsPO'],'nJHwc':function(_0x5155f5,_0x2da7f1){return _0x684bae['DGcGU'](_0x5155f5,_0x2da7f1);},'VtRsA':_0x684bae['Sjbmq'],'RXGwl':_0x684bae['BqzTp'],'IAoXz':function(_0x362c35,_0x402f7b){return _0x684bae['DGcGU'](_0x362c35,_0x402f7b);},'NgRFI':_0x684bae['fEzcB'],'loODl':'my-service','VmxgN':_0x684bae['QKswr'],'GCSbn':_0x684bae['tVLtw'],'bKXQb':function(_0x289dc9,_0x118d14,_0x16e471){return _0x684bae['sDRUJ'](_0x289dc9,_0x118d14,_0x16e471);},'gjgkn':_0x684bae['cwuBa'],'iKvql':function(_0x3130b3,_0x99dc12){return _0x3130b3!==_0x99dc12;},'Javky':_0x684bae['vWrtx'],'OmYsL':function(_0xeacd9a,_0x59e65b){return _0x684bae['DGcGU'](_0xeacd9a,_0x59e65b);},'INRdM':function(_0x42f2ca,_0x4956e0){return _0x684bae['QvvJU'](_0x42f2ca,_0x4956e0);},'qGIZZ':'XwVDZ','DTVfK':_0x684bae['hMZTT']};if(_0x684bae['JbuHY']==='djFnq'){headObjectStub=sandbox['stub'](_0x58eb08['provider'],'request')['resolves']();}else{let _0x31b8e7;beforeEach(()=>{var _0x3a2557={'qrnpl':'/artifact.zip'};if('PvdGu'===_0x12c12b['OWenk']){expect(cfTemplate['Resources']['FooLambdaFunction']['Properties']['Code']['S3Key']['endsWith'](_0x3a2557['qrnpl']))['to']['be']['true'];}else{_0x31b8e7=sandbox['stub'](_0x58eb08['provider'],'request');}});_0x684bae['UhFwJ'](afterEach,()=>{_0x58eb08['provider']['request']['restore']();});_0x684bae['SLGDH'](it,_0x684bae['dQlKO'],()=>{var _0x7ddae4={'kESPo':'dev','PyPAu':_0x12c12b['NgRFI'],'qhrjL':_0x12c12b['loODl'],'GUJpz':_0x12c12b['VmxgN'],'skKDr':_0x12c12b['GCSbn'],'NJHak':function(_0x4eb438,_0x1e4b48,_0x1f3db5){return _0x12c12b['bKXQb'](_0x4eb438,_0x1e4b48,_0x1f3db5);},'JFaML':_0x12c12b['gjgkn']};if(_0x12c12b['iKvql'](_0x12c12b['Javky'],'GGUFL')){const _0x27295a={'stage':_0x7ddae4['kESPo'],'region':_0x7ddae4['PyPAu']};_0x1215db=new Serverless();_0x1215db['serviceDir']=_0x7ddae4['qhrjL'];_0x1856c6=new AwsProvider(_0x1215db,_0x27295a);_0x1215db['setProvider'](_0x7ddae4['GUJpz'],_0x1856c6);_0x1215db['service']['service']=_0x7ddae4['qhrjL'];_0x58eb08=new AwsDeploy(_0x1215db,_0x27295a);_0x58eb08['bucketName']=_0x7ddae4['skKDr'];_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']={'foo':'bar'};_0x14d70a='serverless/'+_0x1215db['service']['service']+'/'+_0x1856c6['getStage']();_0x58eb08['serverless']['cli']={'log':sandbox['spy']()};_0x33af28={'createHash'(){return this;},'update'(){return this;},'digest':sandbox['stub']()};const _0x156d7c=_0x7ddae4['NJHak'](proxyquire,_0x7ddae4['JFaML'],{'crypto':_0x33af28});Object['assign'](_0x58eb08,_0x156d7c);}else{_0x31b8e7['resolves']();return _0x12c12b['OmYsL'](expect,_0x58eb08['getMostRecentObjects']())['to']['be']['fulfilled']['then'](_0xd973a8=>{_0x12c12b['nJHwc'](expect,_0x31b8e7)['to']['have']['been']['calledWithExactly']('S3',_0x12c12b['VtRsA'],{'Bucket':_0x58eb08['bucketName'],'Prefix':_0x12c12b['RXGwl']});_0x12c12b['IAoXz'](expect,_0xd973a8)['to']['deep']['equal']([]);});}});_0x684bae['ufmor'](it,_0x684bae['NxMVQ'],()=>{_0x31b8e7['rejects'](new ServerlessError(_0x684bae['tZSvP']));return _0x684bae['Mxwgl'](expect,_0x58eb08['getMostRecentObjects']())['to']['be']['rejectedWith'](['The\x20serverless\x20deployment\x20bucket\x20\x22'+_0x58eb08['bucketName']+'" does not exist.',_0x684bae['GoFzx'],_0x684bae['etdLj']]['join']('\x20'));});it(_0x684bae['sBiCX'],()=>{_0x31b8e7['rejects'](new ServerlessError(_0x684bae['RUCpB']));return _0x684bae['Mxwgl'](expect,_0x58eb08['getMostRecentObjects']())['to']['be']['rejectedWith'](_0x684bae['RUCpB']);});_0x684bae['NzHSD'](it,'should\x20resolve\x20if\x20result\x20array\x20is\x20empty',()=>{var _0x37672e={'aiewo':function(_0x3e6842,_0x9e5a60){return _0x12c12b['OmYsL'](_0x3e6842,_0x9e5a60);},'jPxWc':function(_0x4dff04,_0x351045){return _0x12c12b['INRdM'](_0x4dff04,_0x351045);},'PkiGa':_0x12c12b['qGIZZ'],'wDDFX':_0x12c12b['DTVfK'],'FIvDx':_0x12c12b['RXGwl']};const _0x38bfeb={'Contents':[]};_0x31b8e7['resolves'](_0x38bfeb);return _0x12c12b['OmYsL'](expect,_0x58eb08['getMostRecentObjects']())['to']['be']['fulfilled']['then'](_0x1e0fb4=>{var _0x1095e5={'iPUfL':function(_0x58b2d1,_0x24cc08){return _0x58b2d1(_0x24cc08);},'hoHyn':function(_0x3e18a4,_0x56c8aa){return _0x37672e['aiewo'](_0x3e18a4,_0x56c8aa);}};if(_0x37672e['jPxWc'](_0x37672e['PkiGa'],_0x37672e['wDDFX'])){const _0x1405a3=[];return expect(_0x58eb08['getObjectMetadata'](_0x1405a3))['to']['be']['fulfilled']['then'](_0xbdbd0e=>{_0x1095e5['iPUfL'](expect,headObjectStub)['to']['not']['have']['been']['called'];_0x1095e5['hoHyn'](expect,_0xbdbd0e)['to']['deep']['equal']([]);});}else{_0x37672e['aiewo'](expect,_0x31b8e7)['to']['have']['been']['calledWithExactly']('S3','listObjectsV2',{'Bucket':_0x58eb08['bucketName'],'Prefix':_0x37672e['FIvDx']});expect(_0x1e0fb4)['to']['deep']['equal']([]);}});});_0x684bae['NzHSD'](it,_0x684bae['OWXWk'],()=>{var _0x5727c5={'miiVl':function(_0x4fa26c,_0x192313){return _0x4fa26c(_0x192313);},'agvDK':_0x684bae['cttoB'],'mniZA':function(_0x6c43f3,_0x20125b){return _0x6c43f3(_0x20125b);},'sFrHG':'.serverless/func1.zip','GynAO':function(_0xda88cf,_0x4b349f){return _0xda88cf(_0x4b349f);},'xoWyT':function(_0x1296d3,_0x525cf6){return _0x684bae['gucZc'](_0x1296d3,_0x525cf6);},'SYJEa':_0x684bae['amFel'],'bQins':function(_0x46a496,_0x3ac9de){return _0x684bae['ygaYj'](_0x46a496,_0x3ac9de);},'UzdrW':function(_0x5e107f,_0x24563b){return _0x684bae['FJCuX'](_0x5e107f,_0x24563b);},'SxLYy':_0x684bae['QMUJf'],'ghVib':_0x684bae['xHxtZ'],'hRYKb':function(_0x37590b,_0x2f5555){return _0x684bae['DGcGU'](_0x37590b,_0x2f5555);},'rCsVM':_0x684bae['oRepI'],'xcoQp':_0x684bae['aNeUI']};if(_0x684bae['QvvJU'](_0x684bae['DqDyn'],'tfvUT')){const _0x352132={'Contents':[{'Key':_0x14d70a+'/151224711231-2016-08-18T15:43:00/artifact.zip'},{'Key':_0x14d70a+'/151224711231-2016-08-18T15:43:00/cloudformation.json'},{'Key':_0x14d70a+'/141264711231-2016-08-18T15:42:00/artifact.zip'},{'Key':_0x14d70a+'/141264711231-2016-08-18T15:42:00/cloudformation.json'}]};_0x31b8e7['resolves'](_0x352132);return expect(_0x58eb08['getMostRecentObjects']())['to']['be']['fulfilled']['then'](_0x102843=>{if(_0x5727c5['xoWyT'](_0x5727c5['SYJEa'],_0x5727c5['SYJEa'])){_0x5727c5['GynAO'](expect,_0x31b8e7)['to']['have']['been']['calledWithExactly']('S3','listObjectsV2',{'Bucket':_0x58eb08['bucketName'],'Prefix':'serverless/my-service/dev'});_0x5727c5['GynAO'](expect,_0x102843)['to']['deep']['equal']([{'Key':_0x14d70a+'/151224711231-2016-08-18T15:43:00/cloudformation.json'},{'Key':_0x14d70a+'/151224711231-2016-08-18T15:43:00/artifact.zip'}]);}else{_0x5727c5['miiVl'](expect,normalizeCloudFormationTemplateStub)['to']['have']['been']['calledOnce'];_0x5727c5['miiVl'](expect,globbySyncStub)['to']['have']['been']['calledOnce'];expect(readFileStub)['to']['have']['been']['calledTwice'];expect(_0x58eb08['serverless']['cli']['log'])['to']['have']['been']['calledOnce'];_0x5727c5['miiVl'](expect,normalizeCloudFormationTemplateStub)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);_0x5727c5['miiVl'](expect,globbySyncStub)['to']['have']['been']['calledWithExactly'](['**.zip'],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],_0x5727c5['agvDK']),'dot':!![],'silent':!![]});_0x5727c5['mniZA'](expect,readFileStub)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x5727c5['sFrHG']));_0x5727c5['GynAO'](expect,readFileStub)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],'.serverless/func2.zip'));_0x5727c5['GynAO'](expect,_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](!![]);}});}else{globbySyncStub['returns']([_0x5727c5['rCsVM']]);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns']('local-hash-cf-template');_0x33af28['createHash']()['update']()['digest']['onCall'](0x1)['returns'](_0x5727c5['xcoQp']);const _0x9c12ed=[{'Metadata':{'filesha256':'remote-hash-cf-template'}},{'Metadata':{'filesha256':'remote-hash-zip-file-1'}}];return _0x5727c5['hRYKb'](expect,_0x58eb08['checkIfDeploymentIsNecessary'](_0x9c12ed))['to']['be']['fulfilled']['then'](()=>{_0x5727c5['bQins'](expect,normalizeCloudFormationTemplateStub)['to']['have']['been']['calledOnce'];expect(globbySyncStub)['to']['have']['been']['calledOnce'];_0x5727c5['bQins'](expect,readFileStub)['to']['have']['been']['calledOnce'];_0x5727c5['bQins'](expect,_0x58eb08['serverless']['cli']['log'])['to']['not']['have']['been']['called'];_0x5727c5['UzdrW'](expect,normalizeCloudFormationTemplateStub)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);expect(globbySyncStub)['to']['have']['been']['calledWithExactly']([_0x5727c5['SxLYy']],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],_0x5727c5['agvDK']),'dot':!![],'silent':!![]});_0x5727c5['UzdrW'](expect,readFileStub)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x5727c5['ghVib']));_0x5727c5['hRYKb'](expect,_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](undefined);});}});}});describe(_0x684bae['lcSsc'],()=>{var _0x1895c2={'qwmhJ':_0x684bae['QKswr'],'zlWBD':_0x684bae['DtQng'],'rDtrf':'my-service.zip','koTio':'local-hash-cf-template','LMsBn':_0x684bae['dmTJi'],'IZcvR':function(_0x5a6f69,_0x31f1dc){return _0x684bae['KwNhy'](_0x5a6f69,_0x31f1dc);},'cVCLe':_0x684bae['Ymxai'],'sZjST':function(_0x17c021,_0x3d5d9f){return _0x17c021(_0x3d5d9f);},'IhhyE':_0x684bae['QMUJf'],'CFfcb':function(_0x5a4234,_0x1ed156){return _0x684bae['DRxOR'](_0x5a4234,_0x1ed156);},'Lceuv':_0x684bae['JlxUR'],'NfxOU':_0x684bae['IvKLB'],'hULRX':'1|3|2|4|0','tEgpm':function(_0x1fe96a,_0x318e7b){return _0x684bae['iIqSc'](_0x1fe96a,_0x318e7b);},'UmnqT':'headObject','GbOJF':function(_0x59209f,_0x40fff8){return _0x59209f(_0x40fff8);},'pgQIs':function(_0x430774,_0x515c4f){return _0x684bae['iIqSc'](_0x430774,_0x515c4f);}};if('AKLzc'!=='AKLzc'){const _0x2d1224=_0x1215db['getProvider'](_0x1895c2['qwmhJ'])['naming'];return{'subscriptionFilters':[{'filterName':_0x2d1224['getStackName']()+'-'+_0x2d1224['getCloudWatchLogLogicalId'](_0x1895c2['zlWBD'],0x1)+'-xxxxx','destinationArn':'arn:aws:lambda:us-east-1:999999999999:function:test-checkForChanges-cdr3ogg-dev-fn1'}]};}else{let _0x531cc5;_0x684bae['ouDie'](beforeEach,()=>{_0x531cc5=sandbox['stub'](_0x58eb08['provider'],_0x684bae['INGSf'])['resolves']();});_0x684bae['ouDie'](afterEach,()=>{var _0x52e581={'rJAdx':_0x1895c2['cVCLe'],'BeFcl':function(_0x5c37b8,_0x5366bd){return _0x1895c2['sZjST'](_0x5c37b8,_0x5366bd);},'hYsRP':function(_0x2031b0,_0x4c6516){return _0x2031b0(_0x4c6516);},'TkrAZ':function(_0x55fe75,_0x425b38){return _0x1895c2['sZjST'](_0x55fe75,_0x425b38);},'isrfz':function(_0x2f6a51,_0x4e1c20){return _0x1895c2['sZjST'](_0x2f6a51,_0x4e1c20);},'EpzgH':_0x1895c2['IhhyE'],'lOPkO':'.serverless','kAOWj':'.serverless/my-service.zip'};if(_0x1895c2['CFfcb'](_0x1895c2['Lceuv'],'fQrkG')){globbySyncStub['returns']([_0x1895c2['rDtrf']]);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns'](_0x1895c2['koTio']);const _0x321bb2=[{'Metadata':{'filesha256':_0x1895c2['LMsBn']}}];return _0x1895c2['IZcvR'](expect,_0x58eb08['checkIfDeploymentIsNecessary'](_0x321bb2))['to']['be']['fulfilled']['then'](()=>{var _0x325ce2=_0x52e581['rJAdx']['split']('|'),_0x5c9b4d=0x0;while(!![]){switch(_0x325ce2[_0x5c9b4d++]){case'0':_0x52e581['BeFcl'](expect,_0x58eb08['serverless']['cli']['log'])['to']['not']['have']['been']['called'];continue;case'1':_0x52e581['hYsRP'](expect,normalizeCloudFormationTemplateStub)['to']['have']['been']['calledOnce'];continue;case'2':_0x52e581['TkrAZ'](expect,normalizeCloudFormationTemplateStub)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);continue;case'3':_0x52e581['isrfz'](expect,globbySyncStub)['to']['have']['been']['calledOnce'];continue;case'4':expect(_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](undefined);continue;case'5':expect(readFileStub)['to']['have']['been']['calledOnce'];continue;case'6':_0x52e581['isrfz'](expect,globbySyncStub)['to']['have']['been']['calledWithExactly']([_0x52e581['EpzgH']],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],_0x52e581['lOPkO']),'dot':!![],'silent':!![]});continue;case'7':expect(readFileStub)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x52e581['kAOWj']));continue;}break;}});}else{_0x58eb08['provider']['request']['restore']();}});_0x684bae['NzHSD'](it,_0x684bae['BpaOi'],()=>expect(_0x58eb08['getObjectMetadata']())['to']['be']['fulfilled']['then'](_0x5c0d6c=>{expect(_0x531cc5)['to']['not']['have']['been']['called'];_0x684bae['UhFwJ'](expect,_0x5c0d6c)['to']['deep']['equal']([]);}));_0x684bae['byFuc'](it,_0x684bae['YJWjR'],()=>{var _0xdf438b={'oyHNT':function(_0x2dd854,_0x3f29c2){return _0x684bae['UhFwJ'](_0x2dd854,_0x3f29c2);},'MDglL':'.serverless','fGYAU':_0x684bae['xHxtZ'],'mtPbf':_0x684bae['dmTJi'],'hfBtx':function(_0x4d6190,_0x58daee){return _0x4d6190===_0x58daee;},'aeMsH':_0x684bae['xstio'],'wzAnE':_0x684bae['ugVKB'],'WBLTp':function(_0x1117df,_0x151b6a){return _0x1117df(_0x151b6a);}};if(_0x684bae['QvvJU'](_0x684bae['NRpug'],_0x684bae['QUDTo'])){const _0x45fb8f=_0x1215db['getProvider'](_0x1895c2['qwmhJ'])['naming'];return{'subscriptionFilters':[{'filterName':_0x45fb8f['getStackName']()+'-'+_0x45fb8f['getCloudWatchLogLogicalId'](_0x1895c2['zlWBD'],0x1)+'-xxxxx','destinationArn':'arn:aws:lambda:us-east-1:999999999999:function:'+_0x1215db['service']['getFunction'](_0x1895c2['NfxOU'])['name']}]};}else{const _0x4836aa=[];return _0x684bae['UhFwJ'](expect,_0x58eb08['getObjectMetadata'](_0x4836aa))['to']['be']['fulfilled']['then'](_0x568009=>{var _0x37b254={'upUmT':function(_0x46f6fd,_0x25ef42){return _0xdf438b['oyHNT'](_0x46f6fd,_0x25ef42);},'ctJTd':_0xdf438b['MDglL'],'Ftgle':_0xdf438b['fGYAU'],'LdZOV':'local-hash-cf-template','mxUpY':_0xdf438b['mtPbf'],'Zrweg':'remote-hash-zip-file-1'};if(_0xdf438b['hfBtx'](_0xdf438b['aeMsH'],_0xdf438b['wzAnE'])){globbySyncStub['returns'](['my-service.zip']);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns'](_0x37b254['LdZOV']);_0x33af28['createHash']()['update']()['digest']['onCall'](0x1)['returns']('local-hash-zip-file-1');const _0x202794=[{'Metadata':{'filesha256':_0x37b254['mxUpY']}},{'Metadata':{'filesha256':_0x37b254['Zrweg']}},{'Metadata':{}}];return _0x37b254['upUmT'](expect,_0x58eb08['checkIfDeploymentIsNecessary'](_0x202794))['to']['be']['fulfilled']['then'](()=>{expect(normalizeCloudFormationTemplateStub)['to']['have']['been']['calledOnce'];expect(globbySyncStub)['to']['have']['been']['calledOnce'];expect(readFileStub)['to']['have']['been']['calledOnce'];_0x37b254['upUmT'](expect,_0x58eb08['serverless']['cli']['log'])['to']['not']['have']['been']['called'];_0x37b254['upUmT'](expect,normalizeCloudFormationTemplateStub)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);expect(globbySyncStub)['to']['have']['been']['calledWithExactly'](['**.zip'],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],_0x37b254['ctJTd']),'dot':!![],'silent':!![]});_0x37b254['upUmT'](expect,readFileStub)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x37b254['Ftgle']));_0x37b254['upUmT'](expect,_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](undefined);});}else{_0xdf438b['WBLTp'](expect,_0x531cc5)['to']['not']['have']['been']['called'];expect(_0x568009)['to']['deep']['equal']([]);}});}});it('should\x20request\x20the\x20object\x20detailed\x20information',()=>{const _0x813a42=[{'Key':_0x14d70a+'/151224711231-2016-08-18T15:43:00/artifact.zip'},{'Key':_0x14d70a+'/151224711231-2016-08-18T15:43:00/cloudformation.json'},{'Key':_0x14d70a+'/141264711231-2016-08-18T15:42:00/artifact.zip'},{'Key':_0x14d70a+'/141264711231-2016-08-18T15:42:00/cloudformation.json'}];return expect(_0x58eb08['getObjectMetadata'](_0x813a42))['to']['be']['fulfilled']['then'](()=>{var _0x597c16=_0x1895c2['hULRX']['split']('|'),_0x2f0592=0x0;while(!![]){switch(_0x597c16[_0x2f0592++]){case'0':_0x1895c2['tEgpm'](expect,_0x531cc5)['to']['have']['been']['calledWithExactly']('S3',_0x1895c2['UmnqT'],{'Bucket':_0x58eb08['bucketName'],'Key':_0x14d70a+'/141264711231-2016-08-18T15:42:00/cloudformation.json'});continue;case'1':expect(_0x531cc5['callCount'])['to']['equal'](0x4);continue;case'2':_0x1895c2['GbOJF'](expect,_0x531cc5)['to']['have']['been']['calledWithExactly']('S3',_0x1895c2['UmnqT'],{'Bucket':_0x58eb08['bucketName'],'Key':_0x14d70a+'/151224711231-2016-08-18T15:43:00/cloudformation.json'});continue;case'3':_0x1895c2['GbOJF'](expect,_0x531cc5)['to']['have']['been']['calledWithExactly']('S3','headObject',{'Bucket':_0x58eb08['bucketName'],'Key':_0x14d70a+'/151224711231-2016-08-18T15:43:00/artifact.zip'});continue;case'4':_0x1895c2['pgQIs'](expect,_0x531cc5)['to']['have']['been']['calledWithExactly']('S3',_0x1895c2['UmnqT'],{'Bucket':_0x58eb08['bucketName'],'Key':_0x14d70a+'/141264711231-2016-08-18T15:42:00/artifact.zip'});continue;}break;}});});}});describe('#checkIfDeploymentIsNecessary()',()=>{var _0x1bad7a={'bpfRs':'hash-cf-template','rzein':_0x684bae['EHfZY'],'LQPYc':function(_0x4c524b,_0x484268){return _0x684bae['hgBIB'](_0x4c524b,_0x484268);},'GapYH':_0x684bae['DysBE'],'YdgKK':_0x684bae['gNZsk'],'MTgUt':'sync','nrMMU':function(_0x54e256,_0x37dcc3){return _0x684bae['fcYgG'](_0x54e256,_0x37dcc3);},'oCJZt':function(_0x31f40f,_0x658be3){return _0x684bae['fcYgG'](_0x31f40f,_0x658be3);},'kvcTv':'1|7|3|2|4|0|6|5','LSrnF':'**.zip','YvKnN':function(_0x13613f,_0x1eff09){return _0x684bae['ZrWoj'](_0x13613f,_0x1eff09);},'GMzSc':function(_0x4e02a0,_0x2fb25b){return _0x684bae['HKqDX'](_0x4e02a0,_0x2fb25b);},'DQFJH':function(_0x41d186,_0x10c835){return _0x41d186(_0x10c835);},'FQaAu':_0x684bae['xHxtZ'],'XOCMA':_0x684bae['geepb'],'FGneY':_0x684bae['cgoQL'],'qeBhy':function(_0x25f53c,_0x592ec8){return _0x684bae['HKqDX'](_0x25f53c,_0x592ec8);},'gthLt':function(_0x1bf2c6,_0x35693e){return _0x684bae['ahMmD'](_0x1bf2c6,_0x35693e);},'hdspg':'DGqCS','RNdRG':'local-hash-cf-template','XxVTr':_0x684bae['aNeUI'],'bWLxv':'remote-hash-zip-file-1','IBcJf':function(_0x5dfeb1,_0x4ba145){return _0x684bae['ahMmD'](_0x5dfeb1,_0x4ba145);},'YlXdu':'0|4|1|3|2|5|6|7','bYTQZ':function(_0x29cd1a,_0x21411a){return _0x684bae['ahMmD'](_0x29cd1a,_0x21411a);},'KBAli':_0x684bae['cttoB'],'yuKIg':function(_0x5c465c,_0x2a312e){return _0x684bae['PfOxd'](_0x5c465c,_0x2a312e);},'ScJBt':_0x684bae['oRepI'],'dglsm':'hash-zip-file-1','wGbZl':function(_0x23f65b,_0x2adedf){return _0x684bae['PfOxd'](_0x23f65b,_0x2adedf);},'VkcvJ':function(_0x52a032,_0x28d73f){return _0x52a032(_0x28d73f);},'UzYDM':function(_0x49394b,_0x3a7693){return _0x684bae['TbMQr'](_0x49394b,_0x3a7693);},'ukCip':function(_0x33cdc0,_0x33f790){return _0x684bae['PfOxd'](_0x33cdc0,_0x33f790);},'tWdRG':'.serverless/func1.zip','QnwyC':_0x684bae['RErNp'],'JbNNF':function(_0xf135a9,_0x215837){return _0x684bae['HwBEn'](_0xf135a9,_0x215837);},'DwHYx':_0x684bae['EYRQv'],'OLzTl':_0x684bae['aBHfW'],'RgeuT':function(_0x30e2d4,_0x5867fc){return _0x684bae['PfOxd'](_0x30e2d4,_0x5867fc);},'AxeXd':'foo/bar/my-own.zip','cLvfj':function(_0x1bb32e,_0x4e87ce){return _0x1bb32e(_0x4e87ce);},'JdGlN':function(_0xaa8119,_0x52472b){return _0x684bae['BvRWI'](_0xaa8119,_0x52472b);}};let _0x5ab697;let _0x3ebd22;let _0x4e9350;beforeEach(()=>{var _0x450194={'jJWKk':function(_0x5495f0,_0x23eb45){return _0x1bad7a['LQPYc'](_0x5495f0,_0x23eb45);},'cmiip':'foo/bar/my-own.zip','VOncH':'.serverless'};if(_0x1bad7a['GapYH']==='MlSnl'){_0x5ab697=sandbox['stub'](normalizeFiles,_0x1bad7a['YdgKK'])['returns']();_0x3ebd22=sandbox['stub'](globby,_0x1bad7a['MTgUt']);_0x4e9350=sandbox['stub'](fs,'readFile')['yields'](null,undefined);}else{_0x58eb08['serverless']['service']['package']={'artifact':'foo/bar/my-own.zip'};_0x3ebd22['returns']([]);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns'](_0x1bad7a['bpfRs']);_0x33af28['createHash']()['update']()['digest']['onCall'](0x1)['returns']('local-my-own-hash');const _0x1e84b1=[{'Metadata':{'filesha256':_0x1bad7a['bpfRs']}},{'Metadata':{'filesha256':_0x1bad7a['rzein']}}];return expect(_0x58eb08['checkIfDeploymentIsNecessary'](_0x1e84b1))['to']['be']['fulfilled']['then'](()=>{var _0x5a4255='5|1|2|7|6|4|3|0'['split']('|'),_0x50147e=0x0;while(!![]){switch(_0x5a4255[_0x50147e++]){case'0':_0x450194['jJWKk'](expect,_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](undefined);continue;case'1':_0x450194['jJWKk'](expect,_0x3ebd22)['to']['have']['been']['calledOnce'];continue;case'2':expect(_0x4e9350)['to']['have']['been']['calledOnce'];continue;case'3':expect(_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x450194['cmiip']));continue;case'4':_0x450194['jJWKk'](expect,_0x3ebd22)['to']['have']['been']['calledWithExactly'](['**.zip'],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],_0x450194['VOncH']),'dot':!![],'silent':!![]});continue;case'5':expect(_0x5ab697)['to']['have']['been']['calledOnce'];continue;case'6':_0x450194['jJWKk'](expect,_0x5ab697)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);continue;case'7':_0x450194['jJWKk'](expect,_0x58eb08['serverless']['cli']['log'])['not']['to']['be']['called'];continue;}break;}});}});_0x684bae['BvRWI'](afterEach,()=>{normalizeFiles['normalizeCloudFormationTemplate']['restore']();globby['sync']['restore']();fs['readFile']['restore']();});_0x684bae['byFuc'](it,_0x684bae['BpaOi'],()=>expect(_0x58eb08['checkIfDeploymentIsNecessary']())['to']['be']['fulfilled']['then'](()=>{_0x684bae['ouDie'](expect,_0x5ab697)['to']['not']['have']['been']['called'];_0x684bae['exHBB'](expect,_0x3ebd22)['to']['not']['have']['been']['called'];_0x684bae['exHBB'](expect,_0x4e9350)['to']['not']['have']['been']['called'];expect(_0x58eb08['serverless']['cli']['log'])['to']['not']['have']['been']['called'];}));_0x684bae['byFuc'](it,'should\x20resolve\x20if\x20no\x20objects\x20are\x20provided\x20as\x20input',()=>{var _0x2f99ea={'pDGvd':function(_0x3d027f,_0x12384d){return _0x684bae['IkIGH'](_0x3d027f,_0x12384d);},'hPGiY':function(_0x4a698d,_0x2bdd62){return _0x684bae['OiPHx'](_0x4a698d,_0x2bdd62);}};if(_0x684bae['Okqtw']('XLsDf',_0x684bae['MWZlX'])){const _0x6fc8db=[];return _0x684bae['QchaM'](expect,_0x58eb08['checkIfDeploymentIsNecessary'](_0x6fc8db))['to']['be']['fulfilled']['then'](()=>{expect(_0x5ab697)['to']['not']['have']['been']['called'];_0x2f99ea['pDGvd'](expect,_0x3ebd22)['to']['not']['have']['been']['called'];_0x2f99ea['hPGiY'](expect,_0x4e9350)['to']['not']['have']['been']['called'];_0x2f99ea['hPGiY'](expect,_0x58eb08['serverless']['cli']['log'])['to']['not']['have']['been']['called'];});}else{_0x1bad7a['nrMMU'](expect,getMostRecentObjectsStub)['to']['not']['have']['been']['called'];expect(getObjectMetadataStub)['to']['not']['have']['been']['called'];_0x1bad7a['nrMMU'](expect,checkIfDeploymentIsNecessaryStub)['to']['not']['have']['been']['called'];_0x1bad7a['oCJZt'](expect,_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](![]);}});_0x684bae['RlIoc'](it,_0x684bae['oqNqd'],()=>{var _0x5c7966={'FVJvx':_0x684bae['KRUvk'],'ARUks':function(_0x4780f7,_0x2a4bb0){return _0x4780f7(_0x2a4bb0);},'wexwD':function(_0x3216a0,_0x324924){return _0x684bae['wfQvm'](_0x3216a0,_0x324924);},'jLuQc':_0x684bae['xHxtZ'],'gmiMD':function(_0x3212e1,_0x2ae63b){return _0x684bae['wfQvm'](_0x3212e1,_0x2ae63b);},'JEXEc':function(_0x4eb535,_0x27e76f){return _0x4eb535(_0x27e76f);},'fveZp':function(_0xc7e138,_0x5850ea){return _0x684bae['wfQvm'](_0xc7e138,_0x5850ea);},'hJHVr':_0x684bae['cttoB'],'aEvbK':function(_0x83c13b,_0x1a9270){return _0x83c13b(_0x1a9270);},'upxTX':_0x684bae['MnaXf'],'KBFJN':'**.zip','YhSgA':function(_0x2cc27c,_0x75b332){return _0x684bae['wfQvm'](_0x2cc27c,_0x75b332);},'MzdhZ':function(_0x51d756,_0x33248e){return _0x684bae['wfQvm'](_0x51d756,_0x33248e);},'bMsgo':function(_0x1ca03e,_0x39dd91){return _0x1ca03e(_0x39dd91);},'zTvLq':_0x684bae['oRepI'],'VvTUt':'hash-zip-file-1','aXwOR':_0x684bae['IvufD'],'sYZcJ':function(_0x8bc073,_0x40319e){return _0x684bae['wfQvm'](_0x8bc073,_0x40319e);}};if(_0x684bae['YBPMm']!==_0x684bae['WGjoV']){_0x3ebd22['returns']([_0x684bae['oRepI']]);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns'](_0x684bae['NSAMC']);const _0x17f06f=[{'Metadata':{'filesha256':_0x684bae['dmTJi']}}];return _0x684bae['wfQvm'](expect,_0x58eb08['checkIfDeploymentIsNecessary'](_0x17f06f))['to']['be']['fulfilled']['then'](()=>{var _0x46059b=_0x5c7966['FVJvx']['split']('|'),_0x29ea26=0x0;while(!![]){switch(_0x46059b[_0x29ea26++]){case'0':_0x5c7966['ARUks'](expect,_0x4e9350)['to']['have']['been']['calledOnce'];continue;case'1':_0x5c7966['wexwD'](expect,_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x5c7966['jLuQc']));continue;case'2':_0x5c7966['wexwD'](expect,_0x58eb08['serverless']['cli']['log'])['to']['not']['have']['been']['called'];continue;case'3':expect(_0x5ab697)['to']['have']['been']['calledOnce'];continue;case'4':_0x5c7966['gmiMD'](expect,_0x5ab697)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);continue;case'5':_0x5c7966['JEXEc'](expect,_0x3ebd22)['to']['have']['been']['calledOnce'];continue;case'6':_0x5c7966['fveZp'](expect,_0x3ebd22)['to']['have']['been']['calledWithExactly'](['**.zip'],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],_0x5c7966['hJHVr']),'dot':!![],'silent':!![]});continue;case'7':_0x5c7966['aEvbK'](expect,_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](undefined);continue;}break;}});}else{_0x3ebd22['returns']([_0x5c7966['zTvLq']]);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns']('hash-cf-template');_0x33af28['createHash']()['update']()['digest']['onCall'](0x1)['returns'](_0x5c7966['VvTUt']);const _0x48b728=[{'Metadata':{'filesha256':_0x5c7966['aXwOR']}},{'Metadata':{'filesha256':'hash-zip-file-1'}}];return _0x5c7966['sYZcJ'](expect,_0x58eb08['checkIfDeploymentIsNecessary'](_0x48b728))['to']['be']['fulfilled']['then'](()=>{var _0xca07e3=_0x5c7966['upxTX']['split']('|'),_0x3c01f1=0x0;while(!![]){switch(_0xca07e3[_0x3c01f1++]){case'0':_0x5c7966['aEvbK'](expect,_0x58eb08['serverless']['cli']['log'])['to']['have']['been']['calledOnce'];continue;case'1':expect(_0x5ab697)['to']['have']['been']['calledOnce'];continue;case'2':_0x5c7966['aEvbK'](expect,_0x3ebd22)['to']['have']['been']['calledWithExactly']([_0x5c7966['KBFJN']],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],_0x5c7966['hJHVr']),'dot':!![],'silent':!![]});continue;case'3':_0x5c7966['YhSgA'](expect,_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](!![]);continue;case'4':expect(_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x5c7966['jLuQc']));continue;case'5':_0x5c7966['MzdhZ'](expect,_0x3ebd22)['to']['have']['been']['calledOnce'];continue;case'6':_0x5c7966['bMsgo'](expect,_0x4e9350)['to']['have']['been']['calledOnce'];continue;case'7':_0x5c7966['bMsgo'](expect,_0x5ab697)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);continue;}break;}});}});_0x684bae['RlIoc'](it,_0x684bae['rypxA'],()=>{_0x3ebd22['returns']([_0x684bae['oRepI']]);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns'](_0x684bae['NSAMC']);_0x33af28['createHash']()['update']()['digest']['onCall'](0x1)['returns'](_0x684bae['aNeUI']);const _0x396eb2=[{'Metadata':{'filesha256':_0x684bae['dmTJi']}},{'Metadata':{'filesha256':_0x684bae['GApjV']}},{'Metadata':{}}];return _0x684bae['wfQvm'](expect,_0x58eb08['checkIfDeploymentIsNecessary'](_0x396eb2))['to']['be']['fulfilled']['then'](()=>{var _0x272ffd=_0x1bad7a['kvcTv']['split']('|'),_0x5eb10d=0x0;while(!![]){switch(_0x272ffd[_0x5eb10d++]){case'0':expect(_0x3ebd22)['to']['have']['been']['calledWithExactly']([_0x1bad7a['LSrnF']],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],'.serverless'),'dot':!![],'silent':!![]});continue;case'1':_0x1bad7a['oCJZt'](expect,_0x5ab697)['to']['have']['been']['calledOnce'];continue;case'2':_0x1bad7a['oCJZt'](expect,_0x58eb08['serverless']['cli']['log'])['to']['not']['have']['been']['called'];continue;case'3':_0x1bad7a['YvKnN'](expect,_0x4e9350)['to']['have']['been']['calledOnce'];continue;case'4':_0x1bad7a['GMzSc'](expect,_0x5ab697)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);continue;case'5':_0x1bad7a['DQFJH'](expect,_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](undefined);continue;case'6':expect(_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x1bad7a['FQaAu']));continue;case'7':_0x1bad7a['DQFJH'](expect,_0x3ebd22)['to']['have']['been']['calledOnce'];continue;}break;}});});_0x684bae['pcJcf'](it,_0x684bae['XIDwp'],()=>{var _0x3006aa={'hffMF':function(_0x5c83b5,_0x9c4aba){return _0x5c83b5(_0x9c4aba);},'JZFts':_0x1bad7a['XOCMA'],'tmNHM':'Should\x20recognize\x20package.artifact','NJpVp':_0x1bad7a['FGneY'],'wSYwx':function(_0x1cdf00,_0x4055e4){return _0x1bad7a['qeBhy'](_0x1cdf00,_0x4055e4);},'paHmY':_0x1bad7a['FQaAu'],'jncdI':function(_0x1fcce1,_0x1fb39a){return _0x1bad7a['gthLt'](_0x1fcce1,_0x1fb39a);},'vkTjb':function(_0x285f09,_0x3db9c0){return _0x285f09(_0x3db9c0);}};if(_0x1bad7a['hdspg']!==_0x1bad7a['hdspg']){var _0x532f5f={'vtKEt':function(_0x5d157e,_0x5e9fc9){return _0x3006aa['hffMF'](_0x5d157e,_0x5e9fc9);},'eXqBb':_0x3006aa['JZFts']};it(_0x3006aa['tmNHM'],()=>runServerless({'fixture':'packageArtifact','command':'deploy','env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':'ignore'},'lastLifecycleHookName':'aws:deploy:deploy:checkForChanges','awsRequestStubMap':{'CloudFormation':{'describeStacks':{},'describeStackResource':{'StackResourceDetail':{'PhysicalResourceId':'deployment-bucket'}}},'Lambda':{'getFunction':{'Configuration':{'LastModified':'2020-05-20T15:34:16.494+0000'}}},'S3':{'headObject':{'Metadata':{'filesha256':'RRYyTm4Ri8mocpvx44pvas4JKLYtdJS3Z8MOlrZrDXA='}},'listObjectsV2':{'Contents':[{'Key':'serverless/test-package-artifact/dev/1589988704359-2020-05-20T15:31:44.359Z/artifact.zip','LastModified':new Date(),'ETag':'\x225102a4cf710cae6497dba9e61b85d0a4\x22','Size':0x164,'StorageClass':'STANDARD'}]}},'STS':{'getCallerIdentity':{'ResponseMetadata':{'RequestId':'ffffffff-ffff-ffff-ffff-ffffffffffff'},'UserId':'XXXXXXXXXXXXXXXXXXXXX','Account':'999999999999','Arn':'arn:aws:iam::999999999999:user/test'}}}})['then'](({cfTemplate})=>{_0x532f5f['vtKEt'](expect,cfTemplate['Resources']['FooLambdaFunction']['Properties']['Code']['S3Key']['endsWith'](_0x532f5f['eXqBb']))['to']['be']['true'];}));}else{_0x3ebd22['returns'](['my-service.zip']);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns'](_0x1bad7a['RNdRG']);_0x33af28['createHash']()['update']()['digest']['onCall'](0x1)['returns'](_0x1bad7a['XxVTr']);const _0x54b896=[{'Metadata':{'filesha256':'remote-hash-cf-template'}},{'Metadata':{'filesha256':_0x1bad7a['bWLxv']}}];return _0x1bad7a['IBcJf'](expect,_0x58eb08['checkIfDeploymentIsNecessary'](_0x54b896))['to']['be']['fulfilled']['then'](()=>{var _0x23a88a=_0x3006aa['NJpVp']['split']('|'),_0x167a62=0x0;while(!![]){switch(_0x23a88a[_0x167a62++]){case'0':_0x3006aa['wSYwx'](expect,_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](undefined);continue;case'1':expect(_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x3006aa['paHmY']));continue;case'2':expect(_0x5ab697)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);continue;case'3':_0x3006aa['jncdI'](expect,_0x3ebd22)['to']['have']['been']['calledOnce'];continue;case'4':_0x3006aa['vkTjb'](expect,_0x5ab697)['to']['have']['been']['calledOnce'];continue;case'5':expect(_0x3ebd22)['to']['have']['been']['calledWithExactly'](['**.zip'],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],'.serverless'),'dot':!![],'silent':!![]});continue;case'6':_0x3006aa['vkTjb'](expect,_0x4e9350)['to']['have']['been']['calledOnce'];continue;case'7':expect(_0x58eb08['serverless']['cli']['log'])['to']['not']['have']['been']['called'];continue;}break;}});}});_0x684bae['pcJcf'](it,'should not set a flag if remote and local hashes are the same but are duplicated',()=>{var _0x6bd6a8={'wrvbn':_0x684bae['sjrLr'],'zvCLf':function(_0x257e09,_0x51fa8d){return _0x684bae['wfQvm'](_0x257e09,_0x51fa8d);},'PVrYu':'.serverless','pKPvl':_0x684bae['oRepI'],'MsOkM':_0x684bae['IvufD'],'GBhFp':_0x684bae['ecIiw'],'vqsEx':function(_0xd1eb16,_0x15b35e){return _0x684bae['QvvJU'](_0xd1eb16,_0x15b35e);},'CSoKc':_0x684bae['fcxFx'],'dbhpy':_0x684bae['HJOGL'],'YpYHg':_0x684bae['ZHCCB'],'ICQEs':'.serverless/func2.zip','XqXih':'**.zip','qLxNG':function(_0x234b6b,_0x3e99ed){return _0x234b6b(_0x3e99ed);}};_0x3ebd22['returns']([_0x684bae['XlMEM'],_0x684bae['PzlzN']]);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns']('remote-hash-cf-template');_0x33af28['createHash']()['update']()['digest']['onCall'](0x1)['returns'](_0x684bae['GApjV']);_0x33af28['createHash']()['update']()['digest']['onCall'](0x2)['returns'](_0x684bae['GApjV']);const _0x3958a2=[{'Metadata':{'filesha256':_0x684bae['dmTJi']}},{'Metadata':{'filesha256':'remote-hash-zip-file-1'}}];return expect(_0x58eb08['checkIfDeploymentIsNecessary'](_0x3958a2))['to']['be']['fulfilled']['then'](()=>{var _0xf60945={'OyPvM':_0x6bd6a8['wrvbn'],'HIlyf':function(_0x42d931,_0x3d29fb){return _0x6bd6a8['zvCLf'](_0x42d931,_0x3d29fb);},'foTxe':function(_0x337157,_0x593c3c){return _0x6bd6a8['zvCLf'](_0x337157,_0x593c3c);},'DHeUC':_0x6bd6a8['PVrYu'],'oPAhS':_0x6bd6a8['pKPvl'],'hUFFV':_0x6bd6a8['MsOkM'],'VSVvX':function(_0x35510c,_0x42730e){return _0x35510c-_0x42730e;},'lWxGr':_0x6bd6a8['GBhFp']};if(_0x6bd6a8['vqsEx']('nEvtx',_0x6bd6a8['CSoKc'])){var _0x32c0fd={'qUZPm':_0xf60945['OyPvM'],'qkStu':function(_0x32b04d,_0x405111){return _0xf60945['HIlyf'](_0x32b04d,_0x405111);},'jUMTB':function(_0x2a063b,_0x5b94fa){return _0xf60945['foTxe'](_0x2a063b,_0x5b94fa);},'NMryH':_0xf60945['DHeUC']};_0x3ebd22['returns']([_0xf60945['oPAhS']]);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns'](_0xf60945['hUFFV']);_0x33af28['createHash']()['update']()['digest']['onCall'](0x1)['returns']('hash-zip-file-1');const _0x4e4044=new Date(new Date()['getTime']()-0x186a0);const _0x15af67=new Date(_0xf60945['VSVvX'](new Date()['getTime'](),0x30d40));const _0x26db21=[{'Metadata':{'filesha256':_0xf60945['hUFFV']},'LastModified':_0x15af67},{'Metadata':{'filesha256':_0xf60945['lWxGr']},'LastModified':_0x15af67}];return _0xf60945['foTxe'](expect,_0x58eb08['checkIfDeploymentIsNecessary'](_0x26db21,_0x4e4044))['to']['be']['fulfilled']['then'](()=>{var _0x5e3088=_0x32c0fd['qUZPm']['split']('|'),_0x26f52b=0x0;while(!![]){switch(_0x5e3088[_0x26f52b++]){case'0':_0x32c0fd['qkStu'](expect,_0x3ebd22)['to']['have']['been']['calledOnce'];continue;case'1':_0x32c0fd['jUMTB'](expect,_0x5ab697)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);continue;case'2':_0x32c0fd['jUMTB'](expect,_0x4e9350)['to']['have']['been']['calledOnce'];continue;case'3':_0x32c0fd['jUMTB'](expect,_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](!![]);continue;case'4':_0x32c0fd['jUMTB'](expect,_0x5ab697)['to']['have']['been']['calledOnce'];continue;case'5':expect(_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],'.serverless/my-service.zip'));continue;case'6':_0x32c0fd['jUMTB'](expect,_0x3ebd22)['to']['have']['been']['calledWithExactly'](['**.zip'],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],_0x32c0fd['NMryH']),'dot':!![],'silent':!![]});continue;case'7':_0x32c0fd['jUMTB'](expect,_0x58eb08['serverless']['cli']['log'])['to']['have']['been']['calledOnce'];continue;}break;}});}else{var _0x2165a3=_0x6bd6a8['dbhpy']['split']('|'),_0x3b7223=0x0;while(!![]){switch(_0x2165a3[_0x3b7223++]){case'0':expect(_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x6bd6a8['YpYHg']));continue;case'1':_0x6bd6a8['zvCLf'](expect,_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x6bd6a8['ICQEs']));continue;case'2':_0x6bd6a8['zvCLf'](expect,_0x5ab697)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);continue;case'3':_0x6bd6a8['zvCLf'](expect,_0x5ab697)['to']['have']['been']['calledOnce'];continue;case'4':_0x6bd6a8['zvCLf'](expect,_0x3ebd22)['to']['have']['been']['calledWithExactly']([_0x6bd6a8['XqXih']],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],_0x6bd6a8['PVrYu']),'dot':!![],'silent':!![]});continue;case'5':_0x6bd6a8['zvCLf'](expect,_0x3ebd22)['to']['have']['been']['calledOnce'];continue;case'6':_0x6bd6a8['qLxNG'](expect,_0x4e9350)['to']['have']['been']['calledTwice'];continue;case'7':expect(_0x58eb08['serverless']['cli']['log'])['to']['not']['have']['been']['called'];continue;case'8':expect(_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](undefined);continue;}break;}}});});_0x684bae['oVeqs'](it,_0x684bae['OSDfy'],()=>{var _0x26c5b3={'EUpCR':function(_0x805fc,_0x4150df){return _0x684bae['QvvJU'](_0x805fc,_0x4150df);},'iyRUh':_0x684bae['mmBBH'],'UfMlq':function(_0x53d302,_0x2d495e){return _0x53d302(_0x2d495e);},'vxzhe':function(_0x1955f5,_0x3655e0){return _0x684bae['wfQvm'](_0x1955f5,_0x3655e0);},'VCKcx':function(_0x57ef5e,_0x534efb){return _0x57ef5e(_0x534efb);},'YbcKN':function(_0x51b87f,_0x724c95){return _0x51b87f(_0x724c95);},'NVDlM':function(_0x56bf7b,_0x526715){return _0x684bae['wfQvm'](_0x56bf7b,_0x526715);},'geupZ':_0x684bae['cttoB'],'NmaAP':function(_0x29dd63,_0x2739a1){return _0x684bae['HyFqK'](_0x29dd63,_0x2739a1);}};if(_0x684bae['QvvJU']('ZUIHP',_0x684bae['bRCAI'])){_0x3ebd22['returns'](['my-service.zip']);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns'](_0x684bae['IvufD']);_0x33af28['createHash']()['update']()['digest']['onCall'](0x1)['returns']('hash-zip-file-1');const _0x3fc1ea=new Date();const _0x45e2c0=new Date(new Date()['getTime']()-0x186a0);const _0x5fe840=new Date(new Date()['getTime']()+0x186a0);const _0x39d120=[{'Metadata':{'filesha256':_0x684bae['IvufD']},'LastModified':_0x45e2c0},{'Metadata':{'filesha256':'hash-zip-file-1'},'LastModified':_0x5fe840}];return _0x684bae['HyFqK'](expect,_0x58eb08['checkIfDeploymentIsNecessary'](_0x39d120,_0x3fc1ea))['to']['be']['fulfilled']['then'](()=>{if(_0x26c5b3['EUpCR']('VzbKw','VzbKw')){var _0x327949=_0x26c5b3['iyRUh']['split']('|'),_0x3ca1d0=0x0;while(!![]){switch(_0x327949[_0x3ca1d0++]){case'0':expect(_0x4e9350)['to']['have']['been']['calledOnce'];continue;case'1':expect(_0x3ebd22)['to']['have']['been']['calledWithExactly'](['**.zip'],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],'.serverless'),'dot':!![],'silent':!![]});continue;case'2':expect(_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](undefined);continue;case'3':_0x26c5b3['UfMlq'](expect,_0x5ab697)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);continue;case'4':_0x26c5b3['vxzhe'](expect,_0x5ab697)['to']['have']['been']['calledOnce'];continue;case'5':_0x26c5b3['VCKcx'](expect,_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],'.serverless/my-service.zip'));continue;case'6':expect(_0x3ebd22)['to']['have']['been']['calledOnce'];continue;case'7':expect(_0x58eb08['serverless']['cli']['log'])['to']['not']['have']['been']['called'];continue;}break;}}else{_0x58eb08['provider']['request']['restore']();}});}else{var _0x2733e1='6|3|2|7|5|4|1|0'['split']('|'),_0x2f0749=0x0;while(!![]){switch(_0x2733e1[_0x2f0749++]){case'0':_0x26c5b3['YbcKN'](expect,_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](undefined);continue;case'1':_0x26c5b3['YbcKN'](expect,_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],'.serverless/my-service.zip'));continue;case'2':_0x26c5b3['YbcKN'](expect,_0x4e9350)['to']['have']['been']['calledOnce'];continue;case'3':_0x26c5b3['NVDlM'](expect,_0x3ebd22)['to']['have']['been']['calledOnce'];continue;case'4':_0x26c5b3['NVDlM'](expect,_0x3ebd22)['to']['have']['been']['calledWithExactly'](['**.zip'],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],_0x26c5b3['geupZ']),'dot':!![],'silent':!![]});continue;case'5':expect(_0x5ab697)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);continue;case'6':_0x26c5b3['NVDlM'](expect,_0x5ab697)['to']['have']['been']['calledOnce'];continue;case'7':_0x26c5b3['NmaAP'](expect,_0x58eb08['serverless']['cli']['log'])['to']['not']['have']['been']['called'];continue;}break;}}});_0x684bae['oVeqs'](it,_0x684bae['AcZrR'],()=>{_0x3ebd22['returns']([_0x1bad7a['ScJBt']]);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns'](_0x1bad7a['bpfRs']);_0x33af28['createHash']()['update']()['digest']['onCall'](0x1)['returns'](_0x1bad7a['dglsm']);const _0x5935cc=[{'Metadata':{'filesha256':_0x1bad7a['bpfRs']}},{'Metadata':{'filesha256':'hash-zip-file-1'}}];return _0x1bad7a['wGbZl'](expect,_0x58eb08['checkIfDeploymentIsNecessary'](_0x5935cc))['to']['be']['fulfilled']['then'](()=>{var _0xf0c121=_0x1bad7a['YlXdu']['split']('|'),_0x3ae8d0=0x0;while(!![]){switch(_0xf0c121[_0x3ae8d0++]){case'0':_0x1bad7a['IBcJf'](expect,_0x5ab697)['to']['have']['been']['calledOnce'];continue;case'1':expect(_0x4e9350)['to']['have']['been']['calledOnce'];continue;case'2':_0x1bad7a['IBcJf'](expect,_0x5ab697)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);continue;case'3':_0x1bad7a['bYTQZ'](expect,_0x58eb08['serverless']['cli']['log'])['to']['have']['been']['calledOnce'];continue;case'4':_0x1bad7a['bYTQZ'](expect,_0x3ebd22)['to']['have']['been']['calledOnce'];continue;case'5':_0x1bad7a['bYTQZ'](expect,_0x3ebd22)['to']['have']['been']['calledWithExactly']([_0x1bad7a['LSrnF']],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],_0x1bad7a['KBAli']),'dot':!![],'silent':!![]});continue;case'6':_0x1bad7a['yuKIg'](expect,_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x1bad7a['FQaAu']));continue;case'7':expect(_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](!![]);continue;}break;}});});_0x684bae['NskIF'](it,_0x684bae['PUneM'],()=>{var _0x27db13={'bGpzp':function(_0x38900d,_0x3f352c){return _0x1bad7a['VkcvJ'](_0x38900d,_0x3f352c);},'EKSEp':'**.zip','khacm':function(_0x2c7365,_0x3886a4){return _0x2c7365(_0x3886a4);}};_0x3ebd22['returns']([_0x1bad7a['ScJBt']]);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns'](_0x1bad7a['bpfRs']);_0x33af28['createHash']()['update']()['digest']['onCall'](0x1)['returns'](_0x1bad7a['dglsm']);const _0x50ad50=new Date(new Date()['getTime']()-0x186a0);const _0x12c389=new Date(_0x1bad7a['UzYDM'](new Date()['getTime'](),0x30d40));const _0xe751f0=[{'Metadata':{'filesha256':_0x1bad7a['bpfRs']},'LastModified':_0x12c389},{'Metadata':{'filesha256':_0x1bad7a['dglsm']},'LastModified':_0x12c389}];return expect(_0x58eb08['checkIfDeploymentIsNecessary'](_0xe751f0,_0x50ad50))['to']['be']['fulfilled']['then'](()=>{_0x27db13['bGpzp'](expect,_0x5ab697)['to']['have']['been']['calledOnce'];_0x27db13['bGpzp'](expect,_0x3ebd22)['to']['have']['been']['calledOnce'];expect(_0x4e9350)['to']['have']['been']['calledOnce'];expect(_0x58eb08['serverless']['cli']['log'])['to']['have']['been']['calledOnce'];expect(_0x5ab697)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);expect(_0x3ebd22)['to']['have']['been']['calledWithExactly']([_0x27db13['EKSEp']],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],'.serverless'),'dot':!![],'silent':!![]});_0x27db13['khacm'](expect,_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],'.serverless/my-service.zip'));expect(_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](!![]);});});_0x684bae['PlrYv'](it,_0x684bae['JOHLP'],()=>{var _0x5a7b57={'CWKfR':function(_0x28c223,_0x3457e7){return _0x28c223(_0x3457e7);},'Imecb':function(_0xc43bfb,_0x50fe23){return _0xc43bfb(_0x50fe23);},'oGPTR':'**.zip','YumKP':_0x684bae['cttoB'],'vUviM':function(_0x459ec6,_0x45af8d){return _0x684bae['Xolft'](_0x459ec6,_0x45af8d);},'yeYre':function(_0x357514,_0x9c9a16){return _0x684bae['fUAqD'](_0x357514,_0x9c9a16);}};_0x3ebd22['returns']([_0x684bae['XlMEM'],_0x684bae['PzlzN']]);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns']('hash-cf-template');_0x33af28['createHash']()['update']()['digest']['onCall'](0x1)['returns'](_0x684bae['ecIiw']);_0x33af28['createHash']()['update']()['digest']['onCall'](0x2)['returns'](_0x684bae['ecIiw']);const _0x2872a9=[{'Metadata':{'filesha256':_0x684bae['IvufD']}},{'Metadata':{'filesha256':'hash-zip-file-1'}},{'Metadata':{'filesha256':'hash-zip-file-1'}}];return _0x684bae['goSuj'](expect,_0x58eb08['checkIfDeploymentIsNecessary'](_0x2872a9))['to']['be']['fulfilled']['then'](()=>{var _0x5ba334='1|6|5|7|8|3|4|0|2'['split']('|'),_0x44b43b=0x0;while(!![]){switch(_0x5ba334[_0x44b43b++]){case'0':_0x5a7b57['CWKfR'](expect,_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],'.serverless/func2.zip'));continue;case'1':_0x5a7b57['CWKfR'](expect,_0x5ab697)['to']['have']['been']['calledOnce'];continue;case'2':expect(_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](!![]);continue;case'3':_0x5a7b57['Imecb'](expect,_0x3ebd22)['to']['have']['been']['calledWithExactly']([_0x5a7b57['oGPTR']],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],_0x5a7b57['YumKP']),'dot':!![],'silent':!![]});continue;case'4':_0x5a7b57['vUviM'](expect,_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],'.serverless/func1.zip'));continue;case'5':expect(_0x4e9350)['to']['have']['been']['calledTwice'];continue;case'6':expect(_0x3ebd22)['to']['have']['been']['calledOnce'];continue;case'7':_0x5a7b57['vUviM'](expect,_0x58eb08['serverless']['cli']['log'])['to']['have']['been']['calledOnce'];continue;case'8':_0x5a7b57['yeYre'](expect,_0x5ab697)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);continue;}break;}});});_0x684bae['PlrYv'](it,_0x684bae['AhcwO'],()=>{var _0x26d08c={'AJWlv':_0x684bae['XlMEM'],'tkNnZ':_0x684bae['PzlzN'],'IQvKT':'hash-cf-template','TFrSz':'hash-zip-file-1','NddLp':function(_0x2241b0,_0x2076a5){return _0x2241b0(_0x2076a5);}};_0x58eb08['serverless']['service']['package']={'artifact':_0x684bae['pkHHD']};_0x3ebd22['returns']([]);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns'](_0x684bae['IvufD']);_0x33af28['createHash']()['update']()['digest']['onCall'](0x1)['returns'](_0x684bae['OknZT']);const _0x222287=[{'Metadata':{'filesha256':_0x684bae['IvufD']}},{'Metadata':{'filesha256':_0x684bae['EHfZY']}}];return _0x684bae['goSuj'](expect,_0x58eb08['checkIfDeploymentIsNecessary'](_0x222287))['to']['be']['fulfilled']['then'](()=>{var _0x191c29={'OaByG':function(_0x4ca3d0,_0x302f3f){return _0x1bad7a['VkcvJ'](_0x4ca3d0,_0x302f3f);},'xrKhK':function(_0x29acce,_0x2e4518){return _0x1bad7a['ukCip'](_0x29acce,_0x2e4518);},'dZYTZ':function(_0x293a11,_0x13427d){return _0x1bad7a['ukCip'](_0x293a11,_0x13427d);},'QVsVu':function(_0x1a8f96,_0x500907){return _0x1bad7a['ukCip'](_0x1a8f96,_0x500907);},'QBYaP':_0x1bad7a['KBAli'],'MmVhF':_0x1bad7a['tWdRG'],'AUizE':_0x1bad7a['QnwyC']};if(_0x1bad7a['JbNNF']('Mrvck',_0x1bad7a['DwHYx'])){_0x3ebd22['returns']([_0x26d08c['AJWlv'],_0x26d08c['tkNnZ']]);_0x33af28['createHash']()['update']()['digest']['onCall'](0x0)['returns'](_0x26d08c['IQvKT']);_0x33af28['createHash']()['update']()['digest']['onCall'](0x1)['returns']('hash-zip-file-1');_0x33af28['createHash']()['update']()['digest']['onCall'](0x2)['returns'](_0x26d08c['TFrSz']);const _0x44a20c=[{'Metadata':{'filesha256':'hash-cf-template'}},{'Metadata':{'filesha256':_0x26d08c['TFrSz']}},{'Metadata':{'filesha256':_0x26d08c['TFrSz']}}];return _0x26d08c['NddLp'](expect,_0x58eb08['checkIfDeploymentIsNecessary'](_0x44a20c))['to']['be']['fulfilled']['then'](()=>{_0x191c29['OaByG'](expect,_0x5ab697)['to']['have']['been']['calledOnce'];_0x191c29['xrKhK'](expect,_0x3ebd22)['to']['have']['been']['calledOnce'];expect(_0x4e9350)['to']['have']['been']['calledTwice'];expect(_0x58eb08['serverless']['cli']['log'])['to']['have']['been']['calledOnce'];_0x191c29['dZYTZ'](expect,_0x5ab697)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);_0x191c29['QVsVu'](expect,_0x3ebd22)['to']['have']['been']['calledWithExactly'](['**.zip'],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],_0x191c29['QBYaP']),'dot':!![],'silent':!![]});_0x191c29['QVsVu'](expect,_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x191c29['MmVhF']));_0x191c29['QVsVu'](expect,_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x191c29['AUizE']));expect(_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](!![]);});}else{var _0x293564=_0x1bad7a['OLzTl']['split']('|'),_0x312aa7=0x0;while(!![]){switch(_0x293564[_0x312aa7++]){case'0':expect(_0x58eb08['serverless']['cli']['log'])['not']['to']['be']['called'];continue;case'1':_0x1bad7a['RgeuT'](expect,_0x58eb08['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](undefined);continue;case'2':_0x1bad7a['RgeuT'](expect,_0x4e9350)['to']['have']['been']['calledWith'](path['resolve'](_0x58eb08['serverless']['serviceDir'],_0x1bad7a['AxeXd']));continue;case'3':_0x1bad7a['cLvfj'](expect,_0x3ebd22)['to']['have']['been']['calledWithExactly']([_0x1bad7a['LSrnF']],{'cwd':path['join'](_0x58eb08['serverless']['serviceDir'],_0x1bad7a['KBAli']),'dot':!![],'silent':!![]});continue;case'4':_0x1bad7a['cLvfj'](expect,_0x5ab697)['to']['have']['been']['calledWithExactly'](_0x58eb08['serverless']['service']['provider']['compiledCloudFormationTemplate']);continue;case'5':expect(_0x4e9350)['to']['have']['been']['calledOnce'];continue;case'6':expect(_0x5ab697)['to']['have']['been']['calledOnce'];continue;case'7':_0x1bad7a['JdGlN'](expect,_0x3ebd22)['to']['have']['been']['calledOnce'];continue;}break;}}});});});});describe('checkForChanges #2',()=>{var _0x120c1d={'OQvlx':function(_0x410340,_0x50aa4f){return _0x410340(_0x50aa4f);},'ZzlrA':'/artifact.zip','vehHw':function(_0xa47f14,_0x5dd0b4,_0x4f8281){return _0xa47f14(_0x5dd0b4,_0x4f8281);}};_0x120c1d['vehHw'](it,'Should recognize package.artifact',()=>runServerless({'fixture':'packageArtifact','command':'deploy','env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':'ignore'},'lastLifecycleHookName':'aws:deploy:deploy:checkForChanges','awsRequestStubMap':{'CloudFormation':{'describeStacks':{},'describeStackResource':{'StackResourceDetail':{'PhysicalResourceId':'deployment-bucket'}}},'Lambda':{'getFunction':{'Configuration':{'LastModified':'2020-05-20T15:34:16.494+0000'}}},'S3':{'headObject':{'Metadata':{'filesha256':'RRYyTm4Ri8mocpvx44pvas4JKLYtdJS3Z8MOlrZrDXA='}},'listObjectsV2':{'Contents':[{'Key':'serverless/test-package-artifact/dev/1589988704359-2020-05-20T15:31:44.359Z/artifact.zip','LastModified':new Date(),'ETag':'"5102a4cf710cae6497dba9e61b85d0a4"','Size':0x164,'StorageClass':'STANDARD'}]}},'STS':{'getCallerIdentity':{'ResponseMetadata':{'RequestId':'ffffffff-ffff-ffff-ffff-ffffffffffff'},'UserId':'XXXXXXXXXXXXXXXXXXXXX','Account':'999999999999','Arn':'arn:aws:iam::999999999999:user/test'}}}})['then'](({cfTemplate})=>{_0x120c1d['OQvlx'](expect,cfTemplate['Resources']['FooLambdaFunction']['Properties']['Code']['S3Key']['endsWith'](_0x120c1d['ZzlrA']))['to']['be']['true'];}));});const commonAwsSdkMock={'CloudFormation':{'describeStacks':{},'describeStackResource':{'StackResourceDetail':{'PhysicalResourceId':'deployment-bucket'}}},'STS':{'getCallerIdentity':{'ResponseMetadata':{'RequestId':'ffffffff-ffff-ffff-ffff-ffffffffffff'},'UserId':'XXXXXXXXXXXXXXXXXXXXX','Account':'999999999999','Arn':'arn:aws:iam::999999999999:user/test'}}};const generateMatchingListObjectsResponse=async _0x30cac9=>{const _0x5ecdbb=_0x30cac9['serviceDir']+'/.serverless';const _0x1b1c34=await globby(_0x5ecdbb,{'expandDirectories':{'extensions':['zip']}});_0x1b1c34['push']('compiled-cloudformation-template.json');return{'Contents':_0x1b1c34['map'](_0xb34cc5=>({'Key':'serverless/test-package-artifact/dev/1589988704359-2020-05-20T15:31:44.359Z/'+_0xb34cc5,'LastModified':new Date('2020-05-20T15:30:16.494+0000')}))};};const generateMatchingHeadObjectResponse=async(_0x5b8c49,{Key:_0x37f579})=>{var _0x310c10={'rpVzB':'close','FoJdu':function(_0x19287a,_0xd2fba6){return _0x19287a===_0xd2fba6;},'FnYnf':'compiled-cloudformation-template.json'};if(_0x310c10['FoJdu'](path['basename'](_0x37f579),_0x310c10['FnYnf'])){const _0x28c179=_0x5b8c49['service']['provider']['compiledCloudFormationTemplate'];const _0x35b52e=normalizeFiles['normalizeCloudFormationTemplate'](_0x28c179);const _0x3c56a4=crypto['createHash']('sha256')['update'](JSON['stringify'](_0x35b52e))['digest']('base64');return{'Metadata':{'filesha256':_0x3c56a4}};}const _0x2f365c=await(async _0x301530=>{return new Promise(_0x559619=>{const _0x45ef8a=crypto['createHash']('sha256');const _0x2f7ddc=fs['createReadStream'](_0x5b8c49['serviceDir']+'/.serverless/'+_0x301530);_0x2f7ddc['on']('data',_0x1adfd4=>_0x45ef8a['update'](_0x1adfd4));_0x2f7ddc['on'](_0x310c10['rpVzB'],()=>_0x559619(_0x45ef8a['digest']('base64')));});})(_0x37f579);return{'Metadata':{'filesha256':_0x2f365c}};};describe('test/unit/lib/plugins/aws/deploy/lib/checkForChanges.test.js',()=>{var _0x7ca2b7={'grfbl':function(_0x597fe1,_0x34e4d6){return _0x597fe1(_0x34e4d6);},'EYAtB':'checkForChanges','TVvpH':'deploy','ziUxb':'ignore','TtiUR':function(_0x1071fe,_0x255f62){return _0x1071fe(_0x255f62);},'DKeCl':function(_0x3a670e,_0x5eeff6){return _0x3a670e(_0x5eeff6);},'IWvDM':'aws:deploy:deploy:checkForChanges','FgKpB':'listObjectsV2','mqDHR':function(_0x5ef08e,_0x4f8017){return _0x5ef08e!==_0x4f8017;},'WuTsh':'SLBKV','IxDJK':'packageFoldern','QQNuX':function(_0xaf7241,_0x538b1c){return _0xaf7241(_0x538b1c);},'fthlY':function(_0x28d440,_0x2ad1ff){return _0x28d440(_0x2ad1ff);},'iMKBE':'2021-05-20T15:34:16.494+0000','ABtbT':function(_0x583292,_0x140b37){return _0x583292(_0x140b37);},'tQQyN':function(_0x679ba9,_0x2e4f41){return _0x679ba9(_0x2e4f41);},'yNDYH':function(_0x3282b6,_0x4dcbe4){return _0x3282b6(_0x4dcbe4);},'MrTTl':function(_0xac5c83,_0x4789e5){return _0xac5c83(_0x4789e5);},'espQf':function(_0x39d43e,_0x3b0fd1){return _0x39d43e(_0x3b0fd1);},'HNobZ':'TNiUc','zIFnW':function(_0x2e288c,_0x36ba0c){return _0x2e288c(_0x36ba0c);},'UVyLU':'package','DmpJt':function(_0x38e6a4,_0x285276){return _0x38e6a4(_0x285276);},'BExxi':function(_0xce71a6,_0x513dfd){return _0xce71a6(_0x513dfd);},'gpWOV':function(_0xa51504,_0x293a3c){return _0xa51504(_0x293a3c);},'ljXOr':function(_0x1b4f3c,_0x15ee25){return _0x1b4f3c(_0x15ee25);},'xqqFt':function(_0x2a85bf,_0x455823){return _0x2a85bf(_0x455823);},'FjxJy':'pZOdrt6qijT7ITsLQjPP9QwgMAfKA2RuUUSTW+l8wWs=','hLOAR':function(_0x4512c9,_0x719460){return _0x4512c9(_0x719460);},'LXpii':'packageArtifactInServerlessDir','pOrIX':'test-packageArtifactInServerlessDir','EhCac':'2020-05-20T15:34:16.494+0000','ODLSX':'STANDARD','GIGjh':'serverless/test-package-artifact/dev/1589988704359-2020-05-20T15:31:44.359Z/my-own.zip','NbDIZ':function(_0x2ebcb6,_0x5f59da){return _0x2ebcb6(_0x5f59da);},'YPvfG':' Deployment will not be skipped even if service files did not change. ','PmFSc':'serverless/my-service/dev','ENDch':function(_0x5b97e7,_0x1673d5){return _0x5b97e7(_0x1673d5);},'vvYHm':'DZYIh','dMKMv':'code','ZpBRK':'xtIhb','BZyXw':'aws','bUDOJ':'Fn1','RtnWO':'fn1','qqFbd':function(_0x309612,_0x1b09ce){return _0x309612!==_0x1b09ce;},'KhdRv':'zzwlv','OZoZX':'Fn2','CSArL':'TRBdW','BxLUN':'IORtD','SClaR':'arn:aws:lambda:us-east-1:999999999999:function:test-checkForChanges-cdr3ogg-dev-fn1','erodg':'someLogGroupName','leALF':'someLogGroupName1','VvIbx':'someLogGroupName2','cwhEq':'hash-cf-template','KuegS':'hash-zip-file-1','ZMsuF':function(_0x3fbd84,_0x295d62){return _0x3fbd84-_0x295d62;},'tnyRC':'**.zip','RwMZd':function(_0x289f70,_0x36d6bf){return _0x289f70===_0x36d6bf;},'yNqKb':'BdQZp','TzuiV':function(_0x59a57f,_0x5dfc97){return _0x59a57f(_0x5dfc97);},'biMlm':'XXXXXXXXXXXXXXXXXXXXX','RjEmX':'arn:aws-us-gov:iam::999999999999:user/test','TLlcT':function(_0x3cf7f0,_0x18ce4a){return _0x3cf7f0(_0x18ce4a);},'yDyLA':function(_0x4072f1,_0x4bd7a2){return _0x4072f1(_0x4bd7a2);},'uPMwW':'.serverless/my-service.zip','pMvEG':function(_0x1f54cb,_0x3c8376){return _0x1f54cb(_0x3c8376);},'MJjwx':function(_0x33e658,_0x3bcfbb){return _0x33e658(_0x3bcfbb);},'wNein':function(_0x4d2909,_0xde8f64){return _0x4d2909!==_0xde8f64;},'gHuVR':'oQICA','GzrCC':function(_0x1bde6e,_0x5b0ad3,_0x44d517){return _0x1bde6e(_0x5b0ad3,_0x44d517);},'cpolt':function(_0x29c1c2,_0x329515,_0x1d90b7){return _0x29c1c2(_0x329515,_0x1d90b7);},'iMAzB':'should\x20not\x20attempt\x20to\x20delete\x20filter\x20by\x202\x20subscription\x20filter\x20per\x20log\x20group','uCqGI':function(_0x2e6e15,_0x55eaa5,_0x10b573){return _0x2e6e15(_0x55eaa5,_0x10b573);},'WPBQZ':'should attempt to delete filter over 2 subscription filter per log group','vNBaC':function(_0x37bbb2,_0x403e5c,_0x5e056a){return _0x37bbb2(_0x403e5c,_0x5e056a);},'FCEZW':'should\x20attempt\x20to\x20delete\x20filter\x20if\x20order\x20of\x20cloudwatch\x20events\x20changed','EeRHW':'should attempt to delete multiple filters','rZfmF':'should recognize custom partition','vtABb':'TODO: should not deploy if artifacts in bucket are same as locally and modification dates for all functions are later than uploaded artifacts dates','jwKmI':'TODO: should deploy with --force option','ljEYG':'TODO: should compare against latest deployment artifacts','orcuU':'TODO: should deploy if individually packaged function was removed','pQGHP':'TODO: should deploy if custom package.artifact have changed','AmMzD':'should\x20skip\x20a\x20deployment\x20with\x20identical\x20hashes\x20and\x20package.artifact\x20targeting\x20.serverless\x20directory','VPTOv':function(_0x279188,_0x49e18a,_0x193111){return _0x279188(_0x49e18a,_0x193111);},'cahJc':'should\x20print\x20a\x20warning\x20if\x20missing\x20lambda:GetFunction\x20permission','xbBpv':'TODO: should crash meaningfully if bucket does not exist','UTveb':'TODO: should handle gently other AWS SDK errors','Izjuj':function(_0x246d11,_0x42765a,_0x1742ca){return _0x246d11(_0x42765a,_0x1742ca);},'LDCuv':'checkLogGroupSubscriptionFilterResourceLimitExceeded'};it['skip'](_0x7ca2b7['vtABb'],async()=>{let _0x147443;await _0x7ca2b7['grfbl'](runServerless,{'fixture':_0x7ca2b7['EYAtB'],'command':_0x7ca2b7['TVvpH'],'lastLifecycleHookName':'aws:deploy:deploy:checkForChanges','env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':_0x7ca2b7['ziUxb']},'hooks':{'beforeInstanceInit':_0xe26808=>_0x147443=_0xe26808},'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':{'Configuration':{'LastModified':'2021-05-20T15:34:16.494+0000'}}},'S3':{'listObjectsV2':async()=>generateMatchingListObjectsResponse(_0x147443),'headObject':async _0x41ae53=>generateMatchingHeadObjectResponse(_0x147443,_0x41ae53)}}});_0x7ca2b7['TtiUR'](expect,_0x147443['service']['provider']['shouldNotDeploy'])['to']['equal'](!![]);});it['skip'](_0x7ca2b7['jwKmI'],async()=>{let _0x1626c9;await _0x7ca2b7['DKeCl'](runServerless,{'fixture':'checkForChanges','command':'deploy','options':{'force':!![]},'lastLifecycleHookName':_0x7ca2b7['IWvDM'],'env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':'ignore'},'hooks':{'beforeInstanceInit':_0x301336=>_0x1626c9=_0x301336},'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':{'Configuration':{'LastModified':'2021-05-20T15:34:16.494+0000'}}},'S3':{'listObjectsV2':async()=>generateMatchingListObjectsResponse(_0x1626c9),'headObject':async _0x26ef36=>generateMatchingHeadObjectResponse(_0x1626c9,_0x26ef36)}}});_0x7ca2b7['DKeCl'](expect,_0x1626c9['service']['provider']['shouldNotDeploy'])['to']['equal'](![]);});it['skip']('TODO: should deploy when deployment bucket is empty (first deployment)',async()=>{var _0x139a03={'cABCx':function(_0xd6a949,_0x5a6cfb){return _0x7ca2b7['DKeCl'](_0xd6a949,_0x5a6cfb);},'ZAyJB':_0x7ca2b7['FgKpB']};if(_0x7ca2b7['mqDHR']('SLBKV',_0x7ca2b7['WuTsh'])){_0x139a03['cABCx'](expect,listObjectsV2Stub)['to']['have']['been']['calledWithExactly']('S3',_0x139a03['ZAyJB'],{'Bucket':awsDeploy['bucketName'],'Prefix':'serverless/my-service/dev'});_0x139a03['cABCx'](expect,result)['to']['deep']['equal']([]);}else{const {serverless}=await _0x7ca2b7['DKeCl'](runServerless,{'fixture':_0x7ca2b7['IxDJK'],'command':_0x7ca2b7['TVvpH'],'lastLifecycleHookName':_0x7ca2b7['IWvDM'],'env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':_0x7ca2b7['ziUxb']},'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':async()=>{}},'S3':{'listObjectsV2':async()=>{}}}});_0x7ca2b7['QQNuX'](expect,serverless['service']['provider']['shouldNotDeploy'])['to']['equal'](![]);}});it['skip'](_0x7ca2b7['ljEYG'],async()=>{let _0x34958b;await _0x7ca2b7['fthlY'](runServerless,{'fixture':'checkForChanges','command':'deploy','lastLifecycleHookName':'aws:deploy:deploy:checkForChanges','env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':_0x7ca2b7['ziUxb']},'hooks':{'beforeInstanceInit':_0x82223=>_0x34958b=_0x82223},'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':{'Configuration':{'LastModified':_0x7ca2b7['iMKBE']}}},'S3':{'listObjectsV2':async()=>generateMatchingListObjectsResponse(_0x34958b),'headObject':async _0x35b01c=>generateMatchingHeadObjectResponse(_0x34958b,_0x35b01c)}}});_0x7ca2b7['ABtbT'](expect,_0x34958b['service']['provider']['shouldNotDeploy'])['to']['equal'](!![]);});it['skip']('TODO: should deploy if new function was introduced and otherwise there were no other changes',async()=>{let _0x5e83bc;await _0x7ca2b7['tQQyN'](runServerless,{'fixture':'checkForChanges','command':'deploy','lastLifecycleHookName':_0x7ca2b7['IWvDM'],'env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':_0x7ca2b7['ziUxb']},'hooks':{'beforeInstanceInit':_0x29c4a6=>_0x5e83bc=_0x29c4a6},'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':()=>{}},'S3':{'listObjectsV2':async()=>generateMatchingListObjectsResponse(_0x5e83bc),'headObject':async _0x2633b9=>generateMatchingHeadObjectResponse(_0x5e83bc,_0x2633b9)}}});_0x7ca2b7['tQQyN'](expect,_0x5e83bc['service']['provider']['shouldNotDeploy'])['to']['equal'](![]);});it['skip'](_0x7ca2b7['orcuU'],async()=>{if(_0x7ca2b7['mqDHR'](_0x7ca2b7['HNobZ'],'wqrSc')){const {fixtureData:{updateConfig,servicePath:serviceDir}}=await _0x7ca2b7['zIFnW'](runServerless,{'fixture':_0x7ca2b7['EYAtB'],'command':_0x7ca2b7['UVyLU']});const _0x37fab4=await _0x7ca2b7['zIFnW'](generateMatchingListObjectsResponse,_0x5bf73d);await _0x7ca2b7['DmpJt'](updateConfig,{'functions':{'fnIndividually':null}});let _0x5bf73d;await _0x7ca2b7['BExxi'](runServerless,{'cwd':serviceDir,'command':_0x7ca2b7['UVyLU'],'lastLifecycleHookName':'aws:deploy:deploy:checkForChanges','env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':_0x7ca2b7['ziUxb']},'hooks':{'beforeInstanceInit':_0x5b0175=>_0x5bf73d=_0x5b0175},'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':{'Configuration':{'LastModified':'2021-05-20T15:34:16.494+0000'}}},'S3':{'listObjectsV2':()=>_0x37fab4,'headObject':async _0x277c44=>generateMatchingHeadObjectResponse(_0x5bf73d,_0x277c44)}}});_0x7ca2b7['BExxi'](expect,_0x5bf73d['service']['provider']['shouldNotDeploy'])['to']['equal'](![]);}else{expect(normalizeCloudFormationTemplateStub)['to']['not']['have']['been']['called'];_0x7ca2b7['yNDYH'](expect,globbySyncStub)['to']['not']['have']['been']['called'];_0x7ca2b7['MrTTl'](expect,readFileStub)['to']['not']['have']['been']['called'];_0x7ca2b7['espQf'](expect,awsDeploy['serverless']['cli']['log'])['to']['not']['have']['been']['called'];}});it['skip']('TODO:\x20should\x20deploy\x20if\x20remote\x20hashes\x20are\x20different',async()=>{let _0x22d464;await runServerless({'fixture':_0x7ca2b7['EYAtB'],'command':_0x7ca2b7['TVvpH'],'lastLifecycleHookName':'aws:deploy:deploy:checkForChanges','env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':_0x7ca2b7['ziUxb']},'hooks':{'beforeInstanceInit':_0x1c86ae=>_0x22d464=_0x1c86ae},'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':{'Configuration':{'LastModified':'2021-05-20T15:34:16.494+0000'}}},'S3':{'listObjectsV2':async()=>generateMatchingListObjectsResponse(_0x22d464),'headObject':async _0x3017c4=>generateMatchingHeadObjectResponse(_0x22d464,_0x3017c4)}}});expect(_0x22d464['service']['provider']['shouldNotDeploy'])['to']['equal'](![]);});it['skip']('TODO: should deploy if count of hashes (not their content) differs',async()=>{let _0x274f42;await _0x7ca2b7['gpWOV'](runServerless,{'fixture':_0x7ca2b7['EYAtB'],'command':_0x7ca2b7['TVvpH'],'configExt':{'package':{'individually':!![]}},'lastLifecycleHookName':'aws:deploy:deploy:checkForChanges','env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':_0x7ca2b7['ziUxb']},'hooks':{'beforeInstanceInit':_0x58d080=>_0x274f42=_0x58d080},'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':{'Configuration':{'LastModified':'2021-05-20T15:34:16.494+0000'}}},'S3':{'listObjectsV2':async()=>generateMatchingListObjectsResponse(_0x274f42),'headObject':async _0x4d5ae9=>generateMatchingHeadObjectResponse(_0x274f42,_0x4d5ae9)}}});_0x7ca2b7['ljXOr'](expect,_0x274f42['service']['provider']['shouldNotDeploy'])['to']['equal'](![]);});it['skip']('TODO: should deploy if uploaded artifacts are newer than function configuration modification date',async()=>{let _0x199da5;await runServerless({'fixture':_0x7ca2b7['EYAtB'],'command':'deploy','configExt':{'package':{'individually':!![]}},'lastLifecycleHookName':_0x7ca2b7['IWvDM'],'env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':'ignore'},'hooks':{'beforeInstanceInit':_0x55e06f=>_0x199da5=_0x55e06f},'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':()=>{}},'S3':{'listObjectsV2':async()=>generateMatchingListObjectsResponse(_0x199da5),'headObject':async _0x565c35=>generateMatchingHeadObjectResponse(_0x199da5,_0x565c35)}}});_0x7ca2b7['ljXOr'](expect,_0x199da5['service']['provider']['shouldNotDeploy'])['to']['equal'](![]);});it['skip'](_0x7ca2b7['pQGHP'],async()=>{let _0xe10072;await _0x7ca2b7['xqqFt'](runServerless,{'fixture':'checkForChanges','command':'deploy','configExt':{'package':{'artifact':'artifact.zip'}},'lastLifecycleHookName':'aws:deploy:deploy:checkForChanges','env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':_0x7ca2b7['ziUxb']},'hooks':{'beforeInstanceInit':_0x590a9b=>_0xe10072=_0x590a9b},'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':{'Configuration':{'LastModified':_0x7ca2b7['iMKBE']}}},'S3':{'listObjectsV2':async()=>generateMatchingListObjectsResponse(_0xe10072),'headObject':async _0x1bca4b=>generateMatchingHeadObjectResponse(_0xe10072,_0x1bca4b)}}});expect(_0xe10072['service']['provider']['shouldNotDeploy'])['to']['equal'](![]);});_0x7ca2b7['vNBaC'](it,_0x7ca2b7['AmMzD'],async()=>{var _0xb666db={'uUcng':'deployment-bucket','mmDZP':_0x7ca2b7['FjxJy'],'SCOqJ':'serverless/test-package-artifact/dev/1589988704359-2020-05-20T15:31:44.359Z/my-own.zip'};const {serverless}=await _0x7ca2b7['hLOAR'](runServerless,{'fixture':_0x7ca2b7['LXpii'],'command':_0x7ca2b7['TVvpH'],'configExt':{'service':_0x7ca2b7['pOrIX']},'env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':_0x7ca2b7['ziUxb']},'lastLifecycleHookName':_0x7ca2b7['IWvDM'],'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':{'Configuration':{'LastModified':_0x7ca2b7['EhCac']}}},'S3':{'headObject':(()=>{const _0x572363=sandbox['stub']();_0x572363['withArgs']({'Bucket':_0xb666db['uUcng'],'Key':'serverless/test-package-artifact/dev/1589988704359-2020-05-20T15:31:44.359Z/compiled-cloudformation-template.json'})['returns']({'Metadata':{'filesha256':_0xb666db['mmDZP']}});_0x572363['withArgs']({'Bucket':_0xb666db['uUcng'],'Key':_0xb666db['SCOqJ']})['returns']({'Metadata':{'filesha256':'T0qEYHOE4Xv2E8Ar03xGogAlElcdf/dQh/lh9ao7Glo='}});return _0x572363;})(),'listObjectsV2':{'Contents':[{'Key':'serverless/test-package-artifact/dev/1589988704359-2020-05-20T15:31:44.359Z/compiled-cloudformation-template.json','LastModified':new Date(),'ETag':'"5102a4cf710cae6497dba9e61b85d0a4"','Size':0x164,'StorageClass':_0x7ca2b7['ODLSX']},{'Key':_0x7ca2b7['GIGjh'],'LastModified':new Date(),'ETag':'"5102a4cf710cae6497dba9e61b85d0a4"','Size':0x164,'StorageClass':'STANDARD'}]}}}});_0x7ca2b7['hLOAR'](expect,serverless['service']['provider']['shouldNotDeploy'])['to']['equal'](!![]);});_0x7ca2b7['VPTOv'](it,_0x7ca2b7['cahJc'],async()=>{const {stdoutData}=await runServerless({'fixture':_0x7ca2b7['EYAtB'],'command':_0x7ca2b7['TVvpH'],'lastLifecycleHookName':_0x7ca2b7['IWvDM'],'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':sandbox['stub']()['throws']({'providerError':{'statusCode':0x193}})},'S3':{'listObjectsV2':{}}}});_0x7ca2b7['NbDIZ'](expect,stdoutData)['to']['include'](['WARNING: Not authorized to perform: lambda:GetFunction for at least one of the lambda functions.',_0x7ca2b7['YPvfG']]['join'](''));});it['skip'](_0x7ca2b7['xbBpv'],()=>{if(_0x7ca2b7['vvYHm']!==_0x7ca2b7['vvYHm']){expect(listObjectsV2Stub)['to']['have']['been']['calledWithExactly']('S3','listObjectsV2',{'Bucket':awsDeploy['bucketName'],'Prefix':_0x7ca2b7['PmFSc']});_0x7ca2b7['ENDch'](expect,result)['to']['deep']['equal']([]);}else{return expect(runServerless({'fixture':_0x7ca2b7['EYAtB'],'command':_0x7ca2b7['TVvpH'],'lastLifecycleHookName':_0x7ca2b7['IWvDM'],'env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':_0x7ca2b7['ziUxb']},'awsRequestStubMap':{...commonAwsSdkMock,'S3':{'listObjectsV2':async()=>{}}}}))['to']['eventually']['be']['rejected']['and']['have']['property'](_0x7ca2b7['dMKMv']);}});it['skip'](_0x7ca2b7['UTveb'],()=>{var _0x388bcc={'JDoWU':function(_0x4b3d4f,_0x1c2665){return _0x7ca2b7['ENDch'](_0x4b3d4f,_0x1c2665);},'hYXjn':_0x7ca2b7['FgKpB'],'hsxmC':'serverless/my-service/dev'};if('Tytiq'!==_0x7ca2b7['ZpBRK']){return expect(runServerless({'fixture':_0x7ca2b7['EYAtB'],'command':_0x7ca2b7['TVvpH'],'lastLifecycleHookName':_0x7ca2b7['IWvDM'],'env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':'ignore'},'awsRequestStubMap':{...commonAwsSdkMock,'S3':{'listObjectsV2':async()=>{}}}}))['to']['eventually']['be']['rejected']['and']['have']['property'](_0x7ca2b7['dMKMv']);}else{const _0x4f55ef={'Contents':[]};listObjectsV2Stub['resolves'](_0x4f55ef);return _0x7ca2b7['ENDch'](expect,awsDeploy['getMostRecentObjects']())['to']['be']['fulfilled']['then'](_0x225f21=>{_0x388bcc['JDoWU'](expect,listObjectsV2Stub)['to']['have']['been']['calledWithExactly']('S3',_0x388bcc['hYXjn'],{'Bucket':awsDeploy['bucketName'],'Prefix':_0x388bcc['hsxmC']});_0x388bcc['JDoWU'](expect,_0x225f21)['to']['deep']['equal']([]);});}});_0x7ca2b7['Izjuj'](describe,_0x7ca2b7['LDCuv'],()=>{var _0x2186d4={'ZTAbS':function(_0xc90c31,_0x4038e1){return _0x7ca2b7['yDyLA'](_0xc90c31,_0x4038e1);},'IPzda':_0x7ca2b7['uPMwW'],'eTLNt':function(_0x28466f,_0x16a8ef){return _0x7ca2b7['pMvEG'](_0x28466f,_0x16a8ef);},'jTutP':'aws','eKegR':'arn:aws:lambda:us-east-1:999999999999:function:test-checkForChanges-cdr3ogg-dev-fn1','Kfzxu':'Fn2','axExi':_0x7ca2b7['RtnWO'],'PQxKQ':_0x7ca2b7['bUDOJ'],'iZPBG':_0x7ca2b7['EYAtB'],'KfrAR':_0x7ca2b7['TVvpH'],'wzyUU':_0x7ca2b7['erodg'],'coovH':_0x7ca2b7['IWvDM'],'mAXqV':_0x7ca2b7['ziUxb'],'CVWMt':_0x7ca2b7['iMKBE'],'kJqva':function(_0x390be6,_0x4edb40){return _0x7ca2b7['MJjwx'](_0x390be6,_0x4edb40);},'vCnru':function(_0x53b745,_0x3bcc16){return _0x53b745(_0x3bcc16);}};if(_0x7ca2b7['wNein'](_0x7ca2b7['gHuVR'],_0x7ca2b7['gHuVR'])){const _0x444218=serverless['getProvider'](_0x7ca2b7['BZyXw'])['naming'];return{'subscriptionFilters':[{'filterName':_0x444218['getStackName']()+'-'+_0x444218['getCloudWatchLogLogicalId'](_0x7ca2b7['bUDOJ'],0x1)+'-xxxxx','destinationArn':'arn:aws:lambda:us-east-1:999999999999:function:'+serverless['service']['getFunction'](_0x7ca2b7['RtnWO'])['name']}]};}else{_0x7ca2b7['GzrCC'](it,'should not attempt to delete and add filter for same destination',async()=>{var _0x1611c0={'lydfN':_0x7ca2b7['BZyXw'],'elIHO':function(_0x13f5ce,_0x59b135){return _0x7ca2b7['qqFbd'](_0x13f5ce,_0x59b135);},'nKoqp':_0x7ca2b7['KhdRv'],'EJIZK':_0x7ca2b7['OZoZX'],'PhkPX':'arn:aws:lambda:us-east-1:999999999999:function:test-checkForChanges-cdr3ogg-dev-fn1'};if(_0x7ca2b7['CSArL']!==_0x7ca2b7['BxLUN']){const _0x514bef=sandbox['stub']();let _0x19b3fd;await _0x7ca2b7['ENDch'](runServerless,{'fixture':_0x7ca2b7['EYAtB'],'command':_0x7ca2b7['TVvpH'],'configExt':{'functions':{'fn1':{'events':[{'cloudwatchLog':'someLogGroupName'}]}}},'lastLifecycleHookName':_0x7ca2b7['IWvDM'],'env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':_0x7ca2b7['ziUxb']},'hooks':{'beforeInstanceInit':_0x2f75ce=>_0x19b3fd=_0x2f75ce},'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':{'Configuration':{'LastModified':'2021-05-20T15:34:16.494+0000'}}},'S3':{'listObjectsV2':async()=>generateMatchingListObjectsResponse(_0x19b3fd),'headObject':async _0x29ed36=>generateMatchingHeadObjectResponse(_0x19b3fd,_0x29ed36)},'CloudWatchLogs':{'deleteSubscriptionFilter':_0x514bef,'describeSubscriptionFilters':async()=>{if(_0x1611c0['elIHO'](_0x1611c0['nKoqp'],'zzwlv')){const _0x396f4f=_0x19b3fd['getProvider'](_0x1611c0['lydfN'])['naming'];return{'subscriptionFilters':[{'filterName':_0x396f4f['getStackName']()+'-'+_0x396f4f['getCloudWatchLogLogicalId']('Fn2',0x1)+'-xxxxx','destinationArn':'arn:aws:lambda:us-east-1:999999999999:function:test-checkForChanges-cdr3ogg-dev-fn1'},{'filterName':_0x396f4f['getStackName']()+'-'+_0x396f4f['getCloudWatchLogLogicalId']('Fn2',0x2)+'-xxxxx','destinationArn':'arn:aws:lambda:us-east-1:999999999999:function:'+_0x19b3fd['service']['getFunction']('fn1')['name']}]};}else{const _0x23235f=_0x19b3fd['service']['getFunction']('fn1')['name'];const _0xcd1f4b=_0x19b3fd['getProvider'](_0x1611c0['lydfN'])['naming'];return{'subscriptionFilters':[{'filterName':_0xcd1f4b['getStackName']()+'-'+_0xcd1f4b['getCloudWatchLogLogicalId']('Fn1',0x1)+'-xxxxx','destinationArn':'arn:aws:lambda:us-east-1:999999999999:function:'+_0x23235f},{'filterName':_0xcd1f4b['getStackName']()+'-'+_0xcd1f4b['getCloudWatchLogLogicalId'](_0x1611c0['EJIZK'],0x1)+'-xxxxx','destinationArn':_0x1611c0['PhkPX']}]};}}}}});expect(_0x514bef)['to']['not']['have']['been']['called'];}else{var _0x5d31df='6|4|7|2|5|1|0|3'['split']('|'),_0x4d003f=0x0;while(!![]){switch(_0x5d31df[_0x4d003f++]){case'0':_0x2186d4['ZTAbS'](expect,readFileStub)['to']['have']['been']['calledWith'](path['resolve'](awsDeploy['serverless']['serviceDir'],_0x2186d4['IPzda']));continue;case'1':expect(globbySyncStub)['to']['have']['been']['calledWithExactly'](['**.zip'],{'cwd':path['join'](awsDeploy['serverless']['serviceDir'],'.serverless'),'dot':!![],'silent':!![]});continue;case'2':_0x2186d4['eTLNt'](expect,awsDeploy['serverless']['cli']['log'])['to']['have']['been']['calledOnce'];continue;case'3':expect(awsDeploy['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](!![]);continue;case'4':expect(globbySyncStub)['to']['have']['been']['calledOnce'];continue;case'5':expect(normalizeCloudFormationTemplateStub)['to']['have']['been']['calledWithExactly'](awsDeploy['serverless']['service']['provider']['compiledCloudFormationTemplate']);continue;case'6':expect(normalizeCloudFormationTemplateStub)['to']['have']['been']['calledOnce'];continue;case'7':_0x2186d4['eTLNt'](expect,readFileStub)['to']['have']['been']['calledOnce'];continue;}break;}}});_0x7ca2b7['cpolt'](it,_0x7ca2b7['iMAzB'],async()=>{var _0x367727={'RAEco':_0x7ca2b7['SClaR']};const _0x30b969=sandbox['stub']();let _0x4d47a2;await runServerless({'fixture':_0x7ca2b7['EYAtB'],'command':_0x7ca2b7['TVvpH'],'configExt':{'functions':{'fn1':{'events':[{'cloudwatchLog':_0x7ca2b7['erodg']}]}}},'lastLifecycleHookName':_0x7ca2b7['IWvDM'],'env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':_0x7ca2b7['ziUxb']},'hooks':{'beforeInstanceInit':_0x220533=>_0x4d47a2=_0x220533},'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':{'Configuration':{'LastModified':_0x7ca2b7['iMKBE']}}},'S3':{'listObjectsV2':async()=>generateMatchingListObjectsResponse(_0x4d47a2),'headObject':async _0x3d7a9=>generateMatchingHeadObjectResponse(_0x4d47a2,_0x3d7a9)},'CloudWatchLogs':{'deleteSubscriptionFilter':_0x30b969,'describeSubscriptionFilters':async()=>{const _0x38f374=_0x4d47a2['getProvider']('aws')['naming'];return{'subscriptionFilters':[{'filterName':_0x38f374['getStackName']()+'-'+_0x38f374['getCloudWatchLogLogicalId']('Fn1',0x1)+'-xxxxx','destinationArn':_0x367727['RAEco']}]};}}}});_0x7ca2b7['ENDch'](expect,_0x30b969)['to']['not']['have']['been']['called'];});_0x7ca2b7['uCqGI'](it,_0x7ca2b7['WPBQZ'],async()=>{const _0x2ac7e6=sandbox['stub']();let _0x355c0f;const {awsNaming}=await _0x7ca2b7['ENDch'](runServerless,{'fixture':_0x7ca2b7['EYAtB'],'command':_0x7ca2b7['TVvpH'],'configExt':{'functions':{'fn1':{'events':[{'cloudwatchLog':_0x7ca2b7['erodg']}]}}},'lastLifecycleHookName':_0x7ca2b7['IWvDM'],'env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':'ignore'},'hooks':{'beforeInstanceInit':_0x209f0f=>_0x355c0f=_0x209f0f},'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':{'Configuration':{'LastModified':_0x7ca2b7['iMKBE']}}},'S3':{'listObjectsV2':async()=>generateMatchingListObjectsResponse(_0x355c0f),'headObject':async _0x2ce228=>generateMatchingHeadObjectResponse(_0x355c0f,_0x2ce228)},'CloudWatchLogs':{'deleteSubscriptionFilter':_0x2ac7e6,'describeSubscriptionFilters':async()=>{const _0x2df8cc=_0x355c0f['getProvider'](_0x2186d4['jTutP'])['naming'];return{'subscriptionFilters':[{'filterName':_0x2df8cc['getStackName']()+'-'+_0x2df8cc['getCloudWatchLogLogicalId']('Fn2',0x1)+'-xxxxx','destinationArn':_0x2186d4['eKegR']},{'filterName':_0x2df8cc['getStackName']()+'-'+_0x2df8cc['getCloudWatchLogLogicalId'](_0x2186d4['Kfzxu'],0x2)+'-xxxxx','destinationArn':'arn:aws:lambda:us-east-1:999999999999:function:'+_0x355c0f['service']['getFunction'](_0x2186d4['axExi'])['name']}]};}}}});_0x7ca2b7['ENDch'](expect,_0x2ac7e6)['to']['have']['been']['calledOnceWith']({'logGroupName':'someLogGroupName','filterName':awsNaming['getStackName']()+'-'+awsNaming['getCloudWatchLogLogicalId'](_0x7ca2b7['OZoZX'],0x2)+'-xxxxx'});});_0x7ca2b7['vNBaC'](it,_0x7ca2b7['FCEZW'],async()=>{var _0xe9e9c8={'qfNBA':_0x7ca2b7['RtnWO']};const _0x5374e1=sandbox['stub']();let _0x2402d0;const {awsNaming}=await runServerless({'fixture':_0x7ca2b7['EYAtB'],'command':_0x7ca2b7['TVvpH'],'configExt':{'functions':{'fn1':{'events':[{'cloudwatchLog':_0x7ca2b7['leALF']},{'cloudwatchLog':_0x7ca2b7['VvIbx']}]}}},'lastLifecycleHookName':'aws:deploy:deploy:checkForChanges','env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':_0x7ca2b7['ziUxb']},'hooks':{'beforeInstanceInit':_0x42ac4f=>_0x2402d0=_0x42ac4f},'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':{'Configuration':{'LastModified':'2021-05-20T15:34:16.494+0000'}}},'S3':{'listObjectsV2':async()=>generateMatchingListObjectsResponse(_0x2402d0),'headObject':async _0x38cfb8=>generateMatchingHeadObjectResponse(_0x2402d0,_0x38cfb8)},'CloudWatchLogs':{'deleteSubscriptionFilter':_0x5374e1,'describeSubscriptionFilters':sandbox['stub']()['onFirstCall']()['callsFake'](async()=>{const _0x2fbb95=_0x2402d0['getProvider'](_0x2186d4['jTutP'])['naming'];return{'subscriptionFilters':[{'filterName':_0x2fbb95['getStackName']()+'-'+_0x2fbb95['getCloudWatchLogLogicalId']('Fn1',0x1)+'-xxxxx','destinationArn':'arn:aws:lambda:us-east-1:999999999999:function:'+_0x2402d0['service']['getFunction']('fn1')['name']}]};})['onSecondCall']()['callsFake'](async()=>{const _0x39c0a2=_0x2402d0['getProvider']('aws')['naming'];return{'subscriptionFilters':[{'filterName':_0x39c0a2['getStackName']()+'-'+_0x39c0a2['getCloudWatchLogLogicalId']('Fn1',0x1)+'-xxxxx','destinationArn':'arn:aws:lambda:us-east-1:999999999999:function:'+_0x2402d0['service']['getFunction'](_0xe9e9c8['qfNBA'])['name']}]};})}}});_0x7ca2b7['ENDch'](expect,_0x5374e1)['to']['have']['been']['calledOnceWith']({'logGroupName':_0x7ca2b7['VvIbx'],'filterName':awsNaming['getStackName']()+'-'+awsNaming['getCloudWatchLogLogicalId']('Fn1',0x1)+'-xxxxx'});});it(_0x7ca2b7['EeRHW'],async()=>{const _0x4d4833=sandbox['stub']();let _0x3832e0;const {awsNaming}=await _0x2186d4['eTLNt'](runServerless,{'fixture':_0x2186d4['iZPBG'],'command':_0x2186d4['KfrAR'],'configExt':{'functions':{'fn1':{'events':[{'cloudwatchLog':_0x2186d4['wzyUU']},{'cloudwatchLog':_0x2186d4['wzyUU']}]}}},'lastLifecycleHookName':_0x2186d4['coovH'],'env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':_0x2186d4['mAXqV']},'hooks':{'beforeInstanceInit':_0x2a102a=>_0x3832e0=_0x2a102a},'awsRequestStubMap':{...commonAwsSdkMock,'Lambda':{'getFunction':{'Configuration':{'LastModified':_0x2186d4['CVWMt']}}},'S3':{'listObjectsV2':async()=>generateMatchingListObjectsResponse(_0x3832e0),'headObject':async _0x3bb50a=>generateMatchingHeadObjectResponse(_0x3832e0,_0x3bb50a)},'CloudWatchLogs':{'deleteSubscriptionFilter':_0x4d4833,'describeSubscriptionFilters':sandbox['stub']()['onFirstCall']()['callsFake'](async()=>{const _0x468de1=_0x3832e0['getProvider'](_0x2186d4['jTutP'])['naming'];return{'subscriptionFilters':[{'filterName':_0x468de1['getStackName']()+'-'+_0x468de1['getCloudWatchLogLogicalId']('Fn1',0x1)+'-xxxxx','destinationArn':_0x2186d4['eKegR']},{'filterName':_0x468de1['getStackName']()+'-'+_0x468de1['getCloudWatchLogLogicalId'](_0x2186d4['PQxKQ'],0x2)+'-xxxxx','destinationArn':_0x2186d4['eKegR']}]};})}}});expect(_0x4d4833)['to']['have']['been']['calledTwice'];_0x2186d4['kJqva'](expect,_0x4d4833)['to']['have']['been']['calledWith']({'logGroupName':'someLogGroupName','filterName':awsNaming['getStackName']()+'-'+awsNaming['getCloudWatchLogLogicalId'](_0x2186d4['PQxKQ'],0x1)+'-xxxxx'});_0x2186d4['vCnru'](expect,_0x4d4833)['to']['have']['been']['calledWith']({'logGroupName':_0x2186d4['wzyUU'],'filterName':awsNaming['getStackName']()+'-'+awsNaming['getCloudWatchLogLogicalId'](_0x2186d4['PQxKQ'],0x2)+'-xxxxx'});});_0x7ca2b7['vNBaC'](it,_0x7ca2b7['rZfmF'],async()=>{var _0x4971c4={'McZqQ':'my-service.zip','ExMBn':_0x7ca2b7['cwhEq'],'GaCdG':_0x7ca2b7['KuegS'],'QGqse':function(_0xa43a3,_0x4f9f35){return _0x7ca2b7['ZMsuF'](_0xa43a3,_0x4f9f35);},'ATNYr':_0x7ca2b7['tnyRC'],'jnDcm':function(_0x242922,_0x2b4231){return _0x7ca2b7['RwMZd'](_0x242922,_0x2b4231);},'oaZeu':_0x7ca2b7['yNqKb'],'oTEQC':_0x7ca2b7['BZyXw']};const _0x9ab6fe=sandbox['stub']();let _0x7a0449;await _0x7ca2b7['TzuiV'](runServerless,{'fixture':_0x7ca2b7['EYAtB'],'command':_0x7ca2b7['TVvpH'],'configExt':{'functions':{'fn1':{'events':[{'cloudwatchLog':_0x7ca2b7['erodg']}]}}},'lastLifecycleHookName':_0x7ca2b7['IWvDM'],'env':{'AWS_CONTAINER_CREDENTIALS_FULL_URI':'ignore'},'hooks':{'beforeInstanceInit':_0x216bda=>_0x7a0449=_0x216bda},'awsRequestStubMap':{...commonAwsSdkMock,'STS':{'getCallerIdentity':{'ResponseMetadata':{'RequestId':'ffffffff-ffff-ffff-ffff-ffffffffffff'},'UserId':_0x7ca2b7['biMlm'],'Account':'999999999999','Arn':_0x7ca2b7['RjEmX']}},'Lambda':{'getFunction':{'Configuration':{'LastModified':_0x7ca2b7['iMKBE']}}},'S3':{'listObjectsV2':async()=>generateMatchingListObjectsResponse(_0x7a0449),'headObject':async _0x294e0d=>generateMatchingHeadObjectResponse(_0x7a0449,_0x294e0d)},'CloudWatchLogs':{'describeSubscriptionFilters':sandbox['stub']()['callsFake'](async()=>{var _0x35aabe={'qhKVh':'5|4|3|0|6|2|7|1','NHiCo':_0x4971c4['ATNYr'],'QoJiE':'.serverless','mlWvj':function(_0x147342,_0x4ca9da){return _0x147342(_0x4ca9da);}};if(_0x4971c4['jnDcm'](_0x4971c4['oaZeu'],_0x4971c4['oaZeu'])){const _0x3c9606=_0x7a0449['getProvider'](_0x4971c4['oTEQC'])['naming'];return{'subscriptionFilters':[{'filterName':_0x3c9606['getStackName']()+'-'+_0x3c9606['getCloudWatchLogLogicalId']('Fn1',0x1)+'-xxxxx','destinationArn':'arn:aws-us-gov:lambda:us-east-1:999999999999:function:'+_0x7a0449['service']['getFunction']('fn1')['name']}]};}else{globbySyncStub['returns']([_0x4971c4['McZqQ']]);cryptoStub['createHash']()['update']()['digest']['onCall'](0x0)['returns'](_0x4971c4['ExMBn']);cryptoStub['createHash']()['update']()['digest']['onCall'](0x1)['returns'](_0x4971c4['GaCdG']);const _0x4f7409=new Date();const _0x40dbe7=new Date(_0x4971c4['QGqse'](new Date()['getTime'](),0x186a0));const _0x45cdce=new Date(new Date()['getTime']()+0x186a0);const _0x2c69f1=[{'Metadata':{'filesha256':_0x4971c4['ExMBn']},'LastModified':_0x40dbe7},{'Metadata':{'filesha256':_0x4971c4['GaCdG']},'LastModified':_0x45cdce}];return expect(awsDeploy['checkIfDeploymentIsNecessary'](_0x2c69f1,_0x4f7409))['to']['be']['fulfilled']['then'](()=>{var _0xd78244=_0x35aabe['qhKVh']['split']('|'),_0x168604=0x0;while(!![]){switch(_0xd78244[_0x168604++]){case'0':expect(awsDeploy['serverless']['cli']['log'])['to']['not']['have']['been']['called'];continue;case'1':expect(awsDeploy['serverless']['service']['provider']['shouldNotDeploy'])['to']['equal'](undefined);continue;case'2':expect(globbySyncStub)['to']['have']['been']['calledWithExactly']([_0x35aabe['NHiCo']],{'cwd':path['join'](awsDeploy['serverless']['serviceDir'],_0x35aabe['QoJiE']),'dot':!![],'silent':!![]});continue;case'3':_0x35aabe['mlWvj'](expect,readFileStub)['to']['have']['been']['calledOnce'];continue;case'4':expect(globbySyncStub)['to']['have']['been']['calledOnce'];continue;case'5':_0x35aabe['mlWvj'](expect,normalizeCloudFormationTemplateStub)['to']['have']['been']['calledOnce'];continue;case'6':_0x35aabe['mlWvj'](expect,normalizeCloudFormationTemplateStub)['to']['have']['been']['calledWithExactly'](awsDeploy['serverless']['service']['provider']['compiledCloudFormationTemplate']);continue;case'7':_0x35aabe['mlWvj'](expect,readFileStub)['to']['have']['been']['calledWith'](path['resolve'](awsDeploy['serverless']['serviceDir'],'.serverless/my-service.zip'));continue;}break;}});}}),'deleteSubscriptionFilter':_0x9ab6fe}}});_0x7ca2b7['TLlcT'](expect,_0x9ab6fe)['to']['not']['have']['been']['called'];});}});});