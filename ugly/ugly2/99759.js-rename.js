import{Control}from"./Control";import*as DomUtil from"../dom/DomUtil";export var Scale=Control.extend({options:{position:"bottomleft",maxWidth:100,metric:true,imperial:true},onAdd:function(t){var e="leaflet-control-scale",i=DomUtil.create("div",e),o=this.options;this._addScales(o,e+"-line",i);t.on(o.updateWhenIdle?"moveend":"move",this._update,this);t.whenReady(this._update,this);return i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){if(t.metric){this._mScale=DomUtil.create("div",e,i)}if(t.imperial){this._iScale=DomUtil.create("div",e,i)}},_update:function(){var t=this._map,e=t.getSize().y/2;var i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){if(this.options.metric&&t){this._updateMetric(t)}if(this.options.imperial&&t){this._updateImperial(t)}},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e=t*3.2808399,i,o,a;if(e>5280){i=e/5280;o=this._getRoundNum(i);this._updateScale(this._iScale,o+" mi",o/i)}else{a=this._getRoundNum(e);this._updateScale(this._iScale,a+" ft",a/e)}},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px";t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1;return e*i}});export var scale=function(t){return new Scale(t)};