const fs=require("fs");const path=require("path");const assetsDir="static";function getAssetsCopyOption(s,t={}){if(path.isAbsolute(s)){if(fs.existsSync(s)){return Object.assign({from:s,to:path.resolve(process.env.UNI_OUTPUT_DIR)},t)}}const o=s;s=path.resolve(process.env.UNI_INPUT_DIR,s);if(fs.existsSync(s)){return Object.assign({from:s,to:path.resolve(process.env.UNI_OUTPUT_DIR,o)},t)}}function getAssetsCopyOptions(o){const e=[];global.uniPlugin.platforms.forEach(s=>{if(global.uniPlugin.name!==s){e.push(s+"/**/*")}});const n=[];const s=getAssetsCopyOption(o,{ignore:e});if(s){n.push(s)}process.UNI_SUBPACKAGES&&Object.keys(process.UNI_SUBPACKAGES).forEach(s=>{const t=getAssetsCopyOption(path.join(s,o),{ignore:e});if(t){n.push(t)}});return n}function getUniModulesAssetsCopyOptions(t){const o=[];global.uniModules.forEach(s=>{o.push(...getAssetsCopyOptions("uni_modules/"+s+"/"+t))});return o}function getCopyWebpackPluginOptions(o,e){const n=getAssetsCopyOptions(assetsDir).concat(getUniModulesAssetsCopyOptions(assetsDir));global.uniPlugin.copyWebpackOptions.forEach(s=>{const t=s(o,e,n)||[];t.forEach(s=>{if(typeof s==="string"){s=getAssetsCopyOption(s)}s&&n.push(s)})});if(process.env.UNI_PLATFORM==="app-plus"){n.push({from:path.resolve(process.env.UNI_INPUT_DIR,"android*.json"),to:"[name].[ext]"})}return n}module.exports={assetsDir:assetsDir,getCopyWebpackPluginOptions:getCopyWebpackPluginOptions};