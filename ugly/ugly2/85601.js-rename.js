var CONST=require("./const/ORIENTATION_CONST");var Class=require("../utils/Class");var Components=require("../gameobjects/components");var Rectangle=require("../geom/rectangle");var Tile=new Class({Mixins:[Components.Alpha,Components.Flip,Components.Visible],initialize:function i(t,e,s,h,l,n,a,o){this.layer=t;this.index=e;this.x=s;this.y=h;this.width=l;this.height=n;this.right;this.bottom;this.baseWidth=a!==undefined?a:l;this.baseHeight=o!==undefined?o:n;this.pixelX=0;this.pixelY=0;this.updatePixelXY();this.properties={};this.rotation=0;this.collideLeft=false;this.collideRight=false;this.collideUp=false;this.collideDown=false;this.faceLeft=false;this.faceRight=false;this.faceTop=false;this.faceBottom=false;this.collisionCallback=undefined;this.collisionCallbackContext=this;this.tint=16777215;this.physics={}},containsPoint:function(i,t){return!(i<this.pixelX||t<this.pixelY||i>this.right||t>this.bottom)},copy:function(i){this.index=i.index;this.alpha=i.alpha;this.properties=i.properties;this.visible=i.visible;this.setFlip(i.flipX,i.flipY);this.tint=i.tint;this.rotation=i.rotation;this.collideUp=i.collideUp;this.collideDown=i.collideDown;this.collideLeft=i.collideLeft;this.collideRight=i.collideRight;this.collisionCallback=i.collisionCallback;this.collisionCallbackContext=i.collisionCallbackContext;return this},getCollisionGroup:function(){return this.tileset?this.tileset.getTileCollisionGroup(this.index):null},getTileData:function(){return this.tileset?this.tileset.getTileData(this.index):null},getLeft:function(i){var t=this.tilemapLayer;return t?t.tileToWorldX(this.x,i):this.x*this.baseWidth},getRight:function(i){var t=this.tilemapLayer;return t?this.getLeft(i)+this.width*t.scaleX:this.getLeft(i)+this.width},getTop:function(i){var t=this.tilemapLayer;return t?t.tileToWorldY(this.y,i)-(this.height-this.baseHeight)*t.scaleY:this.y*this.baseHeight-(this.height-this.baseHeight)},getBottom:function(i){var t=this.tilemapLayer;return t?this.getTop(i)+this.height*t.scaleY:this.getTop(i)+this.height},getBounds:function(i,t){if(t===undefined){t=new Rectangle}t.x=this.getLeft();t.y=this.getTop();t.width=this.getRight()-t.x;t.height=this.getBottom()-t.y;return t},getCenterX:function(i){return(this.getLeft(i)+this.getRight(i))/2},getCenterY:function(i){return(this.getTop(i)+this.getBottom(i))/2},intersects:function(i,t,e,s){return!(e<=this.pixelX||s<=this.pixelY||i>=this.right||t>=this.bottom)},isInteresting:function(i,t){if(i&&t){return this.canCollide||this.hasInterestingFace}else if(i){return this.collides}else if(t){return this.hasInterestingFace}return false},resetCollision:function(i){if(i===undefined){i=true}this.collideLeft=false;this.collideRight=false;this.collideUp=false;this.collideDown=false;this.faceTop=false;this.faceBottom=false;this.faceLeft=false;this.faceRight=false;if(i){var t=this.tilemapLayer;if(t){this.tilemapLayer.calculateFacesAt(this.x,this.y)}}return this},resetFaces:function(){this.faceTop=false;this.faceBottom=false;this.faceLeft=false;this.faceRight=false;return this},setCollision:function(i,t,e,s,h){if(t===undefined){t=i}if(e===undefined){e=i}if(s===undefined){s=i}if(h===undefined){h=true}this.collideLeft=i;this.collideRight=t;this.collideUp=e;this.collideDown=s;this.faceLeft=i;this.faceRight=t;this.faceTop=e;this.faceBottom=s;if(h){var l=this.tilemapLayer;if(l){this.tilemapLayer.calculateFacesAt(this.x,this.y)}}return this},setCollisionCallback:function(i,t){if(i===null){this.collisionCallback=undefined;this.collisionCallbackContext=undefined}else{this.collisionCallback=i;this.collisionCallbackContext=t}return this},setSize:function(i,t,e,s){if(i!==undefined){this.width=i}if(t!==undefined){this.height=t}if(e!==undefined){this.baseWidth=e}if(s!==undefined){this.baseHeight=s}this.updatePixelXY();return this},updatePixelXY:function(){var i=this.layer.orientation;if(i===CONST.ORTHOGONAL){this.pixelX=this.x*this.baseWidth;this.pixelY=this.y*this.baseHeight}else if(i===CONST.ISOMETRIC){this.pixelX=(this.x-this.y)*this.baseWidth*.5;this.pixelY=(this.x+this.y)*this.baseHeight*.5}else if(i===CONST.STAGGERED){this.pixelX=this.x*this.baseWidth+this.y%2*(this.baseWidth/2);this.pixelY=this.y*(this.baseHeight/2)}else if(i===CONST.HEXAGONAL){var t=this.layer.hexSideLength;var e=(this.baseHeight-t)/2+t;this.pixelX=this.x*this.baseWidth+this.y%2*(this.baseWidth/2);this.pixelY=this.y*e}this.right=this.pixelX+this.baseWidth;this.bottom=this.pixelY+this.baseHeight;return this},destroy:function(){this.collisionCallback=undefined;this.collisionCallbackContext=undefined;this.properties=undefined},canCollide:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.collisionCallback!==undefined}},collides:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown}},hasInterestingFace:{get:function(){return this.faceTop||this.faceBottom||this.faceLeft||this.faceRight}},tileset:{get:function(){var i=this.layer.tilemapLayer;if(i){var t=i.gidMap[this.index];if(t){return t}}return null}},tilemapLayer:{get:function(){return this.layer.tilemapLayer}},tilemap:{get:function(){var i=this.tilemapLayer;return i?i.tilemap:null}}});module.exports=Tile;