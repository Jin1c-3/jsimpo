"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.dynamicRef=void 0;const codegen_1=require("../../compile/codegen");const names_1=require("../../compile/names");const ref_1=require("../core/ref");const def={keyword:"$dynamicRef",schemaType:"string",code:e=>dynamicRef(e,e.schema)};function dynamicRef(n,e){const{gen:o,keyword:r,it:c}=n;if(e[0]!=="#")throw new Error(`"${r}" only supports hash fragment reference`);const t=e.slice(1);if(c.allErrors){s()}else{const i=o.let("valid",false);s(i);n.ok(i)}function s(e){if(c.schemaEnv.root.dynamicAnchors[t]){const r=o.let("_v",codegen_1._`${names_1.default.dynamicAnchors}${codegen_1.getProperty(t)}`);o.if(r,a(r,e),a(c.validateName,e))}else{a(c.validateName,e)()}}function a(e,r){return r?()=>o.block(()=>{ref_1.callRef(n,e);o.let(r,true)}):()=>ref_1.callRef(n,e)}}exports.dynamicRef=dynamicRef;exports.default=def;