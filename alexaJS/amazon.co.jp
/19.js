
!function(){function n(n,t){var r=i(n);return t&&(r=r("instance",t)),r}var r=[],c=0,i=function(t){return function(){var n=c++;return r.push([t,[].slice.call(arguments,0),n,{time:Date.now()}]),i(n)}};n._s=r,this.csa=n}();;
csa('Config', {"KillSwitch.ContentImpressions.ContentViews":true,"UnloadDelay.eventHandler":4});
if (window.csa) {
    csa("Config", {
        'Application': 'Retail:Prod:www.amazon.co.jp',
        'Events.Namespace': 'csa',
        'ObfuscatedMarketplaceId': 'A1VC38T7YXB528',
        'Events.SushiEndpoint': 'https://unagi.amazon.co.jp/1/events/com.amazon.csm.csa.prod',
        'CacheDetection.RequestID': "ZYHX15V20NGQN9PRYPJF",
        'CacheDetection.Callback': window.ue && ue.reset,
        'LCP.elementDedup': 1
    });

    csa("Events")("setEntity", {
        page: {requestId: "ZYHX15V20NGQN9PRYPJF", meaningful: "interactive"},
        session: {id: "000-0000000-0000000"}
    });
}
!function(n){var i,r,o="splice",e=n.csa,u={},f={},c=n.csa._s,a=0,s={},g={},l={},h=setTimeout,d=Object.keys;function t(n,t){return e(n,t)}function v(n,t){var e=f[n]||{};O(e,t),f[n]=e,h(S,0)}function p(n,t,e){var i=!0;e&&e.buffered&&(i=(l[n]||[]).every(function(n){return!1!==t(n)})),i&&(s[n]||(s[n]=[]),s[n].push(t))}function m(n,t){if(n in g)t(g[n]);else{p(n,function(n){return t(n),!1})}}function b(n,t){if(e("Errors")("logError",n),u.DEBUG)throw t||n}function w(){return Math.abs(4294967295*Math.random()|0).toString(36)}function y(n,t){return function(){try{return n.apply(this,arguments)}catch(n){b(n.message||n,n)}}}function S(){for(var n=0;n<c.length;){var t=c[n],e=t[0]in f;if(!e&&!r)return void(a=t.length);e?(c[o](a=n,1),D(t)):n++}}function D(n){var arguments,t=f[n[0]],e=(arguments=n[1])[0];if(!t||!t[e])return b("Undefined function: "+t+"/"+e);i=n[3],f[n[2]]=t[e].apply(t,arguments.slice(1))||{},i=0}function E(){r=1,S()}function O(t,e){d(e).forEach(function(n){t[n]=e[n]})}m("$beforeunload",E),v("Config",{instance:function(n){O(u,n)}}),e.plugin=y(function(n){n(t)}),t.config=u,t.register=v,t.on=p,t.removeListener=function(n,t){var e=s[n];e&&e[o](e.indexOf(t),1)},t.once=m,t.emit=function(n,t,e){for(var i=s[n]||[],r=0;r<i.length;)!1===i[r](t)?i[o](r,1):r++;g[n]=t||{},e&&e.buffered&&(l[n]||(l[n]=[]),100<=l[n].length&&l[n].shift(),l[n].push(t||{}))},t.UUID=function(){return[w(),w(),w(),w()].join("-")},t.time=function(n){var t=i?new Date(i.time):new Date;return"ISO"===n?t.toISOString():t.getTime()},t.error=b,t.exec=y,(t.global=n).csa._s.push=function(n){n[0]in f&&(!c.length||r)?D(n):c[o](a++,0,n)},S(),h(function(){h(E,u.SkipMissingPluginsTimeout||5e3)},1)}("undefined"!=typeof window?window:global);csa.plugin(function(o){var t,n,r={},e="localStorage",c="sessionStorage",a="local",i="session",u=o.exec;function s(e,t){var n;try{r[t]=!!(n=o.global[e]),n=n||{}}catch(e){r[t]=!(n={})}return n}function f(){t=t||s(e,a),n=n||s(c,i)}function l(e){return e&&e[i]?n:t}o.store=u(function(e,t,n){f();var o=l(n);return e?t?void(o[e]=t):o[e]:Object.keys(o)}),o.storageSupport=u(function(){return f(),r}),o.deleteStored=u(function(e,t){f();var n=l(t);if("function"==typeof e)for(var o in n)n.hasOwnProperty(o)&&e(o,n[o])&&delete n[o];else delete n[e]})});csa.plugin(function(s){s.register("Errors",{logError:function(r){s("Metrics",{producerId:"csa",dimensions:{message:r}})("recordMetric","jsError",1)}})});csa.plugin(function(r){var o,e=r.global,i=r("Events"),d=e.location,f=e.document,a=((e.performance||{}).navigation||{}).type,t=e.addEventListener,s=r.emit,u={};function n(a,e){var t=!!o,n=(e=e||{}).keepPageAttributes;t&&(s("$beforePageTransition"),s("$pageTransition")),t&&!n&&i("removeEntity","page"),o=r.UUID(),n?u.id=o:u={schemaId:"<ns>.PageEntity.1",id:o,url:d.href,server:d.hostname,path:d.pathname,referrer:f.referrer,title:f.title},Object.keys(a||{}).forEach(function(e){u[e]=a[e]}),i("setEntity",{page:u}),s("$pageChange",u,{buffered:1}),t&&s("$afterPageTransition")}function g(){s("$load"),s("$ready"),s("$afterload")}function l(){s("$ready"),s("$beforeunload"),s("$unload"),s("$afterunload")}d&&f&&(t&&(t("beforeunload",l),t("pagehide",l),"complete"===f.readyState?g():t("load",g)),r.register("SPA",{newPage:n}),n({transitionType:{0:"hard",1:"refresh",2:"back-button"}[a]||"unknown"}))});csa.plugin(function(c){var t="Events",e="UNKNOWN",a="id",u="all",n="messageId",i="timestamp",f="producerId",o="application",r="obfuscatedMarketplaceId",s="entities",d="schemaId",l="version",p="attributes",v="<ns>",g=c.config,h=(c.global.location||{}).host,m=g[t+".Namespace"]||"csa_other",I=g.Application||"Other"+(h?":"+h:""),b=c("Transport"),y={},O=function(t,e){Object.keys(t).forEach(e)};function E(n,i,o){O(i,function(t){var e=o===u||(o||{})[t];t in n||(n[t]={version:1,id:i[t][a]||c.UUID()}),U(n[t],i[t],e)})}function U(e,n,i){O(n,function(t){!function(t,e,n){return"string"!=typeof e&&t!==l?c.error("Attribute is not of type string: "+t):!0===n||1===n||(t===a||!!~(n||[]).indexOf(t))}(t,n[t],i)||(e[t]=n[t])})}function N(o,t,r){O(t,function(t){var e=o[t];if(e[d]){var n={},i={};n[a]=e[a],n[f]=e[f]||r,n[d]=e[d],n[l]=e[l]++,n[p]=i,S(n),U(i,e,1),k(i),b("log",n)}})}function S(t){t[i]=function(t){return"number"==typeof t&&(t=new Date(t).toISOString()),t||c.time("ISO")}(t[i]),t[n]=t[n]||c.UUID(),t[o]=I,t[r]=g.ObfuscatedMarketplaceId||e,t[d]=t[d].replace(v,m)}function k(t){delete t[l],delete t[d],delete t[f]}function w(o){var r={};this.log=function(t,e){var n={},i=(e||{}).ent;return t?"string"!=typeof t[d]?c.error("A valid schema id is required for the event"):(S(t),E(n,y,i),E(n,r,i),E(n,t[s]||{},i),O(n,function(t){k(n[t])}),t[f]=o[f],t[s]=n,void b("log",t)):c.error("The event cannot be undefined")},this.setEntity=function(t){E(r,t,u),N(r,t,o[f])}}g["KillSwitch."+t]||c.register(t,{setEntity:function(t){E(y,t,u),N(y,t,"csa")},removeEntity:function(t){delete y[t]},instance:function(t){return new w(t)}})});csa.plugin(function(s){var c,g="Transport",l="post",f="preflight",r="csa.cajun.",i="store",a="deleteStored",n="addEventListener",u="sendBeacon",t="__merge",e="messageId",o=".FlushInterval",d=0,h=s.config[g+".BufferSize"]||2e3,p=s.config[g+".RetryDelay"]||1500,v={},m=0,y=[],E=s.global,T=E.document,b=E.Object.keys,k=s.config[g+o]||5e3,I=k,O=s.config[g+o+".BackoffFactor"]||1.5,R=s.config[g+o+".BackoffLimit"]||3e4,S=0;function B(n){if(864e5<s.time()-+new Date(n.timestamp))return s.error("Event is too old: "+n);m<h&&(n[e]in v||(v[n[e]]=n,m++),"function"==typeof n[t]&&n[t](v[n[e]]),!S&&d&&(S=setTimeout(w,function(){var n=I;return I=Math.min(n*O,R),n}())))}function w(){y.forEach(function(e){var o=[];b(v).forEach(function(n){var t=v[n];e.accepts(t)&&o.push(t)}),o.length&&(e.chunks?e.chunks(o).forEach(function(n){D(e,n)}):D(e,o))}),v={},S=0}function D(t,e){function o(){s[a](r+n)}var n=s.UUID();s[i](r+n,JSON.stringify(e)),[function(n,t,e){var o=E.navigator||{},r=E.cordova||{};if(!o[u]||!n[l])return 0;n[f]&&r&&"ios"===r.platformId&&!c&&((new Image).src=n[f]().url,c=1);var i=n[l](t);if(!i.type&&o[u](i.url,i.body))return e(),1},function(n,t,e){if(!n[l])return 0;var o=n[l](t),r=o.url,i=o.body,c=o.type,f=new XMLHttpRequest,a=0;function u(n,t,e){f.open("POST",n),e&&f.setRequestHeader("Content-Type",e),f.send(t)}return f.onload=function(){f.status<299?e():s.config[g+".XHRRetries"]&&a<3&&setTimeout(function(){u(r,i,c)},++a*p)},u(r,i,c),1}].some(function(n){try{return n(t,e,o)}catch(n){}})}b&&(s.once("$afterload",function(){d=1,function(e){(s[i]()||[]).forEach(function(n){if(!n.indexOf(r))try{var t=s[i](n);s[a](n),JSON.parse(t).forEach(e)}catch(n){s.error(n)}})}(B),T&&T[n]&&T[n]("visibilitychange",w,!1),w()}),s.once("$afterunload",function(){d=1,w()}),s.on("$afterPageTransition",function(){m=0,I=k}),s.register(g,{log:B,register:function(n){y.push(n)}}))});csa.plugin(function(n){var r=n.config["Events.SushiEndpoint"];n("Transport")("register",{accepts:function(n){return n.schemaId},post:function(n){var t=n.map(function(n){return{data:n}});return{url:r,body:JSON.stringify({events:t})}},preflight:function(){var n,t=/\/\/(.*?)\//.exec(r);return t&&t[1]&&(n="https://"+t[1]+"/ping"),{url:n}},chunks:function(n){for(var t=[];500<n.length;)t.push(n.splice(0,500));return t.push(n),t}})});csa.plugin(function(n){var t,a,o,r,e=n.config,i="PageViews",d=e[i+".ImpressionMinimumTime"]||1e3,s="addEventListener",c="hidden",g="innerHeight",f="innerWidth",l="renderedTo",m=l+"Viewed",u=l+"Meaningful",v=l+"Impressed",h=1,p=2,P=3,T=4,w=5,y="loaded",I=7,E=8,S=n.global,V=n("Events",{producerId:"csa"}),$=S.document,b={},M={},C=w;if(!e["KillSwitch."+i]){if(!$||!$[s]||void 0===$[c])return K("PageStateChange.2",{state:"ignored"});W(),$[s]("visibilitychange",L,!1),$[s]("readystatechange",j,!1),n.on("$afterPageTransition",W),n.once("$load",j),n.on("$timing:loaded",j)}function H(e){if(!b[I]){var i;if(b[e]=n.time(),e!==P&&e!==y||(t=t||b[e]),t&&C===T)a=a||b[e],(i={})[u]=t-o,i[m]=a-o,K("PageView.4",i),r=r||setTimeout(R,d);if(e!==w&&e!==h&&e!==p||(clearTimeout(r),r=0),e!==h&&e!==p||K("PageRender.3",{transitionType:e===h?"hard":"soft"}),e===I)(i={})[u]=t-o,i[m]=a-o,i[v]=b[e]-o,K("PageImpressed.2",i)}}function K(e,i){M[e]||(i.schemaId="<ns>."+e,V("log",i,{ent:"all"}),M[e]=1)}function L(){0===S[g]&&0===S[f]?(C=E,n("Events")("setEntity",{page:{viewport:"hidden-iframe"}})):C=$[c]?w:T,H(C)}function R(){H(I),r=0}function W(){var e=o?p:h;b={},M={},a=t=0,o=n.time(),H(e),L()}function j(){var e=$.readyState;"interactive"===e&&H(P),"complete"===e&&H(y)}});csa.plugin(function(c){var s=5,e="click",t="addEventListener",r="touches",u="timeStamp",o="length",f="pageX",g="pageY",p="pageXOffset",d="pageYOffset",v=250,m=5,l=200,x=.5,n={capture:!0,passive:!0},X=c.global,Y=c.emit,h=X.Math.abs,a=(X.document||{}).documentElement||{},y={x:0,y:0,t:0,sX:0,sY:0},N={x:0,y:0,t:0,sX:0,sY:0};function b(t){if(t.id)return"//*[@id='"+t.id+"']";var e=function(t){var e,n=1;for(e=t.previousSibling;e;e=e.previousSibling)e.nodeName===t.nodeName&&(n+=1);return n}(t),n=t.nodeName;return 1!==e&&(n+="["+e+"]"),t.parentNode&&(n=b(t.parentNode)+"/"+n),n}function E(t,e,n){var a=c("Content",{target:n}),i={schemaId:"<ns>.ContentInteraction.1",interaction:t,interactionData:e,messageId:c.UUID()};if(n){var r=b(n);r&&(i.attribution=r);var o=function(t){for(var e=t,n=e.tagName,a=!1,i=0;i<s;i++){if(!e||!e.parentElement){a=!0;break}n=(e=e.parentElement).tagName+"/"+n}return a||(n=".../"+n),n}(n);o&&(i.interactionData.parentChain=o)}a("log",i),Y("$content.interaction",i)}function i(t){E(e,{interactionX:""+t.pageX,interactionY:""+t.pageY},t.target)}function I(t){if(t&&t[r]&&1===t[r][o]){var e=t[r][0];N=y={e:t.target,x:e[f],y:e[g],t:t[u],sX:X[p],sY:X[d]}}}function C(t){if(t&&t[r]&&1===t[r][o]&&y&&N){var e=t[r][0],n=t[u],a=n-N.t,i={e:t.target,x:e[f],y:e[g],t:n,sX:X[p],sY:X[d]};N=i,l<=a&&(y=i)}}function D(t){if(t){var e=h(y.x-N.x),n=h(y.y-N.y),a=h(y.sX-N.sX),i=h(y.sY-N.sY),r=t[u]-y.t;if(v<1e3*e/r&&m<e||v<1e3*n/r&&m<n){var o=n<e;o&&a&&e*x<=a||!o&&i&&n*x<=i||E((o?"horizontal":"vertical")+"-swipe",{interactionX:""+y.x,interactionY:""+y.y,endX:""+N.x,endY:""+N.y},y.e)}}}a[t](e,c.exec(i),n),a[t]("touchstart",c.exec(I),n),a[t]("touchmove",c.exec(C),n),a[t]("touchend",c.exec(D),n)});csa.plugin(function(n){var e,t,o,a,c,r="addEventListener",i="mouseup",u="mousemove",f="mousedown",s="click",l="touchstart",d="touchmove",m="touchend",v="csm_ref",g="csm_ct",h="csm_next",p={session:!0},w=0,b=1,y=2,k=1,S=2,D=3,U=4,_=5,A=6,C=n.global,E=C.document,M=n("Metrics",{producerId:"csa"}),N=n.store,x=n.deleteStored,F=C.performance||{},H=F.timing,I=w,L=n.config["UnloadDelay.eventHandler"];N&&F.now&&H&&void 0!==H.navigationStart&&E&&E[r]&&(t=N(v,e,p),o=N(h,e,p),a=parseFloat(N(g,e,p)),c=H.navigationStart-a,a&&t===E.referrer&&M("recordMetric",o===C.location.href?"highConfidenceUnloadDelay":"lowConfidenceUnloadDelay",c),j(),function(){switch(L){case k:E[r](s,O(z));break;case S:case D:E[r](f,O(B)),E[r](u,O(J)),E[r](i,O(G));break;case U:case _:E[r](l,O(B)),E[r](d,O(J)),E[r](m,O(G));break;case A:C[r]("unload",O(K))}}());function T(n,e){N(g,n,p),N(v,e,p)}function j(){x(v,p),x(h,p),x(g,p)}function q(n){return 0===n.button||1===n.which||n.type===l||n.type===m}function z(n,e){var t,o=(C.location||{}).href;q(n)&&((t=function(n){for(var e=5,t=n.target;t&&"A"!==t.tagName&&0<e;)t=t.parentElement,e--;return t}(n))&&"A"===t.tagName&&N(h,t.href,p),T(e,o))}function B(n,e){q(n)&&(I===y||L!==S&&L!==U||z(n,e),I=b)}function G(n,e){q(n)&&(I!==y?(I=w,L!==D&&L!==_||z(n,e)):I=w)}function J(){I===b&&(I=y,j())}function K(n,e){if(n&&e){var t=(C.location||{}).href;n.target&&t&&T(e,t)}}function O(t){return function(n){var e=H.navigationStart+F.now();C.setTimeout(function(){t(n,e)},0)}}});
