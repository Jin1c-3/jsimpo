(function(){var g=function(a){return"string"===typeof a?a.toLowerCase():a},n=function(a){if(!a)return{};a=decodeURI(a);try{return a='{"'+a.replace(/[&]+/g,"\x26").replace(/([\?&][^=]+)([&]|$)/g,"$1\x3d$2").replace(/(^\?|&$)/g,"").replace(/&/g,'","').replace(/=/g,'":"')+'"}',JSON.parse(a)}catch(c){return{}}},m=function(){var a=window.navigator.userAgent,c=google_tag_manager["GTM-P528B3"].macro(343)||document.referrer,e=document.location.href,b=n(document.location.search);-1<c.indexOf("?")&&n(c.substr(c.indexOf("?")));var d=
c,f="src smid nl nrx partner campaignid mcid meid".split(" "),h=/^[^:]*:\/\/([^\/]*)/,m=f.length,k;for(k=0;k<m;k++)if(b[f[k]]){var l=f[k];break}e=l?b[l]:""!==d&&d.match(h)?d.match(h)[1]||"":""===d&&/\.app/.test(e)?"NYT Mobile Apps":/FBIOS/.test(a)?"FBIOS":/FBAN/.test(a)?"FBAN":"";l=r(e,b);d=e;a=b;f=c;h="NYT Mobile Apps"===d||"cur"===a.smtyp||!!a.nl||"sms"===a.src||a.smprod&&a.smprod.indexOf&&(-1<a.smprod.indexOf("nytnow")||-1<a.smprod.indexOf("tools"))||a.partner&&a.partner.indexOf&&(-1<a.partner.indexOf("rss")||
-1<a.partner.indexOf("socialFlow"))||!!a.nrx||d&&d.indexOf&&-1<d.indexOf("nytimes.com")||g(d)===g("SafariPush");a.mcid||a.meid||"pay"===a.smtyp||/aud_dev/.test(a["WT.mc_id"])||/paid.outbrain.com/.test(f)?d="paid":h?d="owned":(p.test(d)&&d.indexOf("nytimes.com"),d="earned");a=e;f=/naver|aol|lycos|search.netscape|cnn|mamma|terra|search.virgilio|alice|eniro|yahoo|aol|about|voila|baidu|yandex|wp|online.onetcenter|yam|rambler|daum|msn|bing|ask|altavista|alltheweb|bing|najdi|aol|seznam|search|duckduckgo|mynet|ekolay|pchome|kvasir|sesam|ozu|szukacz|google/;
h=/\.(facebook|twitter|reddit|pinterest|getpocket|stumbleupon|myspace|fark|digg|linkedin|plus.url.google|disqus|quora|yelp|meetup|goodreads|weibo|tumblr|instagram|urbanspoon|weebly|youtube|ycombinator|vk|meneame)\./;c=f.test(a)?"search":q(a)||h.test(a)||"t.co"===a?"social":/nytimes.com|nytnow.com/.test(a)||"NYT Mobile Apps"===a?"internal":!b.moc&&!b.meid||null!==c&&""!==c?(b.mcid||b.mc)&&null!==a?"marketing_campaign":b.nl||b.emc?"newsletter":null===a?null:g(a)===g("SafariPush")||"sms"===a?"notifications":
"referring_links":"marketing_email";b=e;b="string"===typeof b&&"SafariPush"===b?b.toLowerCase():b;return{source:b,subchannel:l,type:d,channel:c}},p=/.*\..*/,q=function(a){if(a){var c=/^(fb\-|tw\-|pin\-|pi\-|pinterest\-|re\-|go\-|li\-|in\-|kk\-|ln\-|wc\-)/;a=a&&a.match&&a.match(c);if(Array.isArray(a))return a[1]}},r=function(a,c){if(c.meid)return"marketing email";if(c.nl||c.emc)return"Newsletter";if("FBAN"===a||"FBIOS"===a)return"facebook";if("NYT Mobile Apps"==a)return a;if("sms"===a)return"sms notifications";
if(g(a)===g("SafariPush"))return"safari notifications";if(p.test(a)){var e="stumbleupon typepad blogspot digg disqus facebook fark getpocket google linkedin Social pinterest quora reddit scoop slashdot twitter techmeme tinyurl vk".split(" ");var b={stumbleupon:/corp.stumbleupon.com|stumbleupon.com/,typepad:/delong.typepad.com|economistsview.typepad.com/,blogspot:/digbysblog.blogspot.com/,digg:/digg.com/,disqus:/disqus.com/,facebook:/facebook.com|fb-nytdining|fb-nytimes|fb-nytmetro&smtyp=cur|fb-nytopinion|fb-nytpolitics|fb-nytvideo|fb-share|fb-share?utm_hp_ref=parents|l.facebook.com|lm.facebook.com|m.facebook.com|www.facebook.com/,
fark:/fark.com/,getpocket:/getpocket.com/,google:/go-share|gp-nytimes|plus.url.google.com/,linkedin:/li-nytimes|li-share|linkedin.com|lnkd.in/,Social:/netvibes.com|news.ycombinator.com|nythealth|nytimesarts|nytimesphoto|nytpolitics|nytscience|paper.li|pl-share/,pinterest:/pi-nytimes|pin-share|pinterest.com/,quora:/quora.com/,reddit:/re-share|re-share/,scoop:/scoop.it/,slashdot:/slashdot.org/,twitter:/t.co$|tw-bna|tw-dealbook|tw-nytdavidbrooks|tw-nytfashion|tw-nytfood|tw-nythealth|tw-nytimes|tw-nytimesbits|tw-nytimesbusiness|tw-nytimeskrugman|tw-nytimesmap|tw-nytimesmusic|tw-nytimesscience|tw-nytimestech|tw-nytimestheater|tw-nytimestravel|tw-nytimeswell|tw-nytimesworld|tw-nytmag|tw-nytmedia|tw-nytmetro|tw-nytmovies|tw-nytnational|tw-nytopinion|tw-nytstyles|tw-nytvideo|tw-share|tw-tmagazine|tw-upshotnyt/,
techmeme:/techmeme.com/,tinyurl:/tinyurl.com/,vk:/vk.com/};ln=e.length;for(i=i=0;i<ln;i++)if(b[e[i]].test(a))return rollup=e[i];return a}e={"fb-":"facebook","tw-":"twitter","pin-":"pinterest","pi-":"pinterest","pinterest-":"pinterest","re-":"reddit","go-":"googleplus","li-":"linkedin","in-":"instagram","kk-":"kakao","ln-":"line","wc-":"wechat"};return e[q(a)]};window.nytAnalytics=window.nytAnalytics||{};nytAnalytics.derivedReferrer=m()})();