'use strict';
var _0x1369 = [
    'Unknown\x20point\x20format',
    'encodeCompressed',
    'encode',
    '_encode',
    'byteLength',
    'getY',
    'isEven',
    'precompute',
    '_getNAFPoints',
    'doubles',
    'beta',
    '_hasDoubles',
    'ceil',
    'bitLength',
    'dbl',
    'push',
    'naf',
    '_getBeta',
    '13UoIjuC',
    '32027XEsNhA',
    '33537HSWxMp',
    '3MyIaOp',
    '5oIBaQT',
    '16726VDyAUh',
    '61wdYUYE',
    '8566JKVfAa',
    '667275GpSxID',
    '489391GIbxGh',
    '668147eBAWml',
    '../../elliptic',
    'utils',
    'getNAF',
    'assert',
    'type',
    'prime',
    'red',
    'mont',
    'zero',
    'toRed',
    'one',
    'two',
    'pointFromJSON',
    'gRed',
    '_wnafT1',
    '_wnafT2',
    '_wnafT3',
    'div',
    'cmpn',
    'redN',
    '_maxwellTrick',
    'exports',
    'point',
    'Not\x20implemented',
    'prototype',
    'validate',
    '_fixedNafMul',
    'precomputed',
    '_getDoubles',
    'length',
    'step',
    'jpoint',
    'points',
    'neg',
    'add',
    'toP',
    '_wnafMul',
    'dblp',
    'mixedAdd',
    'affine',
    '_wnafMulAdd',
    'wnd',
    'max',
    'cmp',
    'toJ',
    'redNeg',
    'curve',
    'BasePoint',
    'toArray',
    'slice',
    'pointFromX'
];
var _0x11b58b = _0x2db7;
(function (_0x973a83, _0x218d52) {
    var _0x3c4ba2 = _0x2db7;
    while (!![]) {
        try {
            var _0x2e6647 = parseInt(_0x3c4ba2(0x107)) * -parseInt(_0x3c4ba2(0x108)) + parseInt(_0x3c4ba2(0x109)) * parseInt(_0x3c4ba2(0x10a)) + -parseInt(_0x3c4ba2(0x10b)) * parseInt(_0x3c4ba2(0x10c)) + -parseInt(_0x3c4ba2(0x10d)) * parseInt(_0x3c4ba2(0x10e)) + parseInt(_0x3c4ba2(0x10f)) + parseInt(_0x3c4ba2(0x110)) + parseInt(_0x3c4ba2(0x111));
            if (_0x2e6647 === _0x218d52)
                break;
            else
                _0x973a83['push'](_0x973a83['shift']());
        } catch (_0xa45f7f) {
            _0x973a83['push'](_0x973a83['shift']());
        }
    }
}(_0x1369, 0xdc705));
var BN = require('bn.js'), elliptic = require(_0x11b58b(0x112)), utils = elliptic[_0x11b58b(0x113)], getNAF = utils[_0x11b58b(0x114)], getJSF = utils['getJSF'], assert = utils[_0x11b58b(0x115)];
function _0x2db7(_0x4def3e, _0x1b7049) {
    return _0x2db7 = function (_0x1369ee, _0x2db7de) {
        _0x1369ee = _0x1369ee - 0x107;
        var _0x574dba = _0x1369[_0x1369ee];
        return _0x574dba;
    }, _0x2db7(_0x4def3e, _0x1b7049);
}
function BaseCurve(_0x3a723e, _0xbe56fd) {
    var _0x1265cd = _0x11b58b;
    this[_0x1265cd(0x116)] = _0x3a723e, this['p'] = new BN(_0xbe56fd['p'], 0x10), this['red'] = _0xbe56fd[_0x1265cd(0x117)] ? BN[_0x1265cd(0x118)](_0xbe56fd['prime']) : BN[_0x1265cd(0x119)](this['p']), this[_0x1265cd(0x11a)] = new BN(0x0)[_0x1265cd(0x11b)](this['red']), this[_0x1265cd(0x11c)] = new BN(0x1)[_0x1265cd(0x11b)](this[_0x1265cd(0x118)]), this[_0x1265cd(0x11d)] = new BN(0x2)[_0x1265cd(0x11b)](this[_0x1265cd(0x118)]), this['n'] = _0xbe56fd['n'] && new BN(_0xbe56fd['n'], 0x10), this['g'] = _0xbe56fd['g'] && this[_0x1265cd(0x11e)](_0xbe56fd['g'], _0xbe56fd[_0x1265cd(0x11f)]), this[_0x1265cd(0x120)] = new Array(0x4), this[_0x1265cd(0x121)] = new Array(0x4), this[_0x1265cd(0x122)] = new Array(0x4), this['_wnafT4'] = new Array(0x4);
    var _0x45bb6d = this['n'] && this['p'][_0x1265cd(0x123)](this['n']);
    !_0x45bb6d || _0x45bb6d[_0x1265cd(0x124)](0x64) > 0x0 ? this[_0x1265cd(0x125)] = null : (this[_0x1265cd(0x126)] = !![], this[_0x1265cd(0x125)] = this['n'][_0x1265cd(0x11b)](this['red']));
}
module[_0x11b58b(0x127)] = BaseCurve, BaseCurve['prototype'][_0x11b58b(0x128)] = function point() {
    var _0x8a257d = _0x11b58b;
    throw new Error(_0x8a257d(0x129));
}, BaseCurve[_0x11b58b(0x12a)][_0x11b58b(0x12b)] = function validate() {
    var _0x154e7f = _0x11b58b;
    throw new Error(_0x154e7f(0x129));
}, BaseCurve[_0x11b58b(0x12a)][_0x11b58b(0x12c)] = function _fixedNafMul(_0x49cd42, _0x1cd4dd) {
    var _0x465556 = _0x11b58b;
    assert(_0x49cd42[_0x465556(0x12d)]);
    var _0x53d879 = _0x49cd42[_0x465556(0x12e)](), _0x5055db = getNAF(_0x1cd4dd, 0x1), _0x302c23 = (0x1 << _0x53d879['step'] + 0x1) - (_0x53d879['step'] % 0x2 === 0x0 ? 0x2 : 0x1);
    _0x302c23 /= 0x3;
    var _0x33be7a = [];
    for (var _0x2314a6 = 0x0; _0x2314a6 < _0x5055db[_0x465556(0x12f)]; _0x2314a6 += _0x53d879[_0x465556(0x130)]) {
        var _0x199773 = 0x0;
        for (var _0x1cd4dd = _0x2314a6 + _0x53d879['step'] - 0x1; _0x1cd4dd >= _0x2314a6; _0x1cd4dd--)
            _0x199773 = (_0x199773 << 0x1) + _0x5055db[_0x1cd4dd];
        _0x33be7a['push'](_0x199773);
    }
    var _0x2fc865 = this['jpoint'](null, null, null), _0x5f29e9 = this[_0x465556(0x131)](null, null, null);
    for (var _0x2490e8 = _0x302c23; _0x2490e8 > 0x0; _0x2490e8--) {
        for (var _0x2314a6 = 0x0; _0x2314a6 < _0x33be7a[_0x465556(0x12f)]; _0x2314a6++) {
            var _0x199773 = _0x33be7a[_0x2314a6];
            if (_0x199773 === _0x2490e8)
                _0x5f29e9 = _0x5f29e9['mixedAdd'](_0x53d879[_0x465556(0x132)][_0x2314a6]);
            else {
                if (_0x199773 === -_0x2490e8)
                    _0x5f29e9 = _0x5f29e9['mixedAdd'](_0x53d879['points'][_0x2314a6][_0x465556(0x133)]());
            }
        }
        _0x2fc865 = _0x2fc865[_0x465556(0x134)](_0x5f29e9);
    }
    return _0x2fc865[_0x465556(0x135)]();
}, BaseCurve[_0x11b58b(0x12a)][_0x11b58b(0x136)] = function _wnafMul(_0xc56f23, _0x3cf776) {
    var _0x40c40d = _0x11b58b, _0x1124fb = 0x4, _0x187446 = _0xc56f23['_getNAFPoints'](_0x1124fb);
    _0x1124fb = _0x187446['wnd'];
    var _0x15906c = _0x187446[_0x40c40d(0x132)], _0x2bba19 = getNAF(_0x3cf776, _0x1124fb), _0x26e1e5 = this[_0x40c40d(0x131)](null, null, null);
    for (var _0x2fff83 = _0x2bba19['length'] - 0x1; _0x2fff83 >= 0x0; _0x2fff83--) {
        for (var _0x3cf776 = 0x0; _0x2fff83 >= 0x0 && _0x2bba19[_0x2fff83] === 0x0; _0x2fff83--)
            _0x3cf776++;
        if (_0x2fff83 >= 0x0)
            _0x3cf776++;
        _0x26e1e5 = _0x26e1e5[_0x40c40d(0x137)](_0x3cf776);
        if (_0x2fff83 < 0x0)
            break;
        var _0xc980ee = _0x2bba19[_0x2fff83];
        assert(_0xc980ee !== 0x0);
        if (_0xc56f23[_0x40c40d(0x116)] === 'affine') {
            if (_0xc980ee > 0x0)
                _0x26e1e5 = _0x26e1e5[_0x40c40d(0x138)](_0x15906c[_0xc980ee - 0x1 >> 0x1]);
            else
                _0x26e1e5 = _0x26e1e5[_0x40c40d(0x138)](_0x15906c[-_0xc980ee - 0x1 >> 0x1][_0x40c40d(0x133)]());
        } else {
            if (_0xc980ee > 0x0)
                _0x26e1e5 = _0x26e1e5[_0x40c40d(0x134)](_0x15906c[_0xc980ee - 0x1 >> 0x1]);
            else
                _0x26e1e5 = _0x26e1e5['add'](_0x15906c[-_0xc980ee - 0x1 >> 0x1][_0x40c40d(0x133)]());
        }
    }
    return _0xc56f23[_0x40c40d(0x116)] === _0x40c40d(0x139) ? _0x26e1e5[_0x40c40d(0x135)]() : _0x26e1e5;
}, BaseCurve[_0x11b58b(0x12a)][_0x11b58b(0x13a)] = function _wnafMulAdd(_0x73a036, _0x24a820, _0x20bb63, _0x25d3f1, _0x50cab2) {
    var _0x16b41a = _0x11b58b, _0x977866 = this[_0x16b41a(0x120)], _0xc4c14b = this[_0x16b41a(0x121)], _0x5f1a55 = this[_0x16b41a(0x122)], _0x9108c3 = 0x0;
    for (var _0x523040 = 0x0; _0x523040 < _0x25d3f1; _0x523040++) {
        var _0x371221 = _0x24a820[_0x523040], _0x103474 = _0x371221['_getNAFPoints'](_0x73a036);
        _0x977866[_0x523040] = _0x103474[_0x16b41a(0x13b)], _0xc4c14b[_0x523040] = _0x103474['points'];
    }
    for (var _0x523040 = _0x25d3f1 - 0x1; _0x523040 >= 0x1; _0x523040 -= 0x2) {
        var _0x21d2de = _0x523040 - 0x1, _0x271d85 = _0x523040;
        if (_0x977866[_0x21d2de] !== 0x1 || _0x977866[_0x271d85] !== 0x1) {
            _0x5f1a55[_0x21d2de] = getNAF(_0x20bb63[_0x21d2de], _0x977866[_0x21d2de]), _0x5f1a55[_0x271d85] = getNAF(_0x20bb63[_0x271d85], _0x977866[_0x271d85]), _0x9108c3 = Math[_0x16b41a(0x13c)](_0x5f1a55[_0x21d2de]['length'], _0x9108c3), _0x9108c3 = Math[_0x16b41a(0x13c)](_0x5f1a55[_0x271d85]['length'], _0x9108c3);
            continue;
        }
        var _0x5f3500 = [
            _0x24a820[_0x21d2de],
            null,
            null,
            _0x24a820[_0x271d85]
        ];
        if (_0x24a820[_0x21d2de]['y'][_0x16b41a(0x13d)](_0x24a820[_0x271d85]['y']) === 0x0)
            _0x5f3500[0x1] = _0x24a820[_0x21d2de]['add'](_0x24a820[_0x271d85]), _0x5f3500[0x2] = _0x24a820[_0x21d2de][_0x16b41a(0x13e)]()[_0x16b41a(0x138)](_0x24a820[_0x271d85]['neg']());
        else
            _0x24a820[_0x21d2de]['y']['cmp'](_0x24a820[_0x271d85]['y'][_0x16b41a(0x13f)]()) === 0x0 ? (_0x5f3500[0x1] = _0x24a820[_0x21d2de][_0x16b41a(0x13e)]()[_0x16b41a(0x138)](_0x24a820[_0x271d85]), _0x5f3500[0x2] = _0x24a820[_0x21d2de]['add'](_0x24a820[_0x271d85]['neg']())) : (_0x5f3500[0x1] = _0x24a820[_0x21d2de][_0x16b41a(0x13e)]()['mixedAdd'](_0x24a820[_0x271d85]), _0x5f3500[0x2] = _0x24a820[_0x21d2de][_0x16b41a(0x13e)]()['mixedAdd'](_0x24a820[_0x271d85][_0x16b41a(0x133)]()));
        var _0x723c34 = [
                -0x3,
                -0x1,
                -0x5,
                -0x7,
                0x0,
                0x7,
                0x5,
                0x1,
                0x3
            ], _0x30c829 = getJSF(_0x20bb63[_0x21d2de], _0x20bb63[_0x271d85]);
        _0x9108c3 = Math[_0x16b41a(0x13c)](_0x30c829[0x0][_0x16b41a(0x12f)], _0x9108c3), _0x5f1a55[_0x21d2de] = new Array(_0x9108c3), _0x5f1a55[_0x271d85] = new Array(_0x9108c3);
        for (var _0x1c4b8a = 0x0; _0x1c4b8a < _0x9108c3; _0x1c4b8a++) {
            var _0x3c032b = _0x30c829[0x0][_0x1c4b8a] | 0x0, _0x22d5e3 = _0x30c829[0x1][_0x1c4b8a] | 0x0;
            _0x5f1a55[_0x21d2de][_0x1c4b8a] = _0x723c34[(_0x3c032b + 0x1) * 0x3 + (_0x22d5e3 + 0x1)], _0x5f1a55[_0x271d85][_0x1c4b8a] = 0x0, _0xc4c14b[_0x21d2de] = _0x5f3500;
        }
    }
    var _0x5a6a2b = this['jpoint'](null, null, null), _0x3c3e3b = this['_wnafT4'];
    for (var _0x523040 = _0x9108c3; _0x523040 >= 0x0; _0x523040--) {
        var _0x3fb013 = 0x0;
        while (_0x523040 >= 0x0) {
            var _0x571421 = !![];
            for (var _0x1c4b8a = 0x0; _0x1c4b8a < _0x25d3f1; _0x1c4b8a++) {
                _0x3c3e3b[_0x1c4b8a] = _0x5f1a55[_0x1c4b8a][_0x523040] | 0x0;
                if (_0x3c3e3b[_0x1c4b8a] !== 0x0)
                    _0x571421 = ![];
            }
            if (!_0x571421)
                break;
            _0x3fb013++, _0x523040--;
        }
        if (_0x523040 >= 0x0)
            _0x3fb013++;
        _0x5a6a2b = _0x5a6a2b[_0x16b41a(0x137)](_0x3fb013);
        if (_0x523040 < 0x0)
            break;
        for (var _0x1c4b8a = 0x0; _0x1c4b8a < _0x25d3f1; _0x1c4b8a++) {
            var _0x3864d2 = _0x3c3e3b[_0x1c4b8a], _0x371221;
            if (_0x3864d2 === 0x0)
                continue;
            else {
                if (_0x3864d2 > 0x0)
                    _0x371221 = _0xc4c14b[_0x1c4b8a][_0x3864d2 - 0x1 >> 0x1];
                else {
                    if (_0x3864d2 < 0x0)
                        _0x371221 = _0xc4c14b[_0x1c4b8a][-_0x3864d2 - 0x1 >> 0x1]['neg']();
                }
            }
            if (_0x371221[_0x16b41a(0x116)] === _0x16b41a(0x139))
                _0x5a6a2b = _0x5a6a2b['mixedAdd'](_0x371221);
            else
                _0x5a6a2b = _0x5a6a2b[_0x16b41a(0x134)](_0x371221);
        }
    }
    for (var _0x523040 = 0x0; _0x523040 < _0x25d3f1; _0x523040++)
        _0xc4c14b[_0x523040] = null;
    if (_0x50cab2)
        return _0x5a6a2b;
    else
        return _0x5a6a2b[_0x16b41a(0x135)]();
};
function BasePoint(_0x5c69e, _0x37a19e) {
    var _0x5cc322 = _0x11b58b;
    this[_0x5cc322(0x140)] = _0x5c69e, this[_0x5cc322(0x116)] = _0x37a19e, this[_0x5cc322(0x12d)] = null;
}
BaseCurve[_0x11b58b(0x141)] = BasePoint, BasePoint[_0x11b58b(0x12a)]['eq'] = function eq() {
    var _0x398f3b = _0x11b58b;
    throw new Error(_0x398f3b(0x129));
}, BasePoint[_0x11b58b(0x12a)]['validate'] = function validate() {
    var _0x85e5bd = _0x11b58b;
    return this[_0x85e5bd(0x140)][_0x85e5bd(0x12b)](this);
}, BaseCurve[_0x11b58b(0x12a)]['decodePoint'] = function decodePoint(_0x1723c7, _0x26005e) {
    var _0x4f760d = _0x11b58b;
    _0x1723c7 = utils[_0x4f760d(0x142)](_0x1723c7, _0x26005e);
    var _0x4c599e = this['p']['byteLength']();
    if ((_0x1723c7[0x0] === 0x4 || _0x1723c7[0x0] === 0x6 || _0x1723c7[0x0] === 0x7) && _0x1723c7[_0x4f760d(0x12f)] - 0x1 === 0x2 * _0x4c599e) {
        if (_0x1723c7[0x0] === 0x6)
            assert(_0x1723c7[_0x1723c7['length'] - 0x1] % 0x2 === 0x0);
        else {
            if (_0x1723c7[0x0] === 0x7)
                assert(_0x1723c7[_0x1723c7[_0x4f760d(0x12f)] - 0x1] % 0x2 === 0x1);
        }
        var _0x3eb12e = this[_0x4f760d(0x128)](_0x1723c7[_0x4f760d(0x143)](0x1, 0x1 + _0x4c599e), _0x1723c7[_0x4f760d(0x143)](0x1 + _0x4c599e, 0x1 + 0x2 * _0x4c599e));
        return _0x3eb12e;
    } else {
        if ((_0x1723c7[0x0] === 0x2 || _0x1723c7[0x0] === 0x3) && _0x1723c7['length'] - 0x1 === _0x4c599e)
            return this[_0x4f760d(0x144)](_0x1723c7[_0x4f760d(0x143)](0x1, 0x1 + _0x4c599e), _0x1723c7[0x0] === 0x3);
    }
    throw new Error(_0x4f760d(0x145));
}, BasePoint[_0x11b58b(0x12a)][_0x11b58b(0x146)] = function encodeCompressed(_0x2a4651) {
    var _0x39a901 = _0x11b58b;
    return this[_0x39a901(0x147)](_0x2a4651, !![]);
}, BasePoint[_0x11b58b(0x12a)][_0x11b58b(0x148)] = function _encode(_0x22418b) {
    var _0x30f73c = _0x11b58b, _0x137423 = this[_0x30f73c(0x140)]['p'][_0x30f73c(0x149)](), _0x3bba3c = this['getX']()[_0x30f73c(0x142)]('be', _0x137423);
    if (_0x22418b)
        return [this[_0x30f73c(0x14a)]()[_0x30f73c(0x14b)]() ? 0x2 : 0x3]['concat'](_0x3bba3c);
    return [0x4]['concat'](_0x3bba3c, this[_0x30f73c(0x14a)]()[_0x30f73c(0x142)]('be', _0x137423));
}, BasePoint[_0x11b58b(0x12a)][_0x11b58b(0x147)] = function encode(_0x54695d, _0x2c3aac) {
    var _0x13ba1d = _0x11b58b;
    return utils[_0x13ba1d(0x147)](this[_0x13ba1d(0x148)](_0x2c3aac), _0x54695d);
}, BasePoint[_0x11b58b(0x12a)][_0x11b58b(0x14c)] = function precompute(_0x8eec0b) {
    var _0x2458a0 = _0x11b58b;
    if (this[_0x2458a0(0x12d)])
        return this;
    var _0x125e40 = {
        'doubles': null,
        'naf': null,
        'beta': null
    };
    return _0x125e40['naf'] = this[_0x2458a0(0x14d)](0x8), _0x125e40[_0x2458a0(0x14e)] = this[_0x2458a0(0x12e)](0x4, _0x8eec0b), _0x125e40[_0x2458a0(0x14f)] = this['_getBeta'](), this['precomputed'] = _0x125e40, this;
}, BasePoint[_0x11b58b(0x12a)][_0x11b58b(0x150)] = function _hasDoubles(_0x53a020) {
    var _0x3ebcd4 = _0x11b58b;
    if (!this[_0x3ebcd4(0x12d)])
        return ![];
    var _0xd4b34 = this[_0x3ebcd4(0x12d)]['doubles'];
    if (!_0xd4b34)
        return ![];
    return _0xd4b34[_0x3ebcd4(0x132)][_0x3ebcd4(0x12f)] >= Math[_0x3ebcd4(0x151)]((_0x53a020[_0x3ebcd4(0x152)]() + 0x1) / _0xd4b34[_0x3ebcd4(0x130)]);
}, BasePoint[_0x11b58b(0x12a)][_0x11b58b(0x12e)] = function _getDoubles(_0x2e2f93, _0x639a4b) {
    var _0x154191 = _0x11b58b;
    if (this[_0x154191(0x12d)] && this[_0x154191(0x12d)]['doubles'])
        return this[_0x154191(0x12d)][_0x154191(0x14e)];
    var _0x2580ea = [this], _0x1c71d8 = this;
    for (var _0x3c7b05 = 0x0; _0x3c7b05 < _0x639a4b; _0x3c7b05 += _0x2e2f93) {
        for (var _0x9aa60c = 0x0; _0x9aa60c < _0x2e2f93; _0x9aa60c++)
            _0x1c71d8 = _0x1c71d8[_0x154191(0x153)]();
        _0x2580ea[_0x154191(0x154)](_0x1c71d8);
    }
    return {
        'step': _0x2e2f93,
        'points': _0x2580ea
    };
}, BasePoint[_0x11b58b(0x12a)][_0x11b58b(0x14d)] = function _getNAFPoints(_0x38342f) {
    var _0x3583f0 = _0x11b58b;
    if (this[_0x3583f0(0x12d)] && this['precomputed'][_0x3583f0(0x155)])
        return this[_0x3583f0(0x12d)][_0x3583f0(0x155)];
    var _0x194e37 = [this], _0x40ca57 = (0x1 << _0x38342f) - 0x1, _0x9c14c8 = _0x40ca57 === 0x1 ? null : this[_0x3583f0(0x153)]();
    for (var _0x50e006 = 0x1; _0x50e006 < _0x40ca57; _0x50e006++)
        _0x194e37[_0x50e006] = _0x194e37[_0x50e006 - 0x1]['add'](_0x9c14c8);
    return {
        'wnd': _0x38342f,
        'points': _0x194e37
    };
}, BasePoint[_0x11b58b(0x12a)][_0x11b58b(0x156)] = function _getBeta() {
    return null;
}, BasePoint['prototype']['dblp'] = function dblp(_0x5108e2) {
    var _0xc67b13 = this;
    for (var _0x2db53c = 0x0; _0x2db53c < _0x5108e2; _0x2db53c++)
        _0xc67b13 = _0xc67b13['dbl']();
    return _0xc67b13;
};
