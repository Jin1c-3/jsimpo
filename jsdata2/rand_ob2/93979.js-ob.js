const _0x4a9b = [
    'post',
    'dashboard',
    'POST',
    'can\x20turn\x20off\x20following\x20redirects',
    'http://localhost:8080/login',
    'resolves\x20redirectedToUrl\x20on\x20relative\x20redirects',
    'resolves\x20redirectedToUrl\x20to\x20another\x20domain',
    'https://www.google.com/login',
    'does\x20not\x20included\x20redirectedToUrl\x20when\x20following\x20redirects',
    'gets\x20+\x20attaches\x20the\x20cookies\x20at\x20each\x20redirect',
    'http://localhost:1234/',
    'Content-Type',
    'application/x-www-form-urlencoded',
    'foo=bar&baz=quux',
    '<html></html>',
    'takes\x20converts\x20body\x20to\x20x-www-form-urlencoded\x20and\x20sets\x20header',
    'quux',
    'does\x20not\x20send\x20body',
    'does\x20not\x20set\x20json=true',
    'end',
    'recovers\x20from\x20bad\x20headers',
    'אבגד',
    'should\x20have\x20failed',
    'TypeError\x20[ERR_INVALID_CHAR]:\x20Invalid\x20character\x20in\x20header\x20content\x20[\x22x-text\x22]',
    'handles\x20weird\x20content\x20in\x20the\x20body\x20just\x20fine',
    'http://localhost:9988/foo',
    '#sendStream',
    'stubTrue',
    '1PEFSTG',
    '97723vTmozQ',
    '2425XMRzwV',
    '101ZVHzNs',
    '61fEFThY',
    '4441oTGprZ',
    '396307BxwtVi',
    '382886wvNLVH',
    '32359BZmMbP',
    '1403482YkZqiN',
    '../spec_helper',
    'lodash',
    'http',
    'bluebird',
    'lib/request',
    'snap-shot-it',
    'setCookiesOnBrowser',
    'setRequestCookieHeader',
    'http://localhost:1234',
    'get',
    'one=1',
    '/second',
    'reply',
    'two=2',
    '/third',
    'three=3',
    'map',
    'args',
    'headers',
    'getCalls',
    'stub',
    'set:cookie',
    'resolves',
    'is\x20defined',
    'object',
    'ECONNREFUSED',
    'forEach',
    'getDelayForRetry',
    'deep',
    'does\x20not\x20divide\x20by\x2010\x20when\x20err.code\x20!=\x20ECONNREFUSED',
    'ECONNRESET',
    'have',
    'calledWith',
    'calls\x20onElse\x20when\x20delaysRemaining\x20is\x20exhausted',
    'calledWithExactly',
    'not',
    'called',
    '#setDefaults',
    'delaysRemaining\x20to\x20retryIntervals\x20clone',
    'setDefaults',
    'retryIntervals',
    'delaysRemaining',
    'delaysRemaining\x20can\x20be\x20overridden',
    '#normalizeResponse',
    'push',
    'sets\x20status\x20to\x20statusCode\x20and\x20deletes\x20statusCode',
    'normalizeResponse',
    'body',
    'Not\x20Found',
    'bar',
    'calledOnce',
    'picks\x20out\x20status\x20body\x20and\x20headers',
    '#create',
    'hits',
    'srv',
    'createServer',
    'url',
    '/never-ends',
    'writeHead',
    'write',
    'socket',
    'destroy',
    'listen',
    'retries\x20for\x20streams',
    'does\x20not\x20retry\x20on\x20a\x20timeout',
    'create',
    'fromCallback',
    'then',
    'code',
    'retries\x204x\x20on\x20a\x20connection\x20reset',
    'http://localhost:9988/econnreset',
    'retry',
    'error',
    'rejected',
    'retries\x204x\x20on\x20a\x20NXDOMAIN\x20(ENOTFOUND)',
    'enableNetConnect',
    'http://will-never-exist.invalid.example.com',
    'http://localhost:9988/never-ends',
    'should\x20not\x20reach',
    'catch',
    'ESOCKETTIMEDOUT',
    '#sendPromise',
    'sets\x20strictSSL=false',
    'spy',
    'Request',
    'prototype',
    'init',
    'http://www.github.com',
    '/foo',
    'text/html',
    'http://www.github.com/foo',
    'calledWithMatch',
    'sets\x20simple=false',
    'sets\x20resolveWithFullResponse=true',
    'sendPromise',
    'keys',
    'status',
    'isOkStatusCode',
    'statusText',
    'allRequestResponses',
    'requestBody',
    'requestHeaders',
    'hello',
    'true',
    '*/*',
    'gzip,\x20deflate',
    'keep-alive',
    'www.github.com',
    'foobarbaz',
    '/dashboard',
    '/auth',
    '/login',
    'log\x20in',
    'http://www.github.com/dashboard',
    'duration',
    'redirects',
    'undefined',
    '302:\x20http://www.github.com/login',
    'http://www.github.com/auth',
    'application/json',
    'http://www.github.com/login',
    'http://localhost:1111/foo',
    'should\x20have\x20failed\x20but\x20didnt',
    'message',
    'parses\x20response\x20body\x20as\x20json\x20if\x20content-type\x20application/json\x20response\x20headers',
    'http://localhost:8080',
    '/status.json',
    'stringify',
    'http://localhost:8080/status.json',
    'parses\x20response\x20body\x20as\x20json\x20if\x20content-type\x20application/vnd.api+json\x20response\x20headers',
    'application/vnd.api+json',
    'revives\x20from\x20parsing\x20bad\x20json',
    '{bad:\x20\x27json\x27}',
    'sets\x20duration\x20on\x20response',
    '123',
    'text/plain',
    'http://localhost:8080/foo',
    'sends\x20up\x20user-agent\x20headers',
    'matchHeader',
    'user-agent',
    'derp',
    'connection',
    'it\x20worked',
    'allows\x20overriding\x20user-agent\x20in\x20headers',
    'custom-agent',
    'test',
    'accept\x20header',
    'sets\x20to\x20*/*\x20by\x20default',
    'accept',
    '/headers',
    'http://localhost:8080/headers',
    'can\x20override\x20accept\x20header',
    'can\x20override\x20Accept\x20header',
    '/foo?bar=baz&q=1',
    'by\x20default\x20follow\x20redirects',
    'login',
    'http://localhost:8080/dashboard',
    'property',
    'redirectedToUrl'
];
function _0x487d(_0x1604f3, _0x37c510) {
    return _0x487d = function (_0x4a9b42, _0x487d82) {
        _0x4a9b42 = _0x4a9b42 - 0x14b;
        let _0x489841 = _0x4a9b[_0x4a9b42];
        return _0x489841;
    }, _0x487d(_0x1604f3, _0x37c510);
}
const _0xc12299 = _0x487d;
(function (_0x3943d1, _0x15d0c4) {
    const _0x1897cc = _0x487d;
    while (!![]) {
        try {
            const _0xbddec9 = -parseInt(_0x1897cc(0x14b)) * -parseInt(_0x1897cc(0x14c)) + parseInt(_0x1897cc(0x14d)) * -parseInt(_0x1897cc(0x14e)) + -parseInt(_0x1897cc(0x14f)) * parseInt(_0x1897cc(0x150)) + -parseInt(_0x1897cc(0x151)) + -parseInt(_0x1897cc(0x152)) + parseInt(_0x1897cc(0x153)) + parseInt(_0x1897cc(0x154));
            if (_0xbddec9 === _0x15d0c4)
                break;
            else
                _0x3943d1['push'](_0x3943d1['shift']());
        } catch (_0x2e1472) {
            _0x3943d1['push'](_0x3943d1['shift']());
        }
    }
}(_0x4a9b, 0x3a3d1), require(_0xc12299(0x155)));
const _ = require(_0xc12299(0x156)), http = require(_0xc12299(0x157)), Bluebird = require(_0xc12299(0x158)), Request = require(root + _0xc12299(0x159)), snapshot = require(_0xc12299(0x15a)), request = Request({ 'timeout': 0x64 }), testAttachingCookiesWith = function (_0x36b0c7) {
        const _0x2cd315 = _0xc12299, _0xde8711 = sinon['spy'](request, _0x2cd315(0x15b)), _0x462a3b = sinon['spy'](request, _0x2cd315(0x15c));
        return nock(_0x2cd315(0x15d))[_0x2cd315(0x15e)]('/')['reply'](0x12e, '', {
            'set-cookie': _0x2cd315(0x15f),
            'location': _0x2cd315(0x160)
        })['get'](_0x2cd315(0x160))[_0x2cd315(0x161)](0x12e, '', {
            'set-cookie': _0x2cd315(0x162),
            'location': '/third'
        })['get'](_0x2cd315(0x163))[_0x2cd315(0x161)](0xc8, '', { 'set-cookie': _0x2cd315(0x164) }), _0x36b0c7()['then'](() => {
            const _0x18d0d8 = _0x2cd315;
            return snapshot({
                'setCalls': _0xde8711['getCalls']()[_0x18d0d8(0x165)](_0x285948 => {
                    const _0xac779c = _0x18d0d8;
                    return {
                        'currentUrl': _0x285948['args'][0x1],
                        'setCookie': _0x285948[_0xac779c(0x166)][0x0][_0xac779c(0x167)]['set-cookie']
                    };
                }),
                'getCalls': _0x462a3b[_0x18d0d8(0x168)]()[_0x18d0d8(0x165)](_0x2bc5cd => {
                    return { 'newUrl': _['get'](_0x2bc5cd, 'args.1') };
                })
            });
        });
    };
describe(_0xc12299(0x159), () => {
    const _0x581bde = _0xc12299;
    beforeEach(function () {
        const _0x352b32 = _0x487d;
        this['fn'] = sinon[_0x352b32(0x169)](), this['fn']['withArgs'](_0x352b32(0x16a))[_0x352b32(0x16b)]({}), this['fn']['withArgs']('get:cookies')['resolves']([]);
    }), it(_0x581bde(0x16c), () => {
        const _0x1aec4f = _0x581bde;
        expect(request)['to']['be']['an'](_0x1aec4f(0x16d));
    }), context('#getDelayForRetry', () => {
        const _0x1b363b = _0x581bde;
        it('divides\x20by\x2010\x20when\x20delay\x20>=\x201000\x20and\x20err.code\x20=\x20ECONNREFUSED', () => {
            const _0x26764a = _0x487d, _0xb51468 = [
                    0x1,
                    0x2,
                    0x3,
                    0x4
                ], _0x50e145 = [
                    0x0,
                    0x3e7,
                    0x3e8,
                    0x7d0
                ], _0x3573a2 = { 'code': _0x26764a(0x16e) }, _0x466630 = sinon[_0x26764a(0x169)]();
            _0xb51468[_0x26764a(0x16f)](() => {
                const _0x4ab5ce = _0x26764a;
                return request[_0x4ab5ce(0x170)]({
                    'err': _0x3573a2,
                    'onNext': _0x466630,
                    'retryIntervals': _0xb51468,
                    'delaysRemaining': _0x50e145
                });
            }), expect(_0x50e145)['to']['be']['empty'], expect(_0x466630[_0x26764a(0x166)])['to'][_0x26764a(0x171)]['eq']([
                [
                    0x0,
                    0x1
                ],
                [
                    0x3e7,
                    0x2
                ],
                [
                    0x64,
                    0x3
                ],
                [
                    0xc8,
                    0x4
                ]
            ]);
        }), it(_0x1b363b(0x172), () => {
            const _0x2abac7 = _0x1b363b, _0x2053c3 = [
                    0x1,
                    0x2,
                    0x3,
                    0x4
                ], _0xb65df9 = [
                    0x7d0,
                    0x7d0,
                    0x7d0,
                    0x7d0
                ], _0x58a65e = { 'code': _0x2abac7(0x173) }, _0x353fa8 = sinon[_0x2abac7(0x169)]();
            request[_0x2abac7(0x170)]({
                'err': _0x58a65e,
                'onNext': _0x353fa8,
                'retryIntervals': _0x2053c3,
                'delaysRemaining': _0xb65df9
            }), expect(_0xb65df9)['to'][_0x2abac7(0x174)]['length'](0x3), expect(_0x353fa8)['to']['be'][_0x2abac7(0x175)](0x7d0, 0x1);
        }), it(_0x1b363b(0x176), () => {
            const _0x23c053 = _0x1b363b, _0x4604d1 = [
                    0x1,
                    0x2,
                    0x3,
                    0x4
                ], _0x227612 = [], _0x325596 = sinon[_0x23c053(0x169)](), _0x23c3a8 = sinon[_0x23c053(0x169)]();
            request[_0x23c053(0x170)]({
                'onElse': _0x23c3a8,
                'onNext': _0x325596,
                'retryIntervals': _0x4604d1,
                'delaysRemaining': _0x227612
            }), expect(_0x23c3a8)['to']['be'][_0x23c053(0x177)](), expect(_0x325596)[_0x23c053(0x178)]['to']['be'][_0x23c053(0x179)];
        });
    }), context(_0x581bde(0x17a), () => {
        const _0x132318 = _0x581bde;
        it(_0x132318(0x17b), () => {
            const _0x5bc2fe = _0x132318, _0x179fdd = [
                    0x1,
                    0x2,
                    0x3,
                    0x4
                ], _0x4a8dbe = request[_0x5bc2fe(0x17c)]({ 'retryIntervals': _0x179fdd });
            expect(_0x4a8dbe[_0x5bc2fe(0x17d)])['to']['eq'](_0x179fdd), expect(_0x4a8dbe[_0x5bc2fe(0x17e)])[_0x5bc2fe(0x178)]['to']['eq'](_0x179fdd), expect(_0x4a8dbe[_0x5bc2fe(0x17e)])['to'][_0x5bc2fe(0x171)]['eq'](_0x179fdd);
        }), it('retryIntervals\x20to\x20[0,\x201000,\x202000,\x202000]\x20by\x20default', () => {
            const _0x15c6f7 = request['setDefaults']({});
            expect(_0x15c6f7['retryIntervals'])['to']['deep']['eq']([
                0x0,
                0x3e8,
                0x7d0,
                0x7d0
            ]);
        }), it(_0x132318(0x17f), () => {
            const _0x5cbfe5 = _0x132318, _0x4a0fff = [0x1], _0x29281b = request[_0x5cbfe5(0x17c)]({ 'delaysRemaining': _0x4a0fff });
            expect(_0x29281b[_0x5cbfe5(0x17e)])['to']['eq'](_0x4a0fff);
        });
    }), context(_0x581bde(0x180), () => {
        const _0x31a291 = _0x581bde;
        beforeEach(function () {
            const _0x42af9b = _0x487d;
            this[_0x42af9b(0x181)] = sinon['stub']();
        }), it(_0x31a291(0x182), function () {
            const _0x4808dd = _0x31a291;
            expect(request[_0x4808dd(0x183)](this[_0x4808dd(0x181)], {
                'statusCode': 0x194,
                'request': {
                    'headers': { 'foo': 'bar' },
                    'body': _0x4808dd(0x184)
                }
            }))['to'][_0x4808dd(0x171)]['eq']({
                'status': 0x194,
                'statusText': _0x4808dd(0x185),
                'isOkStatusCode': ![],
                'requestHeaders': { 'foo': _0x4808dd(0x186) },
                'requestBody': _0x4808dd(0x184)
            }), expect(this[_0x4808dd(0x181)])['to']['be'][_0x4808dd(0x187)];
        }), it(_0x31a291(0x188), function () {
            const _0x491520 = _0x31a291;
            expect(request[_0x491520(0x183)](this[_0x491520(0x181)], {
                'foo': _0x491520(0x186),
                'req': {},
                'originalHeaders': {},
                'headers': { 'Content-Length': 0x32 },
                'body': '<html>foo</html>',
                'statusCode': 0xc8,
                'request': {
                    'headers': { 'foo': _0x491520(0x186) },
                    'body': 'body'
                }
            }))['to'][_0x491520(0x171)]['eq']({
                'body': '<html>foo</html>',
                'headers': { 'Content-Length': 0x32 },
                'status': 0xc8,
                'statusText': 'OK',
                'isOkStatusCode': !![],
                'requestHeaders': { 'foo': _0x491520(0x186) },
                'requestBody': _0x491520(0x184)
            }), expect(this['push'])['to']['be']['calledOnce'];
        });
    }), context(_0x581bde(0x189), () => {
        const _0x3b9506 = _0x581bde;
        beforeEach(function (_0x22c814) {
            const _0x5615da = _0x487d;
            this[_0x5615da(0x18a)] = 0x0, this[_0x5615da(0x18b)] = http[_0x5615da(0x18c)]((_0x538515, _0x5cf785) => {
                const _0xeebf42 = _0x5615da;
                this[_0xeebf42(0x18a)]++;
                switch (_0x538515[_0xeebf42(0x18d)]) {
                case _0xeebf42(0x18e):
                    _0x5cf785[_0xeebf42(0x18f)](0xc8);
                    return _0x5cf785[_0xeebf42(0x190)]('foo\x0a');
                case '/econnreset':
                    return _0x538515[_0xeebf42(0x191)][_0xeebf42(0x192)]();
                default:
                    break;
                }
            }), this[_0x5615da(0x18b)][_0x5615da(0x193)](0x2704, _0x22c814);
        }), afterEach(function () {
            const _0xd702c9 = _0x487d;
            return this[_0xd702c9(0x18b)]['close']();
        }), context(_0x3b9506(0x194), () => {
            const _0x1a70d8 = _0x3b9506;
            it(_0x1a70d8(0x195), () => {
                const _0x1f01e2 = _0x1a70d8, _0x6499dd = request[_0x1f01e2(0x17c)]({
                        'url': 'http://localhost:9988/never-ends',
                        'timeout': 0x3e8
                    }), _0x2f87a3 = request[_0x1f01e2(0x196)](_0x6499dd);
                let _0x183bc9 = 0x0;
                _0x2f87a3['on']('retry', () => {
                    _0x183bc9++;
                });
                const _0x334f2c = Bluebird[_0x1f01e2(0x197)](_0x30faf4 => {
                    _0x2f87a3['on']('error', _0x30faf4);
                });
                return expect(_0x334f2c)['to']['be']['rejected'][_0x1f01e2(0x198)](_0x20379d => {
                    const _0x56326d = _0x1f01e2;
                    expect(_0x20379d[_0x56326d(0x199)])['to']['eq']('ESOCKETTIMEDOUT'), expect(_0x183bc9)['to']['eq'](0x0);
                });
            }), it(_0x1a70d8(0x19a), () => {
                const _0x291c25 = _0x1a70d8, _0x31aedb = {
                        'url': _0x291c25(0x19b),
                        'retryIntervals': [
                            0x0,
                            0x1,
                            0x2,
                            0x3
                        ],
                        'timeout': 0x3e8
                    }, _0x2bdd34 = request[_0x291c25(0x196)](_0x31aedb);
                let _0x5c4a46 = 0x0;
                _0x2bdd34['on'](_0x291c25(0x19c), () => {
                    _0x5c4a46++;
                });
                const _0x97efae = Bluebird[_0x291c25(0x197)](_0x2e9256 => {
                    const _0x3955f9 = _0x291c25;
                    _0x2bdd34['on'](_0x3955f9(0x19d), _0x2e9256);
                });
                return expect(_0x97efae)['to']['be'][_0x291c25(0x19e)][_0x291c25(0x198)](_0x3f5657 => {
                    const _0x30aa49 = _0x291c25;
                    expect(_0x3f5657['code'])['to']['eq'](_0x30aa49(0x173)), expect(_0x5c4a46)['to']['eq'](0x4);
                });
            }), it(_0x1a70d8(0x19f), () => {
                const _0x127a64 = _0x1a70d8;
                nock[_0x127a64(0x1a0)]();
                const _0x47fd30 = {
                        'url': _0x127a64(0x1a1),
                        'retryIntervals': [
                            0x0,
                            0x1,
                            0x2,
                            0x3
                        ],
                        'timeout': 0x3e8
                    }, _0x4a0610 = request[_0x127a64(0x196)](_0x47fd30);
                let _0x27e6e9 = 0x0;
                _0x4a0610['on'](_0x127a64(0x19c), () => {
                    _0x27e6e9++;
                });
                const _0x46beb0 = Bluebird[_0x127a64(0x197)](_0x12f079 => {
                    _0x4a0610['on']('error', _0x12f079);
                });
                return expect(_0x46beb0)['to']['be'][_0x127a64(0x19e)][_0x127a64(0x198)](_0x342be0 => {
                    const _0x715e1d = _0x127a64;
                    expect(_0x342be0[_0x715e1d(0x199)])['to']['eq']('ENOTFOUND'), expect(_0x27e6e9)['to']['eq'](0x4);
                });
            });
        }), context('retries\x20for\x20promises', () => {
            it('does\x20not\x20retry\x20on\x20a\x20timeout', function () {
                const _0x49a0b1 = _0x487d, _0x1e918f = {
                        'url': _0x49a0b1(0x1a2),
                        'timeout': 0x64
                    };
                return request['create'](_0x1e918f, !![])[_0x49a0b1(0x198)](() => {
                    const _0x3472a7 = _0x49a0b1;
                    throw new Error(_0x3472a7(0x1a3));
                })[_0x49a0b1(0x1a4)](_0xe20f8a => {
                    const _0x3811c0 = _0x49a0b1;
                    expect(_0xe20f8a[_0x3811c0(0x19d)]['code'])['to']['eq'](_0x3811c0(0x1a5)), expect(this[_0x3811c0(0x18a)])['to']['eq'](0x1);
                });
            }), it('retries\x204x\x20on\x20a\x20connection\x20reset', function () {
                const _0x1799db = _0x487d, _0x2f2a31 = {
                        'url': 'http://localhost:9988/econnreset',
                        'retryIntervals': [
                            0x0,
                            0x1,
                            0x2,
                            0x3
                        ],
                        'timeout': 0xfa
                    };
                return request[_0x1799db(0x196)](_0x2f2a31, !![])[_0x1799db(0x198)](() => {
                    const _0x1f81a8 = _0x1799db;
                    throw new Error(_0x1f81a8(0x1a3));
                })[_0x1799db(0x1a4)](_0x30b124 => {
                    const _0x390b90 = _0x1799db;
                    expect(_0x30b124[_0x390b90(0x19d)][_0x390b90(0x199)])['to']['eq'](_0x390b90(0x173)), expect(this['hits'])['to']['eq'](0x5);
                });
            });
        });
    }), context(_0x581bde(0x1a6), () => {
        const _0x1785d0 = _0x581bde;
        it(_0x1785d0(0x1a7), function () {
            const _0x310951 = _0x1785d0, _0x12eaf1 = sinon[_0x310951(0x1a8)](request['rp'][_0x310951(0x1a9)][_0x310951(0x1aa)], _0x310951(0x1ab));
            return nock(_0x310951(0x1ac))[_0x310951(0x15e)](_0x310951(0x1ad))[_0x310951(0x161)](0xc8, 'hello', { 'Content-Type': _0x310951(0x1ae) }), request['sendPromise']({}, this['fn'], {
                'url': _0x310951(0x1af),
                'cookies': ![]
            })[_0x310951(0x198)](() => {
                const _0x3f06ab = _0x310951;
                expect(_0x12eaf1)['to']['be'][_0x3f06ab(0x1b0)]({ 'strictSSL': ![] });
            });
        }), it(_0x1785d0(0x1b1), function () {
            const _0x326626 = _0x1785d0;
            return nock(_0x326626(0x1ac))[_0x326626(0x15e)]('/foo')[_0x326626(0x161)](0x1f4, ''), request['sendPromise']({}, this['fn'], {
                'url': _0x326626(0x1af),
                'cookies': ![]
            });
        }), it(_0x1785d0(0x1b2), function () {
            const _0x4e4d65 = _0x1785d0;
            return nock(_0x4e4d65(0x1ac))[_0x4e4d65(0x15e)]('/foo')['reply'](0xc8, 'hello', { 'Content-Type': _0x4e4d65(0x1ae) }), request[_0x4e4d65(0x1b3)]({}, this['fn'], {
                'url': _0x4e4d65(0x1af),
                'cookies': ![],
                'body': 'foobarbaz'
            })[_0x4e4d65(0x198)](_0x1b478f => {
                const _0x681f97 = _0x4e4d65;
                expect(_0x1b478f)['to']['have'][_0x681f97(0x1b4)](_0x681f97(0x1b5), _0x681f97(0x184), 'headers', 'duration', _0x681f97(0x1b6), _0x681f97(0x1b7), _0x681f97(0x1b8), _0x681f97(0x1b9), _0x681f97(0x1ba)), expect(_0x1b478f[_0x681f97(0x1b5)])['to']['eq'](0xc8), expect(_0x1b478f[_0x681f97(0x1b7)])['to']['eq']('OK'), expect(_0x1b478f[_0x681f97(0x184)])['to']['eq'](_0x681f97(0x1bb)), expect(_0x1b478f[_0x681f97(0x167)])['to'][_0x681f97(0x171)]['eq']({ 'content-type': _0x681f97(0x1ae) }), expect(_0x1b478f[_0x681f97(0x1b6)])['to']['be'][_0x681f97(0x1bc)], expect(_0x1b478f[_0x681f97(0x1b9)])['to']['eq']('foobarbaz'), expect(_0x1b478f['requestHeaders'])['to'][_0x681f97(0x171)]['eq']({
                    'accept': _0x681f97(0x1bd),
                    'accept-encoding': _0x681f97(0x1be),
                    'connection': _0x681f97(0x1bf),
                    'content-length': 0x9,
                    'host': _0x681f97(0x1c0)
                }), expect(_0x1b478f[_0x681f97(0x1b8)])['to'][_0x681f97(0x171)]['eq']([{
                        'Request\x20Body': _0x681f97(0x1c1),
                        'Request\x20Headers': {
                            'accept': _0x681f97(0x1bd),
                            'accept-encoding': _0x681f97(0x1be),
                            'connection': _0x681f97(0x1bf),
                            'content-length': 0x9,
                            'host': 'www.github.com'
                        },
                        'Request\x20URL': _0x681f97(0x1af),
                        'Response\x20Body': _0x681f97(0x1bb),
                        'Response\x20Headers': { 'content-type': _0x681f97(0x1ae) },
                        'Response\x20Status': 0xc8
                    }]);
            });
        }), it('includes\x20redirects', function () {
            const _0x21909b = _0x1785d0;
            return this['fn'][_0x21909b(0x16b)](), nock('http://www.github.com')['get'](_0x21909b(0x1c2))['reply'](0x12d, null, { 'location': _0x21909b(0x1c3) })[_0x21909b(0x15e)](_0x21909b(0x1c3))[_0x21909b(0x161)](0x12e, null, { 'location': _0x21909b(0x1c4) })[_0x21909b(0x15e)](_0x21909b(0x1c4))[_0x21909b(0x161)](0xc8, _0x21909b(0x1c5), { 'Content-Type': _0x21909b(0x1ae) }), request[_0x21909b(0x1b3)]({}, this['fn'], {
                'url': _0x21909b(0x1c6),
                'cookies': ![]
            })['then'](_0x166ecd => {
                const _0x562e56 = _0x21909b;
                expect(_0x166ecd)['to'][_0x562e56(0x174)][_0x562e56(0x1b4)]('status', _0x562e56(0x184), _0x562e56(0x167), _0x562e56(0x1c7), 'isOkStatusCode', _0x562e56(0x1b7), _0x562e56(0x1b8), _0x562e56(0x1c8), _0x562e56(0x1b9), 'requestHeaders'), expect(_0x166ecd[_0x562e56(0x1b5)])['to']['eq'](0xc8), expect(_0x166ecd['statusText'])['to']['eq']('OK'), expect(_0x166ecd['body'])['to']['eq'](_0x562e56(0x1c5)), expect(_0x166ecd['headers'])['to']['deep']['eq']({ 'content-type': _0x562e56(0x1ae) }), expect(_0x166ecd['isOkStatusCode'])['to']['be']['true'], expect(_0x166ecd[_0x562e56(0x1b9)])['to']['be'][_0x562e56(0x1c9)], expect(_0x166ecd[_0x562e56(0x1c8)])['to'][_0x562e56(0x171)]['eq']([
                    '301:\x20http://www.github.com/auth',
                    _0x562e56(0x1ca)
                ]), expect(_0x166ecd[_0x562e56(0x1ba)])['to']['deep']['eq']({
                    'accept': '*/*',
                    'accept-encoding': _0x562e56(0x1be),
                    'connection': 'keep-alive',
                    'referer': _0x562e56(0x1cb),
                    'host': _0x562e56(0x1c0)
                }), expect(_0x166ecd['allRequestResponses'])['to'][_0x562e56(0x171)]['eq']([
                    {
                        'Request\x20Body': null,
                        'Request\x20Headers': {
                            'accept': _0x562e56(0x1bd),
                            'accept-encoding': _0x562e56(0x1be),
                            'connection': 'keep-alive',
                            'host': _0x562e56(0x1c0)
                        },
                        'Request\x20URL': _0x562e56(0x1c6),
                        'Response\x20Body': null,
                        'Response\x20Headers': {
                            'content-type': _0x562e56(0x1cc),
                            'location': _0x562e56(0x1c3)
                        },
                        'Response\x20Status': 0x12d
                    },
                    {
                        'Request\x20Body': null,
                        'Request\x20Headers': {
                            'accept': _0x562e56(0x1bd),
                            'accept-encoding': 'gzip,\x20deflate',
                            'connection': _0x562e56(0x1bf),
                            'host': _0x562e56(0x1c0),
                            'referer': _0x562e56(0x1c6)
                        },
                        'Request\x20URL': 'http://www.github.com/auth',
                        'Response\x20Body': null,
                        'Response\x20Headers': {
                            'content-type': _0x562e56(0x1cc),
                            'location': _0x562e56(0x1c4)
                        },
                        'Response\x20Status': 0x12e
                    },
                    {
                        'Request\x20Body': null,
                        'Request\x20Headers': {
                            'accept': _0x562e56(0x1bd),
                            'accept-encoding': _0x562e56(0x1be),
                            'connection': 'keep-alive',
                            'host': 'www.github.com',
                            'referer': _0x562e56(0x1cb)
                        },
                        'Request\x20URL': _0x562e56(0x1cd),
                        'Response\x20Body': 'log\x20in',
                        'Response\x20Headers': { 'content-type': _0x562e56(0x1ae) },
                        'Response\x20Status': 0xc8
                    }
                ]);
            });
        }), it('catches\x20errors', function () {
            const _0x4138f7 = _0x1785d0;
            nock[_0x4138f7(0x1a0)]();
            const _0x3009dc = Request({ 'timeout': 0x7d0 });
            return _0x3009dc[_0x4138f7(0x1b3)]({}, this['fn'], {
                'url': _0x4138f7(0x1ce),
                'cookies': ![]
            })[_0x4138f7(0x198)](() => {
                const _0x324d40 = _0x4138f7;
                throw new Error(_0x324d40(0x1cf));
            })['catch'](_0x1044ea => {
                const _0x2485fe = _0x4138f7;
                expect(_0x1044ea[_0x2485fe(0x1d0)])['to']['eq']('Error:\x20connect\x20ECONNREFUSED\x20127.0.0.1:1111');
            });
        }), it(_0x1785d0(0x1d1), function () {
            const _0x10f5a3 = _0x1785d0;
            return nock(_0x10f5a3(0x1d2))[_0x10f5a3(0x15e)](_0x10f5a3(0x1d3))[_0x10f5a3(0x161)](0xc8, JSON[_0x10f5a3(0x1d4)]({ 'status': 'ok' }), { 'Content-Type': _0x10f5a3(0x1cc) }), request[_0x10f5a3(0x1b3)]({}, this['fn'], {
                'url': _0x10f5a3(0x1d5),
                'cookies': ![]
            })[_0x10f5a3(0x198)](_0x587a91 => {
                const _0x2cd885 = _0x10f5a3;
                expect(_0x587a91['body'])['to'][_0x2cd885(0x171)]['eq']({ 'status': 'ok' });
            });
        }), it(_0x1785d0(0x1d6), function () {
            const _0x33c726 = _0x1785d0;
            return nock(_0x33c726(0x1d2))[_0x33c726(0x15e)](_0x33c726(0x1d3))[_0x33c726(0x161)](0xc8, JSON[_0x33c726(0x1d4)]({ 'status': 'ok' }), { 'Content-Type': _0x33c726(0x1d7) }), request[_0x33c726(0x1b3)]({}, this['fn'], {
                'url': 'http://localhost:8080/status.json',
                'cookies': ![]
            })['then'](_0x930f57 => {
                expect(_0x930f57['body'])['to']['deep']['eq']({ 'status': 'ok' });
            });
        }), it(_0x1785d0(0x1d8), function () {
            const _0x51a93c = _0x1785d0;
            return nock(_0x51a93c(0x1d2))[_0x51a93c(0x15e)](_0x51a93c(0x1d3))[_0x51a93c(0x161)](0xc8, _0x51a93c(0x1d9), { 'Content-Type': _0x51a93c(0x1cc) }), request['sendPromise']({}, this['fn'], {
                'url': _0x51a93c(0x1d5),
                'cookies': ![]
            })[_0x51a93c(0x198)](_0x2161d3 => {
                const _0x3545ed = _0x51a93c;
                expect(_0x2161d3[_0x3545ed(0x184)])['to']['eq']('{bad:\x20\x27json\x27}');
            });
        }), it(_0x1785d0(0x1da), function () {
            const _0xe885a0 = _0x1785d0;
            return nock('http://localhost:8080')[_0xe885a0(0x15e)]('/foo')['delay'](0xa)[_0xe885a0(0x161)](0xc8, _0xe885a0(0x1db), { 'Content-Type': _0xe885a0(0x1dc) }), request[_0xe885a0(0x1b3)]({}, this['fn'], {
                'url': _0xe885a0(0x1dd),
                'cookies': ![]
            })[_0xe885a0(0x198)](_0x35692a => {
                const _0x28286e = _0xe885a0;
                expect(_0x35692a[_0x28286e(0x1c7)])['to']['be']['a']('Number'), expect(_0x35692a[_0x28286e(0x1c7)])['to']['be']['gt'](0x0);
            });
        }), it(_0x1785d0(0x1de), function () {
            const _0x531b1b = _0x1785d0;
            nock(_0x531b1b(0x1d2))[_0x531b1b(0x1df)](_0x531b1b(0x1e0), _0x531b1b(0x1c1))[_0x531b1b(0x15e)](_0x531b1b(0x1ad))['reply'](0xc8, _0x531b1b(0x1e1));
            const _0x482ff7 = {};
            return _0x482ff7['user-agent'] = _0x531b1b(0x1c1), request[_0x531b1b(0x1b3)](_0x482ff7, this['fn'], {
                'url': 'http://localhost:8080/foo',
                'cookies': ![]
            })[_0x531b1b(0x198)](_0x5f0e73 => {
                const _0x22cbac = _0x531b1b;
                expect(_0x5f0e73[_0x22cbac(0x184)])['to']['eq'](_0x22cbac(0x1e1));
            });
        }), it('sends\x20connection:\x20keep-alive\x20by\x20default', function () {
            const _0x265af5 = _0x1785d0;
            return nock('http://localhost:8080')[_0x265af5(0x1df)](_0x265af5(0x1e2), _0x265af5(0x1bf))['get']('/foo')[_0x265af5(0x161)](0xc8, _0x265af5(0x1e3)), request[_0x265af5(0x1b3)]({}, this['fn'], {
                'url': _0x265af5(0x1dd),
                'cookies': ![]
            })['then'](_0x61cdc5 => {
                const _0x1c21df = _0x265af5;
                expect(_0x61cdc5[_0x1c21df(0x184)])['to']['eq'](_0x1c21df(0x1e3));
            });
        }), it('lower\x20cases\x20headers', function () {
            const _0x8b3bc3 = _0x1785d0;
            nock(_0x8b3bc3(0x1d2))[_0x8b3bc3(0x1df)]('test', _0x8b3bc3(0x1bc))[_0x8b3bc3(0x15e)]('/foo')[_0x8b3bc3(0x161)](0xc8, _0x8b3bc3(0x1e1));
            const _0x394ee8 = {};
            return _0x394ee8['user-agent'] = _0x8b3bc3(0x1c1), request['sendPromise'](_0x394ee8, this['fn'], {
                'url': _0x8b3bc3(0x1dd),
                'cookies': ![],
                'headers': { 'TEST': !![] }
            })[_0x8b3bc3(0x198)](_0x34e62d => {
                const _0x370c81 = _0x8b3bc3;
                expect(_0x34e62d[_0x370c81(0x184)])['to']['eq'](_0x370c81(0x1e1));
            });
        }), it(_0x1785d0(0x1e4), function () {
            const _0x408514 = _0x1785d0;
            nock(_0x408514(0x1d2))[_0x408514(0x1df)](_0x408514(0x1e0), _0x408514(0x1e5))[_0x408514(0x15e)](_0x408514(0x1ad))[_0x408514(0x161)](0xc8, _0x408514(0x1e1));
            const _0x4e0d8f = { 'user-agent': _0x408514(0x1e6) };
            return request[_0x408514(0x1b3)](_0x4e0d8f, this['fn'], {
                'url': 'http://localhost:8080/foo',
                'cookies': ![],
                'headers': { 'User-Agent': _0x408514(0x1e5) }
            })[_0x408514(0x198)](_0x4c8063 => {
                const _0x4f8b1a = _0x408514;
                expect(_0x4c8063[_0x4f8b1a(0x184)])['to']['eq']('derp');
            });
        }), context(_0x1785d0(0x1e7), () => {
            const _0x1f3413 = _0x1785d0;
            it(_0x1f3413(0x1e8), function () {
                const _0xd56866 = _0x1f3413;
                return nock(_0xd56866(0x1d2))[_0xd56866(0x1df)](_0xd56866(0x1e9), '*/*')['get'](_0xd56866(0x1ea))[_0xd56866(0x161)](0xc8), request['sendPromise']({}, this['fn'], {
                    'url': _0xd56866(0x1eb),
                    'cookies': ![]
                })[_0xd56866(0x198)](_0x19ab13 => {
                    expect(_0x19ab13['status'])['to']['eq'](0xc8);
                });
            }), it(_0x1f3413(0x1ec), function () {
                const _0x1c5672 = _0x1f3413;
                return nock(_0x1c5672(0x1d2))[_0x1c5672(0x1df)]('accept', _0x1c5672(0x1ae))[_0x1c5672(0x15e)]('/headers')[_0x1c5672(0x161)](0xc8), request[_0x1c5672(0x1b3)]({}, this['fn'], {
                    'url': _0x1c5672(0x1eb),
                    'cookies': ![],
                    'headers': { 'accept': _0x1c5672(0x1ae) }
                })['then'](_0xc68dc9 => {
                    const _0x1c9e9b = _0x1c5672;
                    expect(_0xc68dc9[_0x1c9e9b(0x1b5)])['to']['eq'](0xc8);
                });
            }), it(_0x1f3413(0x1ed), function () {
                const _0x2dc37a = _0x1f3413;
                return nock(_0x2dc37a(0x1d2))[_0x2dc37a(0x1df)](_0x2dc37a(0x1e9), _0x2dc37a(0x1dc))[_0x2dc37a(0x15e)]('/headers')[_0x2dc37a(0x161)](0xc8), request[_0x2dc37a(0x1b3)]({}, this['fn'], {
                    'url': _0x2dc37a(0x1eb),
                    'cookies': ![],
                    'headers': { 'Accept': 'text/plain' }
                })[_0x2dc37a(0x198)](_0xde06a0 => {
                    const _0x10de80 = _0x2dc37a;
                    expect(_0xde06a0[_0x10de80(0x1b5)])['to']['eq'](0xc8);
                });
            });
        }), context('qs', () => {
            it('can\x20accept\x20qs', function () {
                const _0x186a5c = _0x487d;
                return nock(_0x186a5c(0x1d2))['get'](_0x186a5c(0x1ee))[_0x186a5c(0x161)](0xc8), request[_0x186a5c(0x1b3)]({}, this['fn'], {
                    'url': _0x186a5c(0x1dd),
                    'cookies': ![],
                    'qs': {
                        'bar': 'baz',
                        'q': 0x1
                    }
                })[_0x186a5c(0x198)](_0x29ac57 => {
                    const _0x134cf8 = _0x186a5c;
                    expect(_0x29ac57[_0x134cf8(0x1b5)])['to']['eq'](0xc8);
                });
            });
        }), context('followRedirect', () => {
            const _0x42f49b = _0x1785d0;
            beforeEach(function () {
                const _0x1072f7 = _0x487d;
                this['fn'][_0x1072f7(0x16b)]();
            }), it(_0x42f49b(0x1ef), function () {
                const _0x1f37a5 = _0x42f49b;
                return nock(_0x1f37a5(0x1d2))[_0x1f37a5(0x15e)](_0x1f37a5(0x1c2))[_0x1f37a5(0x161)](0x12e, '', { 'location': 'http://localhost:8080/login' })['get'](_0x1f37a5(0x1c4))['reply'](0xc8, _0x1f37a5(0x1f0)), request[_0x1f37a5(0x1b3)]({}, this['fn'], {
                    'url': _0x1f37a5(0x1f1),
                    'cookies': ![],
                    'followRedirect': !![]
                })[_0x1f37a5(0x198)](_0x491bb2 => {
                    const _0x1c131e = _0x1f37a5;
                    expect(_0x491bb2[_0x1c131e(0x1b5)])['to']['eq'](0xc8), expect(_0x491bb2[_0x1c131e(0x184)])['to']['eq'](_0x1c131e(0x1f0)), expect(_0x491bb2)[_0x1c131e(0x178)]['to'][_0x1c131e(0x174)][_0x1c131e(0x1f2)](_0x1c131e(0x1f3));
                });
            }), it('follows\x20non-GET\x20redirects\x20by\x20default', function () {
                const _0x5a3cec = _0x42f49b;
                return nock('http://localhost:8080')[_0x5a3cec(0x1f4)]('/login')[_0x5a3cec(0x161)](0x12e, '', { 'location': _0x5a3cec(0x1f1) })[_0x5a3cec(0x15e)]('/dashboard')[_0x5a3cec(0x161)](0xc8, _0x5a3cec(0x1f5)), request[_0x5a3cec(0x1b3)]({}, this['fn'], {
                    'method': _0x5a3cec(0x1f6),
                    'url': 'http://localhost:8080/login',
                    'cookies': ![]
                })[_0x5a3cec(0x198)](_0x588426 => {
                    const _0x240fd1 = _0x5a3cec;
                    expect(_0x588426['status'])['to']['eq'](0xc8), expect(_0x588426[_0x240fd1(0x184)])['to']['eq'](_0x240fd1(0x1f5)), expect(_0x588426)[_0x240fd1(0x178)]['to'][_0x240fd1(0x174)][_0x240fd1(0x1f2)]('redirectedToUrl');
                });
            }), it(_0x42f49b(0x1f7), function () {
                const _0x53daac = _0x42f49b;
                return nock(_0x53daac(0x1d2))[_0x53daac(0x15e)](_0x53daac(0x1c2))[_0x53daac(0x161)](0x12e, '', { 'location': _0x53daac(0x1f8) })[_0x53daac(0x15e)](_0x53daac(0x1c4))[_0x53daac(0x161)](0xc8, _0x53daac(0x1f0)), request[_0x53daac(0x1b3)]({}, this['fn'], {
                    'url': 'http://localhost:8080/dashboard',
                    'cookies': ![],
                    'followRedirect': ![]
                })[_0x53daac(0x198)](_0x4e945c => {
                    const _0x16d400 = _0x53daac;
                    expect(_0x4e945c[_0x16d400(0x1b5)])['to']['eq'](0x12e), expect(_0x4e945c['body'])['to']['eq'](''), expect(_0x4e945c[_0x16d400(0x1f3)])['to']['eq'](_0x16d400(0x1f8));
                });
            }), it(_0x42f49b(0x1f9), function () {
                const _0x4f2b00 = _0x42f49b;
                return nock(_0x4f2b00(0x1d2))[_0x4f2b00(0x15e)](_0x4f2b00(0x1c2))[_0x4f2b00(0x161)](0x12e, '', { 'location': _0x4f2b00(0x1c4) })[_0x4f2b00(0x15e)](_0x4f2b00(0x1c4))[_0x4f2b00(0x161)](0xc8, _0x4f2b00(0x1f0)), request[_0x4f2b00(0x1b3)]({}, this['fn'], {
                    'url': _0x4f2b00(0x1f1),
                    'cookies': ![],
                    'followRedirect': ![]
                })[_0x4f2b00(0x198)](_0x3978a1 => {
                    const _0x3371aa = _0x4f2b00;
                    expect(_0x3978a1['status'])['to']['eq'](0x12e), expect(_0x3978a1[_0x3371aa(0x1f3)])['to']['eq']('http://localhost:8080/login');
                });
            }), it(_0x42f49b(0x1fa), function () {
                const _0x26b473 = _0x42f49b;
                return nock('http://localhost:8080')[_0x26b473(0x15e)](_0x26b473(0x1c2))[_0x26b473(0x161)](0x12d, '', { 'location': _0x26b473(0x1fb) })['get'](_0x26b473(0x1c4))['reply'](0xc8, _0x26b473(0x1f0)), request[_0x26b473(0x1b3)]({}, this['fn'], {
                    'url': _0x26b473(0x1f1),
                    'cookies': ![],
                    'followRedirect': ![]
                })[_0x26b473(0x198)](_0x3f309a => {
                    const _0xeed37 = _0x26b473;
                    expect(_0x3f309a[_0xeed37(0x1b5)])['to']['eq'](0x12d), expect(_0x3f309a[_0xeed37(0x1f3)])['to']['eq']('https://www.google.com/login');
                });
            }), it(_0x42f49b(0x1fc), function () {
                const _0x1a7d7e = _0x42f49b;
                return nock(_0x1a7d7e(0x1d2))[_0x1a7d7e(0x15e)]('/dashboard')['reply'](0x12e, '', { 'location': _0x1a7d7e(0x1f8) })['get'](_0x1a7d7e(0x1c4))[_0x1a7d7e(0x161)](0xc8, _0x1a7d7e(0x1f0)), request[_0x1a7d7e(0x1b3)]({}, this['fn'], {
                    'url': _0x1a7d7e(0x1f1),
                    'cookies': ![]
                })['then'](_0x732964 => {
                    const _0x1157e8 = _0x1a7d7e;
                    expect(_0x732964[_0x1157e8(0x1b5)])['to']['eq'](0xc8), expect(_0x732964)[_0x1157e8(0x178)]['to']['have'][_0x1157e8(0x1f2)](_0x1157e8(0x1f3));
                });
            }), it(_0x42f49b(0x1fd), function () {
                return testAttachingCookiesWith(() => {
                    const _0x2606f2 = _0x487d;
                    return request['sendPromise']({}, this['fn'], { 'url': _0x2606f2(0x1fe) });
                });
            });
        }), context('form=true', () => {
            const _0x2c5fd1 = _0x1785d0;
            beforeEach(() => {
                const _0x15cf2a = _0x487d;
                nock(_0x15cf2a(0x1d2))['matchHeader'](_0x15cf2a(0x1ff), _0x15cf2a(0x200))[_0x15cf2a(0x1f4)](_0x15cf2a(0x1c4), _0x15cf2a(0x201))[_0x15cf2a(0x161)](0xc8, _0x15cf2a(0x202));
            }), it(_0x2c5fd1(0x203), function () {
                const _0x409efa = _0x2c5fd1;
                return request[_0x409efa(0x1b3)]({}, this['fn'], {
                    'url': _0x409efa(0x1f8),
                    'method': 'POST',
                    'cookies': ![],
                    'form': !![],
                    'body': {
                        'foo': _0x409efa(0x186),
                        'baz': _0x409efa(0x204)
                    }
                })[_0x409efa(0x198)](_0x273792 => {
                    const _0x611c8c = _0x409efa;
                    expect(_0x273792[_0x611c8c(0x1b5)])['to']['eq'](0xc8), expect(_0x273792['body'])['to']['eq'](_0x611c8c(0x202));
                });
            }), it(_0x2c5fd1(0x205), function () {
                const _0x3337a3 = _0x2c5fd1, _0x192ac0 = sinon[_0x3337a3(0x1a8)](request['rp'][_0x3337a3(0x1a9)][_0x3337a3(0x1aa)], _0x3337a3(0x1ab)), _0x31c81b = {
                        'foo': _0x3337a3(0x186),
                        'baz': 'quux'
                    };
                return request[_0x3337a3(0x1b3)]({}, this['fn'], {
                    'url': _0x3337a3(0x1f8),
                    'method': _0x3337a3(0x1f6),
                    'cookies': ![],
                    'form': !![],
                    'json': !![],
                    'body': _0x31c81b
                })['then'](_0x467cf5 => {
                    const _0x30e3d8 = _0x3337a3;
                    expect(_0x467cf5[_0x30e3d8(0x1b5)])['to']['eq'](0xc8), expect(_0x467cf5[_0x30e3d8(0x184)])['to']['eq']('<html></html>'), expect(_0x192ac0)['not']['to']['be'][_0x30e3d8(0x1b0)]({ 'body': _0x31c81b });
                });
            }), it(_0x2c5fd1(0x206), function () {
                const _0x4f83f3 = _0x2c5fd1, _0x3c651a = sinon['spy'](request['rp'][_0x4f83f3(0x1a9)]['prototype'], _0x4f83f3(0x1ab));
                return request[_0x4f83f3(0x1b3)]({}, this['fn'], {
                    'url': 'http://localhost:8080/login',
                    'method': _0x4f83f3(0x1f6),
                    'cookies': ![],
                    'form': !![],
                    'json': !![],
                    'body': {
                        'foo': 'bar',
                        'baz': _0x4f83f3(0x204)
                    }
                })[_0x4f83f3(0x198)](_0x56ee94 => {
                    const _0xfdbbb6 = _0x4f83f3;
                    expect(_0x56ee94['status'])['to']['eq'](0xc8), expect(_0x56ee94[_0xfdbbb6(0x184)])['to']['eq']('<html></html>'), expect(_0x3c651a)['not']['to']['be'][_0xfdbbb6(0x1b0)]({ 'json': !![] });
                });
            });
        }), context('bad\x20headers', () => {
            const _0x2f95f5 = _0x1785d0;
            beforeEach(function (_0x39a5f3) {
                const _0xbdfd44 = _0x487d;
                this[_0xbdfd44(0x18b)] = http[_0xbdfd44(0x18c)]((_0x4348ab, _0x8503b7) => {
                    const _0x35120b = _0xbdfd44;
                    _0x8503b7['writeHead'](0xc8), _0x8503b7[_0x35120b(0x207)]();
                }), this[_0xbdfd44(0x18b)]['listen'](0x2704, _0x39a5f3);
            }), afterEach(function () {
                const _0x2b6b4c = _0x487d;
                return this[_0x2b6b4c(0x18b)]['close']();
            }), it(_0x2f95f5(0x208), function () {
                const _0x4dc6ec = _0x2f95f5;
                return request['sendPromise']({}, this['fn'], {
                    'url': 'http://localhost:9988/foo',
                    'cookies': ![],
                    'headers': { 'x-text': _0x4dc6ec(0x209) }
                })['then'](() => {
                    const _0x575054 = _0x4dc6ec;
                    throw new Error(_0x575054(0x20a));
                })['catch'](_0x54fe08 => {
                    const _0x5efbb1 = _0x4dc6ec;
                    expect(_0x54fe08[_0x5efbb1(0x1d0)])['to']['eq'](_0x5efbb1(0x20b));
                });
            }), it(_0x2f95f5(0x20c), function () {
                const _0x240adb = _0x2f95f5;
                return request[_0x240adb(0x1b3)]({}, this['fn'], {
                    'url': _0x240adb(0x20d),
                    'cookies': ![],
                    'json': !![],
                    'body': { 'x-text': 'אבגד' }
                });
            });
        });
    }), context(_0x581bde(0x20e), () => {
        const _0x9006f7 = _0x581bde;
        it(_0x9006f7(0x1e4), function () {
            const _0x2a0397 = _0x9006f7;
            nock('http://localhost:8080')[_0x2a0397(0x1df)](_0x2a0397(0x1e0), _0x2a0397(0x1e5))[_0x2a0397(0x15e)](_0x2a0397(0x1ad))[_0x2a0397(0x161)](0xc8, _0x2a0397(0x1e1)), sinon['spy'](request, 'create'), this['fn'][_0x2a0397(0x16b)]({});
            const _0x3f4c2b = { 'user-agent': _0x2a0397(0x1e6) }, _0x20e51c = {
                    'url': _0x2a0397(0x1dd),
                    'cookies': ![],
                    'headers': { 'user-agent': 'custom-agent' }
                };
            return request['sendStream'](_0x3f4c2b, this['fn'], _0x20e51c)[_0x2a0397(0x198)](_0x454600 => {
                const _0x1a0849 = _0x2a0397;
                _0x454600(), expect(request[_0x1a0849(0x196)])['to']['be'][_0x1a0849(0x187)], expect(request[_0x1a0849(0x196)])['to']['be'][_0x1a0849(0x175)](_0x20e51c);
            });
        }), it('gets\x20+\x20attaches\x20the\x20cookies\x20at\x20each\x20redirect', function () {
            return testAttachingCookiesWith(() => {
                const _0x1774ea = _0x487d;
                return request['sendStream']({}, this['fn'], {
                    'url': _0x1774ea(0x1fe),
                    'followRedirect': _[_0x1774ea(0x20f)]
                })['then'](_0x2b6657 => {
                    const _0x20eacf = _0x2b6657();
                    return new Promise((_0xa07fdc, _0x41b8cf) => {
                        const _0x42df59 = _0x487d;
                        _0x20eacf['on']('response', _0xa07fdc), _0x20eacf['on'](_0x42df59(0x19d), _0x41b8cf);
                    });
                });
            });
        });
    });
});
