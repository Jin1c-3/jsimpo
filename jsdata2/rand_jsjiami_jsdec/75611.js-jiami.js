import{HTTP}from'meteor/http';import{settings}from'../../../settings';import{callbacks}from'../../../callbacks';import{Livechat}from'../lib/Livechat';function sendToRDStation(room){var ocaska={'yhpxn':function(x,y){return x!==y;},'RwnFQ':'Livechat_RDStation_Token','HYWRC':'application/json','VDyfA':'ZGmji','RABJv':'POST','gSovU':'https://www.rdstation.com.br/api/1.3/conversions','EZAFD':'Error sending lead to RD Station ->'};if(!settings['get'](ocaska['RwnFQ'])){return room;}const livechatData=Livechat['getLivechatRoomGuestInfo'](room);if(!livechatData['visitor']['email']){return room;}const email=Array['isArray'](livechatData['visitor']['email'])?livechatData['visitor']['email'][0x0]['address']:livechatData['visitor']['email'];const options={'headers':{'Content-Type':ocaska['HYWRC']},'data':{'token_rdstation':settings['get']('Livechat_RDStation_Token'),'identificador':'rocketchat-livechat','client_id':livechatData['visitor']['_id'],'email':email}};options['data']['nome']=livechatData['visitor']['name']||livechatData['visitor']['username'];if(livechatData['visitor']['phone']){if(ocaska['yhpxn'](ocaska['VDyfA'],'ZGmji')){options['data'][field]=livechatData['customFields'][field];}else{options['data']['telefone']=livechatData['visitor']['phone'];}}if(livechatData['tags']){options['data']['tags']=livechatData['tags'];}Object['keys'](livechatData['customFields']||{})['forEach'](field=>{if(ocaska['yhpxn']('qKwwo','qKwwo')){return room;}else{options['data'][field]=livechatData['customFields'][field];}});Object['keys'](livechatData['visitor']['customFields']||{})['forEach'](field=>{options['data'][field]=livechatData['visitor']['customFields'][field];});try{HTTP['call'](ocaska['RABJv'],ocaska['gSovU'],options);}catch(_0x4fe0b9){console['error'](ocaska['EZAFD'],_0x4fe0b9);}return room;}callbacks['add']('livechat.closeRoom',sendToRDStation,callbacks['priority']['MEDIUM'],'livechat-rd-station-close-room');callbacks['add']('livechat.saveInfo',sendToRDStation,callbacks['priority']['MEDIUM'],'livechat-rd-station-save-info');