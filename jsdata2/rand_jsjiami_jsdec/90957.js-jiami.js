const {load:loadCache}=require('../prepare/cache');const {onRenderBody}=require('../gatsby-ssr');jest['mock']('../prepare/cache',()=>{return{'load':jest['fn']()};});const setCachedAssets=_0x507c1e=>loadCache['mockImplementationOnce'](()=>{return{'timestamp':0x0,'hash':'initial-run','assets':_0x507c1e};});describe('gatsby-ssr',()=>{var _0xe134df={'qTnKv':function(_0x26f5a5,_0x308109){return _0x26f5a5(_0x308109);},'sGICA':function(_0x28f8b5,_0x2c3afa,_0xad6fc9){return _0x28f8b5(_0x2c3afa,_0xad6fc9);},'IraCO':function(_0x3b13a9,_0x46c5d7){return _0x3b13a9===_0x46c5d7;},'saqqs':'vueCG','DAEuu':function(_0x14f10a,_0x1b0049,_0x2bdff5){return _0x14f10a(_0x1b0049,_0x2bdff5);},'HzchP':function(_0x5975c4,_0x3220cc){return _0x5975c4(_0x3220cc);},'bFdVR':function(_0x55a634,_0x4693a6){return _0x55a634(_0x4693a6);},'CFsvp':function(_0x103569,_0x400e49,_0x936e17){return _0x103569(_0x400e49,_0x936e17);},'NTRzx':function(_0x723403,_0x1e306f){return _0x723403(_0x1e306f);},'OZGAP':function(_0x38f80b,_0x20dcb0){return _0x38f80b!==_0x20dcb0;},'mPnlM':'LwEqq','gpzDx':'jyovR','BOOsd':function(_0xc49b4c,_0x2f1b5d){return _0xc49b4c(_0x2f1b5d);},'xSXxk':function(_0x5c3d4e,_0x31e52f){return _0x5c3d4e(_0x31e52f);},'HwUyk':function(_0x5e52f5,_0x8d71e6,_0x13afe6){return _0x5e52f5(_0x8d71e6,_0x13afe6);},'ZVQWZ':function(_0x4a2eb7,_0x31844e,_0x69fd2e){return _0x4a2eb7(_0x31844e,_0x69fd2e);},'IGZkl':function(_0x408b9f,_0x53f944,_0x537d9e){return _0x408b9f(_0x53f944,_0x537d9e);}};const _0x5c4a8d=jest['fn']();_0xe134df['xSXxk'](afterEach,()=>{if(_0xe134df['IraCO']('nTNma',_0xe134df['saqqs'])){_0xe134df['qTnKv'](setCachedAssets,{['/foo']:{['https://foo.bar/path/to/font.otf']:!![]}});_0xe134df['sGICA'](onRenderBody,{'setHeadComponents':_0x5c4a8d,'pathname':'/foo'},{'crossOrigin':'use-credentials'});expect(_0x5c4a8d['mock']['calls'][0x0][0x0])['toMatchSnapshot']();}else{_0x5c4a8d['mockReset']();}});_0xe134df['HwUyk'](it,'does nothing if the pathname has no cached assets',()=>{setCachedAssets({});_0xe134df['DAEuu'](onRenderBody,{'setHeadComponents':_0x5c4a8d,'pathname':'/foo'},{});expect(_0x5c4a8d)['not']['toHaveBeenCalled']();});_0xe134df['ZVQWZ'](it,'generates\x20a\x20<link>\x20tag\x20for\x20each\x20asset',()=>{setCachedAssets({['/foo']:{['/path/to/font.otf']:!![],['https://foo.bar/path/to/another.ttf']:!![],['https://foo.baz/path/to/another/font.woff']:!![]}});_0xe134df['DAEuu'](onRenderBody,{'setHeadComponents':_0x5c4a8d,'pathname':'/foo'},{});_0xe134df['qTnKv'](expect,_0x5c4a8d['mock']['calls'][0x0][0x0])['toMatchSnapshot']();});_0xe134df['ZVQWZ'](describe,'generates\x20<link>\x20tags\x20with\x20`crossorigin`\x20prop\x20for\x20external\x20fonts',()=>{var _0x28c4f0={'hBuJJ':function(_0x96e903,_0x5ebe39){return _0x96e903(_0x5ebe39);},'jXpya':function(_0x3e3ba8,_0x394494,_0x2b9000){return _0x3e3ba8(_0x394494,_0x2b9000);}};_0xe134df['CFsvp'](it,'accepts string `crossOrigin` in plugin config',()=>{_0xe134df['qTnKv'](setCachedAssets,{['/foo']:{['https://foo.bar/path/to/font.otf']:!![]}});onRenderBody({'setHeadComponents':_0x5c4a8d,'pathname':'/foo'},{'crossOrigin':'use-credentials'});_0xe134df['HzchP'](expect,_0x5c4a8d['mock']['calls'][0x0][0x0])['toMatchSnapshot']();});_0xe134df['CFsvp'](it,'accepts\x20function\x20`crossOrigin`\x20in\x20plugin\x20config',()=>{if('sorIF'!=='hVNuB'){const _0x5aeac3={'crossOrigin':_0x12b0b0=>_0x12b0b0==='/foo'?![]:'use-credentials'};_0xe134df['bFdVR'](setCachedAssets,{['/foo']:{['https://foo.bar/path/to/font.otf']:!![]}});_0xe134df['CFsvp'](onRenderBody,{'setHeadComponents':_0x5c4a8d,'pathname':'/foo'},_0x5aeac3);setCachedAssets({['/bar']:{['https://foo.bar/path/to/another.woff']:!![]}});_0xe134df['CFsvp'](onRenderBody,{'setHeadComponents':_0x5c4a8d,'pathname':'/bar'},_0x5aeac3);_0xe134df['bFdVR'](expect,_0x5c4a8d['mock']['calls'][0x0][0x0])['toMatchSnapshot']();_0xe134df['NTRzx'](expect,_0x5c4a8d['mock']['calls'][0x1][0x0])['toMatchSnapshot']();}else{_0x28c4f0['hBuJJ'](setCachedAssets,{});_0x28c4f0['jXpya'](onRenderBody,{'setHeadComponents':_0x5c4a8d,'pathname':'/foo'},{});expect(_0x5c4a8d)['not']['toHaveBeenCalled']();}});});_0xe134df['IGZkl'](it,'generates <link> tags with `crossorigin` `anonymous` prop for self-hosted fonts',()=>{if(_0xe134df['OZGAP'](_0xe134df['mPnlM'],_0xe134df['gpzDx'])){_0xe134df['BOOsd'](setCachedAssets,{['/foo']:{['/font.otf']:!![]}});_0xe134df['BOOsd'](onRenderBody,{'setHeadComponents':_0x5c4a8d,'pathname':'/foo'});_0xe134df['BOOsd'](expect,_0x5c4a8d['mock']['calls'][0x0][0x0])['toMatchSnapshot']();}else{return{'load':jest['fn']()};}});});