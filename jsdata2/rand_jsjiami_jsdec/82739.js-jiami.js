const should=require('should');const sinon=require('sinon');const moment=require('moment');const supertest=require('supertest');const _=require('lodash');const labs=require('../../../../../core/shared/labs');const testUtils=require('../../../../utils');const localUtils=require('./utils');const configUtils=require('../../../../utils/configUtils');const urlUtils=require('../../../../utils/urlUtils');const config=require('../../../../../core/shared/config');const ghost=testUtils['startGhost'];let request;describe('api/v3/content/posts',function(){var _0x42b8d9={'tvkvm':'kLRHx','heoBj':'url','RoozC':'users:no-owner','nQKya':'posts','yhyNF':'tags:extra','jRnwE':'api_keys','hlNCe':'Accept,\x20Accept-Encoding','SjxRE':'access-control-allow-origin','gHpnC':'x-cache-invalidate','rrpFi':'Cache-Control','zcuyv':function(_0x4c7807,_0x103512){return _0x4c7807!==_0x103512;},'qMsom':'qiOuW','jPlfc':'GJHOD','WODrG':function(_0x5574df){return _0x5574df();},'jjjgH':'Origin','wKfbZ':'sUDpJ','EOYhv':function(_0x53573b,_0x2ca289){return _0x53573b(_0x2ca289);},'CHTdY':'Accept-Encoding','EwMYl':'post','kFFTF':'integrations','cXXrt':'next','TZCes':'prev','NBpEZ':'0|3|4|1|2','bsmep':'public','mAlwo':'thou-shalt-not-be-seen','OVqmX':'members','zFAZz':'thou-shalt-be-paid-for','ajdCe':'LtdqT','GbXIt':function(_0x3d4283,_0x45d60f){return _0x3d4283(_0x45d60f);},'jaIlk':'authors','zXuhf':'primary_author','RkgLR':'pagination','rijlj':'Content-Type','wfKBM':'SVQBN','xszeT':'URVEV','qxALD':'html','ZYhCT':'free-to-see','gbybw':function(_0x36d201,_0xf7030d){return _0x36d201===_0xf7030d;},'jnVct':'lfjDT','AuBVI':function(_0x32f4d7,_0x112470){return _0x32f4d7(_0x112470);},'lYxgJ':function(_0x3d8fed){return _0x3d8fed();},'KbqUn':'write','eSTVQ':'ghostly-kitchen-sink','ChIDc':'grow','zugEK':function(_0x3dd3b3,_0x4abf4c){return _0x3dd3b3===_0x4abf4c;},'LOtuF':'bPrVt','obXoH':'<p>Free\x20content</p>','hTsqO':'HVBAE','lRsdt':'4|2|0|1|5|3','pCoek':'sell','QWJvo':'RaVMV','UlqHs':'admin:url','UBhrR':'https://example.com','QGUds':function(_0x3d138e,_0x300cb3){return _0x3d138e===_0x300cb3;},'fZSaG':'yeZIv','dbxyW':'becMv','XnqyL':'ExvGc','gwDBJ':'GMFIo','enJeF':'title','cesRA':'slug','QfYQZ':'plaintext','KmQSr':'HdMLO','gTByE':'vumNl','GWmyX':'FkXoA','gnRMN':'1|2|0|4|3','FBAdX':'paid','pdPQv':'seconds','xBVmr':'{\x22version\x22:\x220.3.1\x22,\x22markups\x22:[],\x22atoms\x22:[],\x22cards\x22:[[\x22paywall\x22,{}]],\x22sections\x22:[[1,\x22p\x22,[[0,[],0,\x22Free\x20content\x22]]],[10,0],[1,\x22p\x22,[[0,[],0,\x22Members\x20content\x22]]]]}','KHtCq':function(_0x16e965,_0x58c8dc){return _0x16e965===_0x58c8dc;},'JkNxv':'EEYSo','Xqlwo':'tags','ZuLJz':'welcome','BgjNm':function(_0x1779b5,_0x5307d2){return _0x1779b5===_0x5307d2;},'AyiZg':function(_0x3fa446,_0x33e1c6){return _0x3fa446===_0x33e1c6;},'Qjmai':'public post fields are always visible','FHAHT':function(_0x482803,_0x2f8cbe,_0x38f389){return _0x482803(_0x2f8cbe,_0x38f389);},'ARLAH':'cannot\x20read\x20members\x20only\x20post\x20content','oJZcl':'cannot\x20read\x20paid\x20only\x20post\x20content','ESMqx':function(_0x2c23a5,_0x31ddaf,_0x2d8a7f){return _0x2c23a5(_0x31ddaf,_0x2d8a7f);},'eZXiN':function(_0x3ed7ed,_0x51f917,_0x26b6e4){return _0x3ed7ed(_0x51f917,_0x26b6e4);},'gxVjJ':'can read "free" html and plaintext content of members post when using paywall card','GrLjf':function(_0xdf47df,_0x353380){return _0xdf47df(_0x353380);},'xuyXl':function(_0x2bd818,_0x2eba5c,_0xa9233d){return _0x2bd818(_0x2eba5c,_0xa9233d);},'xeMCi':'browse\x20posts','CDyTH':'browse\x20posts\x20with\x20related\x20authors/tags\x20also\x20returns\x20primary_author/primary_tag','NCEaJ':'browse posts with published and draft status, should not return drafts','WWLVr':'browse posts with slug filter, should order in slug order','NgNJm':function(_0xffc469,_0x1e44d7,_0x4c6ee3){return _0xffc469(_0x1e44d7,_0x4c6ee3);},'untcb':function(_0x2d6915,_0x3a0a8b,_0x3c2ac8){return _0x2d6915(_0x3a0a8b,_0x3c2ac8);},'aMhnM':'content gating'};_0x42b8d9['GrLjf'](before,function(){var _0x2f6bd4={'FqVXO':_0x42b8d9['hlNCe'],'WarCW':_0x42b8d9['SjxRE'],'BDBET':_0x42b8d9['gHpnC'],'bgUiQ':'Origin','qQHrV':_0x42b8d9['rrpFi']};if(_0x42b8d9['zcuyv'](_0x42b8d9['qMsom'],_0x42b8d9['jPlfc'])){return _0x42b8d9['WODrG'](ghost)['then'](function(){if('pmlFO'===_0x42b8d9['tvkvm']){return done(err);}else{request=supertest['agent'](config['get'](_0x42b8d9['heoBj']));}})['then'](function(){return testUtils['initFixtures'](_0x42b8d9['RoozC'],'user:inactive',_0x42b8d9['nQKya'],_0x42b8d9['yhyNF'],_0x42b8d9['jRnwE']);});}else{var _0x96cc27={'bAKUi':function(_0x396333,_0x1b6a39){return _0x396333(_0x1b6a39);},'VmeRj':_0x2f6bd4['FqVXO'],'cFDWI':_0x2f6bd4['WarCW'],'DWIYO':_0x2f6bd4['BDBET'],'HFoDV':function(_0x445982){return _0x445982();}};configUtils['set']('admin:url','http://localhost:9999');urlUtils['stubUrlUtilsFromConfig']();request['get'](localUtils['API']['getApiQuery']('posts?key='+_0x2c7de1))['set'](_0x2f6bd4['bgUiQ'],'https://example.com')['expect'](_0x2f6bd4['qQHrV'],testUtils['cacheRules']['year'])['expect'](0x12d)['end'](function(_0x430818,_0x10742c){if(_0x430818){return _0x96cc27['bAKUi'](done,_0x430818);}_0x10742c['headers']['vary']['should']['eql'](_0x96cc27['VmeRj']);_0x10742c['headers']['location']['should']['eql']('http://localhost:9999/ghost/api/v3/content/posts/?key='+_0x2c7de1);should['exist'](_0x10742c['headers'][_0x96cc27['cFDWI']]);should['not']['exist'](_0x10742c['headers'][_0x96cc27['DWIYO']]);_0x96cc27['HFoDV'](done);});}});afterEach(function(){configUtils['restore']();urlUtils['restore']();});const _0x2c7de1=localUtils['getValidKey']();_0x42b8d9['xuyXl'](it,_0x42b8d9['xeMCi'],function(_0x26aac0){var _0x34725e={'XhnpR':_0x42b8d9['jjjgH'],'vTIen':'Content-Type','gqWMA':_0x42b8d9['rrpFi'],'KYpAC':_0x42b8d9['wKfbZ'],'PTClw':function(_0x37ec17,_0x2951b3){return _0x42b8d9['EOYhv'](_0x37ec17,_0x2951b3);},'EHCch':_0x42b8d9['CHTdY'],'AFPtE':_0x42b8d9['gHpnC'],'UDzsC':_0x42b8d9['nQKya'],'iZKMR':_0x42b8d9['EwMYl'],'VfUPR':'pagination','bXRVC':'welcome','ENopu':_0x42b8d9['kFFTF'],'yFpYK':_0x42b8d9['cXXrt'],'rGjvS':_0x42b8d9['TZCes'],'ZuDCN':function(_0x398cb7){return _0x398cb7();}};request['get'](localUtils['API']['getApiQuery']('posts/?key='+_0x2c7de1))['set']('Origin',testUtils['API']['getURL']())['expect']('Content-Type',/json/)['expect'](_0x42b8d9['rrpFi'],testUtils['cacheRules']['private'])['expect'](0xc8)['end'](function(_0x59bad2,_0x4cb944){var _0x3fc1c3={'MGGHc':_0x34725e['XhnpR'],'NdSsl':_0x34725e['vTIen'],'enlYB':_0x34725e['gqWMA']};if(_0x34725e['KYpAC']!==_0x34725e['KYpAC']){var _0xf37d45={'mfSUF':'html','AYEBT':'plaintext'};return request['get'](localUtils['API']['getApiQuery']('posts/'+membersPost['id']+'/?key='+_0x2c7de1+'&formats=html,plaintext&fields=html,plaintext'))['set'](_0x3fc1c3['MGGHc'],testUtils['API']['getURL']())['expect'](_0x3fc1c3['NdSsl'],/json/)['expect'](_0x3fc1c3['enlYB'],testUtils['cacheRules']['private'])['expect'](0xc8)['then'](_0x405ceb=>{const _0x578f00=_0x405ceb['body'];should['exist'](_0x578f00['posts']);const _0x5524ef=_0x578f00['posts'][0x0];localUtils['API']['checkResponse'](_0x5524ef,'post',null,null,['id',_0xf37d45['mfSUF'],_0xf37d45['AYEBT']]);_0x5524ef['html']['should']['eql']('');_0x5524ef['plaintext']['should']['eql']('');});}else{if(_0x59bad2){return _0x34725e['PTClw'](_0x26aac0,_0x59bad2);}_0x4cb944['headers']['vary']['should']['eql'](_0x34725e['EHCch']);should['exist'](_0x4cb944['headers']['access-control-allow-origin']);should['not']['exist'](_0x4cb944['headers'][_0x34725e['AFPtE']]);const _0x389bda=_0x4cb944['body'];should['exist'](_0x389bda['posts']);localUtils['API']['checkResponse'](_0x389bda,_0x34725e['UDzsC']);_0x389bda['posts']['should']['have']['length'](0xb);localUtils['API']['checkResponse'](_0x389bda['posts'][0x0],_0x34725e['iZKMR']);localUtils['API']['checkResponse'](_0x389bda['meta']['pagination'],_0x34725e['VfUPR']);_['isBoolean'](_0x389bda['posts'][0x0]['featured'])['should']['eql'](!![]);_0x389bda['posts'][0x0]['slug']['should']['eql'](_0x34725e['bXRVC']);_0x389bda['posts'][0x6]['slug']['should']['eql'](_0x34725e['ENopu']);_0x389bda['meta']['pagination']['page']['should']['eql'](0x1);_0x389bda['meta']['pagination']['limit']['should']['eql'](0xf);_0x389bda['meta']['pagination']['pages']['should']['eql'](0x1);_0x389bda['meta']['pagination']['total']['should']['eql'](0xb);_0x389bda['meta']['pagination']['hasOwnProperty'](_0x34725e['yFpYK'])['should']['be']['true']();_0x389bda['meta']['pagination']['hasOwnProperty'](_0x34725e['rGjvS'])['should']['be']['true']();should['not']['exist'](_0x389bda['meta']['pagination']['next']);should['not']['exist'](_0x389bda['meta']['pagination']['prev']);_0x34725e['ZuDCN'](_0x26aac0);}});});it(_0x42b8d9['CDyTH'],function(_0x2f3442){var _0x222ea8={'KVLHw':_0x42b8d9['NBpEZ'],'qNheF':'free-to-see','nSRTW':_0x42b8d9['bsmep'],'cCrLw':'seconds','NeZqz':function(_0x294dd0){return _0x42b8d9['WODrG'](_0x294dd0);},'Dmvpg':_0x42b8d9['mAlwo'],'qmZuQ':_0x42b8d9['OVqmX'],'IUlpi':_0x42b8d9['zFAZz'],'RMoRe':'paid','nfWLN':function(_0x2ec13d,_0x12eff4){return _0x42b8d9['zcuyv'](_0x2ec13d,_0x12eff4);},'QtFZh':_0x42b8d9['ajdCe'],'TffSz':function(_0x3245fb,_0x26d479){return _0x42b8d9['GbXIt'](_0x3245fb,_0x26d479);},'ubsnQ':_0x42b8d9['CHTdY'],'gYQjP':_0x42b8d9['SjxRE'],'sGAMU':'x-cache-invalidate','yYguO':_0x42b8d9['nQKya'],'TeTos':_0x42b8d9['jaIlk'],'eQkcO':_0x42b8d9['zXuhf'],'prKIa':_0x42b8d9['RkgLR'],'XMZQS':_0x42b8d9['kFFTF'],'TkPLM':'next','jdBwM':_0x42b8d9['TZCes']};request['get'](localUtils['API']['getApiQuery']('posts/?key='+_0x2c7de1+'&include=authors,tags'))['set']('Origin',testUtils['API']['getURL']())['expect'](_0x42b8d9['rijlj'],/json/)['expect']('Cache-Control',testUtils['cacheRules']['private'])['expect'](0xc8)['end'](function(_0xfd7cd2,_0x2c2973){if(_0x222ea8['nfWLN'](_0x222ea8['QtFZh'],_0x222ea8['QtFZh'])){var _0x101b1d=_0x222ea8['KVLHw']['split']('|'),_0x2bfea6=0x0;while(!![]){switch(_0x101b1d[_0x2bfea6++]){case'0':publicPost=testUtils['DataGenerator']['forKnex']['createPost']({'slug':_0x222ea8['qNheF'],'visibility':_0x222ea8['nSRTW'],'published_at':moment()['add'](0xf,_0x222ea8['cCrLw'])['toDate']()});continue;case'1':membersPostWithPaywallCard=testUtils['DataGenerator']['forKnex']['createPost']({'slug':'thou-shalt-have-a-taste','visibility':'members','mobiledoc':'{"version":"0.3.1","markups":[],"atoms":[],"cards":[["paywall",{}]],"sections":[[1,"p",[[0,[],0,"Free content"]]],[10,0],[1,"p",[[0,[],0,"Members content"]]]]}','html':'<p>Free\x20content</p><!--members-only--><p>Members\x20content</p>','published_at':_0x222ea8['NeZqz'](moment)['add'](0x5,'seconds')['toDate']()});continue;case'2':return testUtils['fixtures']['insertPosts']([publicPost,membersPost,paidPost,membersPostWithPaywallCard]);case'3':membersPost=testUtils['DataGenerator']['forKnex']['createPost']({'slug':_0x222ea8['Dmvpg'],'visibility':_0x222ea8['qmZuQ'],'published_at':moment()['add'](0x2d,_0x222ea8['cCrLw'])['toDate']()});continue;case'4':paidPost=testUtils['DataGenerator']['forKnex']['createPost']({'slug':_0x222ea8['IUlpi'],'visibility':_0x222ea8['RMoRe'],'published_at':_0x222ea8['NeZqz'](moment)['add'](0x1e,_0x222ea8['cCrLw'])['toDate']()});continue;}break;}}else{if(_0xfd7cd2){return _0x222ea8['TffSz'](_0x2f3442,_0xfd7cd2);}_0x2c2973['headers']['vary']['should']['eql'](_0x222ea8['ubsnQ']);should['exist'](_0x2c2973['headers'][_0x222ea8['gYQjP']]);should['not']['exist'](_0x2c2973['headers'][_0x222ea8['sGAMU']]);const _0x456d27=_0x2c2973['body'];should['exist'](_0x456d27['posts']);localUtils['API']['checkResponse'](_0x456d27,_0x222ea8['yYguO']);_0x456d27['posts']['should']['have']['length'](0xb);localUtils['API']['checkResponse'](_0x456d27['posts'][0x0],'post',[_0x222ea8['TeTos'],'tags','primary_tag',_0x222ea8['eQkcO']],null);localUtils['API']['checkResponse'](_0x456d27['meta']['pagination'],_0x222ea8['prKIa']);_['isBoolean'](_0x456d27['posts'][0x0]['featured'])['should']['eql'](!![]);_0x456d27['posts'][0x0]['slug']['should']['eql']('welcome');_0x456d27['posts'][0x6]['slug']['should']['eql'](_0x222ea8['XMZQS']);_0x456d27['meta']['pagination']['page']['should']['eql'](0x1);_0x456d27['meta']['pagination']['limit']['should']['eql'](0xf);_0x456d27['meta']['pagination']['pages']['should']['eql'](0x1);_0x456d27['meta']['pagination']['total']['should']['eql'](0xb);_0x456d27['meta']['pagination']['hasOwnProperty'](_0x222ea8['TkPLM'])['should']['be']['true']();_0x456d27['meta']['pagination']['hasOwnProperty'](_0x222ea8['jdBwM'])['should']['be']['true']();should['not']['exist'](_0x456d27['meta']['pagination']['next']);should['not']['exist'](_0x456d27['meta']['pagination']['prev']);_0x2f3442();}});});_0x42b8d9['xuyXl'](it,'browse posts with basic page filter should not return pages',function(_0xc91753){var _0x4d6fec={'CGHMp':_0x42b8d9['EwMYl'],'OJXqc':_0x42b8d9['mAlwo'],'ENFnF':function(_0x3d0c9e,_0x198ed5){return _0x3d0c9e!==_0x198ed5;},'aAaJG':_0x42b8d9['wfKBM'],'sNhFX':_0x42b8d9['xszeT'],'cOsAo':function(_0x3d8337,_0x242d3b){return _0x3d8337(_0x242d3b);},'Ihjla':_0x42b8d9['gHpnC'],'McMEA':'pagination','XwudA':function(_0x2f3a2f){return _0x42b8d9['WODrG'](_0x2f3a2f);}};request['get'](localUtils['API']['getApiQuery']('posts/?key='+_0x2c7de1+'&filter=page:true'))['expect'](_0x42b8d9['rijlj'],/json/)['expect']('Cache-Control',testUtils['cacheRules']['private'])['expect'](0xc8)['end'](function(_0x59cab1,_0x17bbad){if(_0x4d6fec['ENFnF'](_0x4d6fec['aAaJG'],_0x4d6fec['sNhFX'])){if(_0x59cab1){return _0x4d6fec['cOsAo'](_0xc91753,_0x59cab1);}const _0x112312=_0x17bbad['body'];should['not']['exist'](_0x17bbad['headers'][_0x4d6fec['Ihjla']]);should['exist'](_0x112312['posts']);localUtils['API']['checkResponse'](_0x112312,'posts');localUtils['API']['checkResponse'](_0x112312['meta']['pagination'],_0x4d6fec['McMEA']);_0x112312['posts']['should']['have']['length'](0x0);_0x4d6fec['XwudA'](_0xc91753);}else{const _0x50e366=_0x17bbad['body'];should['exist'](_0x50e366['posts']);const _0x27d431=_0x50e366['posts'][0x0];localUtils['API']['checkResponse'](_0x27d431,_0x4d6fec['CGHMp'],null,null);_0x27d431['slug']['should']['eql'](_0x4d6fec['OJXqc']);_0x27d431['html']['should']['eql']('');_0x27d431['excerpt']['should']['eql']('');}});});_0x42b8d9['xuyXl'](it,'browse posts with basic page filter should not return pages',function(_0xa4bdd6){var _0xb60477={'zNfDA':_0x42b8d9['qxALD'],'jDhEB':_0x42b8d9['ZYhCT'],'NbRYt':_0x42b8d9['jjjgH'],'dkaQD':'Content-Type','XVDqo':function(_0x15df0a,_0x3f78bc){return _0x42b8d9['gbybw'](_0x15df0a,_0x3f78bc);},'gAtGU':'ahbqn','NeSMd':_0x42b8d9['jnVct'],'LbRgU':function(_0x8250a,_0x209fcf){return _0x8250a(_0x209fcf);},'jEZig':'x-cache-invalidate','fNLBn':'posts','TCGKS':_0x42b8d9['RkgLR'],'HWfNK':function(_0x471588){return _0x471588();}};request['get'](localUtils['API']['getApiQuery']('posts/?key='+_0x2c7de1+'&filter=page:true,featured:true'))['expect'](_0x42b8d9['rijlj'],/json/)['expect']('Cache-Control',testUtils['cacheRules']['private'])['expect'](0xc8)['end'](function(_0x1fee5b,_0x5ac8e0){var _0x21277c={'LHvqj':_0xb60477['zNfDA'],'ypcIm':_0xb60477['jDhEB'],'XPsAL':_0xb60477['NbRYt'],'vEuNS':_0xb60477['dkaQD']};if(_0x1fee5b){if(_0xb60477['XVDqo'](_0xb60477['gAtGU'],_0xb60477['NeSMd'])){return request['get'](localUtils['API']['getApiQuery']('posts/'+publicPost['id']+'/?key='+_0x2c7de1+'&fields=slug,html,plaintext&formats=html,plaintext'))['set'](_0x21277c['XPsAL'],testUtils['API']['getURL']())['expect'](_0x21277c['vEuNS'],/json/)['expect']('Cache-Control',testUtils['cacheRules']['private'])['expect'](0xc8)['then'](_0x38d991=>{const _0x5a02e8=_0x38d991['body'];should['exist'](_0x5a02e8['posts']);const _0x2af5c7=_0x5a02e8['posts'][0x0];localUtils['API']['checkResponse'](_0x2af5c7,'post',null,null,['id','slug',_0x21277c['LHvqj'],'plaintext']);_0x2af5c7['slug']['should']['eql'](_0x21277c['ypcIm']);_0x2af5c7['html']['should']['not']['eql']('');_0x2af5c7['plaintext']['should']['not']['eql']('');});}else{return _0xb60477['LbRgU'](_0xa4bdd6,_0x1fee5b);}}const _0x5eb8d5=_0x5ac8e0['body'];should['not']['exist'](_0x5ac8e0['headers'][_0xb60477['jEZig']]);should['exist'](_0x5eb8d5['posts']);localUtils['API']['checkResponse'](_0x5eb8d5,_0xb60477['fNLBn']);localUtils['API']['checkResponse'](_0x5eb8d5['meta']['pagination'],_0xb60477['TCGKS']);_0x5eb8d5['posts']['should']['have']['length'](0x2);_0x5eb8d5['posts']['filter'](_0x327042=>_0x327042['page']===!![])['should']['have']['length'](0x0);_0xb60477['HWfNK'](_0xa4bdd6);});});it(_0x42b8d9['NCEaJ'],function(_0x17d651){request['get'](localUtils['API']['getApiQuery']('posts/?key='+_0x2c7de1+'&filter=status:published,status:draft'))['expect'](_0x42b8d9['rijlj'],/json/)['expect']('Cache-Control',testUtils['cacheRules']['private'])['expect'](0xc8)['end'](function(_0x4feb1f,_0x4765b9){if(_0x4feb1f){return _0x42b8d9['AuBVI'](_0x17d651,_0x4feb1f);}const _0xe16e6f=_0x4765b9['body'];_0xe16e6f['posts']['should']['be']['an']['Array']()['with']['lengthOf'](0xb);_0x42b8d9['lYxgJ'](_0x17d651);});});it(_0x42b8d9['WWLVr'],function(){return request['get'](localUtils['API']['getApiQuery']('posts/?key='+_0x2c7de1+'&filter=slug:[write,ghostly-kitchen-sink,grow]'))['expect'](_0x42b8d9['rijlj'],/json/)['expect'](_0x42b8d9['rrpFi'],testUtils['cacheRules']['private'])['expect'](0xc8)['then'](_0x6dbed9=>{const _0x40af1d=_0x6dbed9['body'];_0x40af1d['posts']['should']['be']['an']['Array']()['with']['lengthOf'](0x3);_0x40af1d['posts'][0x0]['slug']['should']['equal'](_0x42b8d9['KbqUn']);_0x40af1d['posts'][0x1]['slug']['should']['equal'](_0x42b8d9['eSTVQ']);_0x40af1d['posts'][0x2]['slug']['should']['equal'](_0x42b8d9['ChIDc']);});});_0x42b8d9['xuyXl'](it,'browse\x20posts\x20with\x20slug\x20filter\x20should\x20order\x20taking\x20order\x20parameter\x20into\x20account',function(){var _0x5ce77b={'kQKHl':'Origin','eSyEa':_0x42b8d9['rijlj'],'jWFbi':_0x42b8d9['rrpFi']};if(_0x42b8d9['zugEK'](_0x42b8d9['LOtuF'],_0x42b8d9['LOtuF'])){return request['get'](localUtils['API']['getApiQuery']('posts/?key='+_0x2c7de1+'&order=slug%20DESC&filter=slug:[write,ghostly-kitchen-sink,grow]'))['expect']('Content-Type',/json/)['expect']('Cache-Control',testUtils['cacheRules']['private'])['expect'](0xc8)['then'](_0x26d5ee=>{const _0x3d51a8=_0x26d5ee['body'];_0x3d51a8['posts']['should']['be']['an']['Array']()['with']['lengthOf'](0x3);_0x3d51a8['posts'][0x0]['slug']['should']['equal'](_0x42b8d9['KbqUn']);_0x3d51a8['posts'][0x1]['slug']['should']['equal'](_0x42b8d9['ChIDc']);_0x3d51a8['posts'][0x2]['slug']['should']['equal'](_0x42b8d9['eSTVQ']);});}else{return request['get'](localUtils['API']['getApiQuery']('posts/'+paidPost['id']+'/?key='+_0x2c7de1))['set'](_0x5ce77b['kQKHl'],testUtils['API']['getURL']())['expect'](_0x5ce77b['eSyEa'],/json/)['expect'](_0x5ce77b['jWFbi'],testUtils['cacheRules']['private'])['expect'](0xc8)['then'](_0x5507bc=>{const _0x375990=_0x5507bc['body'];should['exist'](_0x375990['posts']);const _0x239739=_0x375990['posts'][0x0];localUtils['API']['checkResponse'](_0x239739,'post',null,null);_0x239739['slug']['should']['eql']('thou-shalt-be-paid-for');_0x239739['html']['should']['eql']('');_0x239739['excerpt']['should']['eql']('');});}});_0x42b8d9['xuyXl'](it,'ensure origin header on redirect is not getting lost',function(_0x2261b0){var _0x40dcbf={'RaZXC':_0x42b8d9['CHTdY'],'dXlmi':_0x42b8d9['gHpnC'],'ViCAH':_0x42b8d9['RkgLR'],'LAQfS':'thou-shalt-be-paid-for','aletE':'thou-shalt-have-a-taste','zbFvV':_0x42b8d9['pCoek'],'jQTEi':_0x42b8d9['cXXrt'],'DmpKN':_0x42b8d9['TZCes'],'cBmkO':'Origin','AzRhr':_0x42b8d9['rijlj']};if(_0x42b8d9['zugEK'](_0x42b8d9['QWJvo'],_0x42b8d9['QWJvo'])){configUtils['set'](_0x42b8d9['UlqHs'],'http://localhost:9999');urlUtils['stubUrlUtilsFromConfig']();request['get'](localUtils['API']['getApiQuery']('posts?key='+_0x2c7de1))['set'](_0x42b8d9['jjjgH'],_0x42b8d9['UBhrR'])['expect']('Cache-Control',testUtils['cacheRules']['year'])['expect'](0x12d)['end'](function(_0x25f3a5,_0x57863e){var _0x488acc={'BaEAh':_0x42b8d9['EwMYl'],'LZRSO':_0x42b8d9['obXoH']};if(_0x42b8d9['zcuyv']('HVBAE',_0x42b8d9['hTsqO'])){const _0x1c617f=_0x57863e['body'];should['exist'](_0x1c617f['posts']);const _0x25edc9=_0x1c617f['posts'][0x0];localUtils['API']['checkResponse'](_0x25edc9,_0x488acc['BaEAh'],['plaintext']);_0x25edc9['html']['should']['eql'](_0x488acc['LZRSO']);_0x25edc9['plaintext']['should']['eql']('Free\x20content');}else{var _0x500110=_0x42b8d9['lRsdt']['split']('|'),_0x127cee=0x0;while(!![]){switch(_0x500110[_0x127cee++]){case'0':_0x57863e['headers']['location']['should']['eql']('http://localhost:9999/ghost/api/v3/content/posts/?key='+_0x2c7de1);continue;case'1':should['exist'](_0x57863e['headers'][_0x42b8d9['SjxRE']]);continue;case'2':_0x57863e['headers']['vary']['should']['eql'](_0x42b8d9['hlNCe']);continue;case'3':_0x42b8d9['lYxgJ'](_0x2261b0);continue;case'4':if(_0x25f3a5){return _0x2261b0(_0x25f3a5);}continue;case'5':should['not']['exist'](_0x57863e['headers']['x-cache-invalidate']);continue;}break;}}});}else{var _0xd4e901={'UqUmR':_0x40dcbf['RaZXC'],'Maumb':_0x40dcbf['dXlmi'],'rIUAK':'posts','cHPRj':_0x40dcbf['ViCAH'],'aKucz':_0x40dcbf['LAQfS'],'arWLV':_0x40dcbf['aletE'],'htvjY':_0x40dcbf['zbFvV'],'Izvdz':_0x40dcbf['jQTEi'],'vJwuv':_0x40dcbf['DmpKN']};return request['get'](localUtils['API']['getApiQuery']('posts/?key='+_0x2c7de1))['set'](_0x40dcbf['cBmkO'],testUtils['API']['getURL']())['expect'](_0x40dcbf['AzRhr'],/json/)['expect']('Cache-Control',testUtils['cacheRules']['private'])['expect'](0xc8)['then'](_0x2cb277=>{_0x2cb277['headers']['vary']['should']['eql'](_0xd4e901['UqUmR']);should['exist'](_0x2cb277['headers']['access-control-allow-origin']);should['not']['exist'](_0x2cb277['headers'][_0xd4e901['Maumb']]);const _0x1e75da=_0x2cb277['body'];should['exist'](_0x1e75da['posts']);localUtils['API']['checkResponse'](_0x1e75da,_0xd4e901['rIUAK']);_0x1e75da['posts']['should']['have']['length'](0xf);localUtils['API']['checkResponse'](_0x1e75da['posts'][0x0],'post',null,null);localUtils['API']['checkResponse'](_0x1e75da['meta']['pagination'],_0xd4e901['cHPRj']);_['isBoolean'](_0x1e75da['posts'][0x0]['featured'])['should']['eql'](!![]);_0x1e75da['posts'][0x0]['slug']['should']['eql']('thou-shalt-not-be-seen');_0x1e75da['posts'][0x1]['slug']['should']['eql'](_0xd4e901['aKucz']);_0x1e75da['posts'][0x2]['slug']['should']['eql']('free-to-see');_0x1e75da['posts'][0x3]['slug']['should']['eql'](_0xd4e901['arWLV']);_0x1e75da['posts'][0x8]['slug']['should']['eql'](_0xd4e901['htvjY']);_0x1e75da['posts'][0x0]['html']['should']['eql']('');_0x1e75da['posts'][0x1]['html']['should']['eql']('');_0x1e75da['posts'][0x2]['html']['should']['not']['eql']('');_0x1e75da['posts'][0x8]['html']['should']['not']['eql']('');_0x1e75da['posts'][0x0]['excerpt']['should']['eql']('');_0x1e75da['posts'][0x1]['excerpt']['should']['eql']('');_0x1e75da['posts'][0x2]['excerpt']['should']['not']['eql']('');_0x1e75da['posts'][0x3]['excerpt']['should']['not']['eql']('');_0x1e75da['posts'][0x8]['excerpt']['should']['not']['eql']('');_0x1e75da['meta']['pagination']['page']['should']['eql'](0x1);_0x1e75da['meta']['pagination']['limit']['should']['eql'](0xf);_0x1e75da['meta']['pagination']['pages']['should']['eql'](0x1);_0x1e75da['meta']['pagination']['total']['should']['eql'](0xf);_0x1e75da['meta']['pagination']['hasOwnProperty'](_0xd4e901['Izvdz'])['should']['be']['true']();_0x1e75da['meta']['pagination']['hasOwnProperty'](_0xd4e901['vJwuv'])['should']['be']['true']();should['not']['exist'](_0x1e75da['meta']['pagination']['next']);should['not']['exist'](_0x1e75da['meta']['pagination']['prev']);});}});_0x42b8d9['NgNJm'](it,'can\'t read page',function(){var _0x3ec829={'yEauh':function(_0x399809,_0xd94dc5){return _0x42b8d9['AuBVI'](_0x399809,_0xd94dc5);},'Ljxjm':'access-control-allow-origin','xNqAh':'x-cache-invalidate','DfJTW':'posts','BZjNQ':_0x42b8d9['RkgLR'],'khYmR':function(_0x502db6){return _0x502db6();}};if(_0x42b8d9['QGUds'](_0x42b8d9['fZSaG'],_0x42b8d9['dbxyW'])){request['get'](localUtils['API']['getApiQuery']('posts/?key='+_0x2c7de1))['set'](_0x42b8d9['jjjgH'],testUtils['API']['getURL']())['expect']('Content-Type',/json/)['expect'](_0x42b8d9['rrpFi'],testUtils['cacheRules']['private'])['expect'](0xc8)['end'](function(_0x120ecd,_0x75c895){if(_0x120ecd){return _0x3ec829['yEauh'](done,_0x120ecd);}_0x75c895['headers']['vary']['should']['eql']('Accept-Encoding');should['exist'](_0x75c895['headers'][_0x3ec829['Ljxjm']]);should['not']['exist'](_0x75c895['headers'][_0x3ec829['xNqAh']]);const _0x4e422d=_0x75c895['body'];should['exist'](_0x4e422d['posts']);localUtils['API']['checkResponse'](_0x4e422d,_0x3ec829['DfJTW']);_0x4e422d['posts']['should']['have']['length'](0xb);localUtils['API']['checkResponse'](_0x4e422d['posts'][0x0],'post');localUtils['API']['checkResponse'](_0x4e422d['meta']['pagination'],_0x3ec829['BZjNQ']);_['isBoolean'](_0x4e422d['posts'][0x0]['featured'])['should']['eql'](!![]);_0x4e422d['posts'][0x0]['slug']['should']['eql']('welcome');_0x4e422d['posts'][0x6]['slug']['should']['eql']('integrations');_0x4e422d['meta']['pagination']['page']['should']['eql'](0x1);_0x4e422d['meta']['pagination']['limit']['should']['eql'](0xf);_0x4e422d['meta']['pagination']['pages']['should']['eql'](0x1);_0x4e422d['meta']['pagination']['total']['should']['eql'](0xb);_0x4e422d['meta']['pagination']['hasOwnProperty']('next')['should']['be']['true']();_0x4e422d['meta']['pagination']['hasOwnProperty']('prev')['should']['be']['true']();should['not']['exist'](_0x4e422d['meta']['pagination']['next']);should['not']['exist'](_0x4e422d['meta']['pagination']['prev']);_0x3ec829['khYmR'](done);});}else{return request['get'](localUtils['API']['getApiQuery']('posts/'+testUtils['DataGenerator']['Content']['posts'][0x5]['id']+'/?key='+_0x2c7de1))['set'](_0x42b8d9['jjjgH'],testUtils['API']['getURL']())['expect']('Content-Type',/json/)['expect'](_0x42b8d9['rrpFi'],testUtils['cacheRules']['private'])['expect'](0x194);}});_0x42b8d9['untcb'](it,'can read post with fields',function(){var _0x5edbeb={'ypACw':function(_0xa3a030,_0x261d41){return _0x42b8d9['zcuyv'](_0xa3a030,_0x261d41);},'fSlTc':_0x42b8d9['XnqyL'],'PTKXM':_0x42b8d9['gwDBJ'],'dDspA':_0x42b8d9['EwMYl'],'KiGYi':_0x42b8d9['enJeF'],'iRHLn':_0x42b8d9['cesRA'],'kXpjp':_0x42b8d9['QfYQZ']};const _0xb6138c=testUtils['DataGenerator']['Content']['posts']['find'](_0x3ae9ba=>_0x3ae9ba['slug']==='not-so-short-bit-complex')['id'];return request['get'](localUtils['API']['getApiQuery']('posts/'+_0xb6138c+'/?key='+_0x2c7de1+'&fields=title,slug,excerpt&formats=plaintext'))['set'](_0x42b8d9['jjjgH'],testUtils['API']['getURL']())['expect'](_0x42b8d9['rijlj'],/json/)['expect'](_0x42b8d9['rrpFi'],testUtils['cacheRules']['private'])['expect'](0xc8)['then'](_0x41e798=>{var _0xcb080b={'andAd':function(_0x3ed2af,_0x1b708c){return _0x3ed2af(_0x1b708c);}};if(_0x5edbeb['ypACw'](_0x5edbeb['fSlTc'],_0x5edbeb['PTKXM'])){localUtils['API']['checkResponse'](_0x41e798['body']['posts'][0x0],_0x5edbeb['dDspA'],null,null,['id',_0x5edbeb['KiGYi'],_0x5edbeb['iRHLn'],'excerpt',_0x5edbeb['kXpjp']]);_0x41e798['body']['posts'][0x0]['excerpt']['should']['match'](/\* Aliquam \[http:\/\/127.0.0.1:2369\/about#nowhere\]/);}else{return _0xcb080b['andAd'](done,err);}});});_0x42b8d9['untcb'](describe,_0x42b8d9['aMhnM'],function(){var _0x290251={'PmxSt':_0x42b8d9['KbqUn'],'AWaij':_0x42b8d9['eSTVQ'],'ktLSr':'grow','TqGyE':_0x42b8d9['EwMYl'],'kBDaS':_0x42b8d9['QfYQZ'],'aDIGX':_0x42b8d9['rijlj'],'ikCmf':_0x42b8d9['rrpFi'],'pKiek':'Accept-Encoding','zabhm':'posts','jyTPb':_0x42b8d9['mAlwo'],'oyIQc':_0x42b8d9['zFAZz'],'MkzBB':_0x42b8d9['cXXrt'],'QQCYv':function(_0x3dcb02,_0x3ff239){return _0x3dcb02(_0x3ff239);},'SVIje':function(_0x2e2f43,_0x3abba8){return _0x2e2f43!==_0x3abba8;},'AszGG':'FQBRu','vuDWt':_0x42b8d9['jjjgH']};let _0x1879ed;let _0x42a1dd;let _0x293341;let _0x19f890;_0x42b8d9['AuBVI'](before,function(){var _0x2d6756={'epwbg':'Origin','PnZqw':_0x42b8d9['rrpFi']};if(_0x42b8d9['QGUds'](_0x42b8d9['KmQSr'],'HdMLO')){sinon['stub'](labs,'isSet')['withArgs'](_0x42b8d9['OVqmX'])['returns'](!![]);}else{var _0x3a1ddd={'xvusG':'title'};const _0x4e67c2=testUtils['DataGenerator']['Content']['posts']['find'](_0x2ba139=>_0x2ba139['slug']==='not-so-short-bit-complex')['id'];return request['get'](localUtils['API']['getApiQuery']('posts/'+_0x4e67c2+'/?key='+_0x2c7de1+'&fields=title,slug,excerpt&formats=plaintext'))['set'](_0x2d6756['epwbg'],testUtils['API']['getURL']())['expect']('Content-Type',/json/)['expect'](_0x2d6756['PnZqw'],testUtils['cacheRules']['private'])['expect'](0xc8)['then'](_0x34bfe9=>{localUtils['API']['checkResponse'](_0x34bfe9['body']['posts'][0x0],'post',null,null,['id',_0x3a1ddd['xvusG'],'slug','excerpt','plaintext']);_0x34bfe9['body']['posts'][0x0]['excerpt']['should']['match'](/\* Aliquam \[http:\/\/127.0.0.1:2369\/about#nowhere\]/);});}});before(function(){if(_0x42b8d9['gTByE']===_0x42b8d9['GWmyX']){const _0x49fe8e=res['body'];_0x49fe8e['posts']['should']['be']['an']['Array']()['with']['lengthOf'](0x3);_0x49fe8e['posts'][0x0]['slug']['should']['equal'](_0x290251['PmxSt']);_0x49fe8e['posts'][0x1]['slug']['should']['equal'](_0x290251['AWaij']);_0x49fe8e['posts'][0x2]['slug']['should']['equal'](_0x290251['ktLSr']);}else{var _0x1c8797=_0x42b8d9['gnRMN']['split']('|'),_0x140812=0x0;while(!![]){switch(_0x1c8797[_0x140812++]){case'0':_0x293341=testUtils['DataGenerator']['forKnex']['createPost']({'slug':'thou-shalt-be-paid-for','visibility':_0x42b8d9['FBAdX'],'published_at':moment()['add'](0x1e,'seconds')['toDate']()});continue;case'1':_0x1879ed=testUtils['DataGenerator']['forKnex']['createPost']({'slug':_0x42b8d9['ZYhCT'],'visibility':_0x42b8d9['bsmep'],'published_at':moment()['add'](0xf,_0x42b8d9['pdPQv'])['toDate']()});continue;case'2':_0x42a1dd=testUtils['DataGenerator']['forKnex']['createPost']({'slug':'thou-shalt-not-be-seen','visibility':_0x42b8d9['OVqmX'],'published_at':moment()['add'](0x2d,_0x42b8d9['pdPQv'])['toDate']()});continue;case'3':return testUtils['fixtures']['insertPosts']([_0x1879ed,_0x42a1dd,_0x293341,_0x19f890]);case'4':_0x19f890=testUtils['DataGenerator']['forKnex']['createPost']({'slug':'thou-shalt-have-a-taste','visibility':'members','mobiledoc':_0x42b8d9['xBVmr'],'html':'<p>Free content</p><!--members-only--><p>Members content</p>','published_at':_0x42b8d9['lYxgJ'](moment)['add'](0x5,'seconds')['toDate']()});continue;}break;}}});it(_0x42b8d9['Qjmai'],function(){return request['get'](localUtils['API']['getApiQuery']('posts/'+_0x1879ed['id']+'/?key='+_0x2c7de1+'&fields=slug,html,plaintext&formats=html,plaintext'))['set'](_0x42b8d9['jjjgH'],testUtils['API']['getURL']())['expect'](_0x42b8d9['rijlj'],/json/)['expect'](_0x42b8d9['rrpFi'],testUtils['cacheRules']['private'])['expect'](0xc8)['then'](_0x332a4e=>{const _0xdbfc73=_0x332a4e['body'];should['exist'](_0xdbfc73['posts']);const _0x1b884d=_0xdbfc73['posts'][0x0];localUtils['API']['checkResponse'](_0x1b884d,_0x290251['TqGyE'],null,null,['id','slug','html',_0x290251['kBDaS']]);_0x1b884d['slug']['should']['eql']('free-to-see');_0x1b884d['html']['should']['not']['eql']('');_0x1b884d['plaintext']['should']['not']['eql']('');});});_0x42b8d9['FHAHT'](it,_0x42b8d9['ARLAH'],function(){return request['get'](localUtils['API']['getApiQuery']('posts/'+_0x42a1dd['id']+'/?key='+_0x2c7de1))['set'](_0x42b8d9['jjjgH'],testUtils['API']['getURL']())['expect'](_0x42b8d9['rijlj'],/json/)['expect'](_0x42b8d9['rrpFi'],testUtils['cacheRules']['private'])['expect'](0xc8)['then'](_0x2fe2b5=>{const _0x13c8f9=_0x2fe2b5['body'];should['exist'](_0x13c8f9['posts']);const _0x39cdf5=_0x13c8f9['posts'][0x0];localUtils['API']['checkResponse'](_0x39cdf5,'post',null,null);_0x39cdf5['slug']['should']['eql']('thou-shalt-not-be-seen');_0x39cdf5['html']['should']['eql']('');_0x39cdf5['excerpt']['should']['eql']('');});});it(_0x42b8d9['oJZcl'],function(){var _0x1c3658={'IGcCD':_0x42b8d9['EwMYl']};if(_0x42b8d9['KHtCq'](_0x42b8d9['JkNxv'],_0x42b8d9['JkNxv'])){return request['get'](localUtils['API']['getApiQuery']('posts/'+_0x293341['id']+'/?key='+_0x2c7de1))['set'](_0x42b8d9['jjjgH'],testUtils['API']['getURL']())['expect'](_0x42b8d9['rijlj'],/json/)['expect'](_0x42b8d9['rrpFi'],testUtils['cacheRules']['private'])['expect'](0xc8)['then'](_0x516164=>{const _0x57a4d9=_0x516164['body'];should['exist'](_0x57a4d9['posts']);const _0xd9fe4f=_0x57a4d9['posts'][0x0];localUtils['API']['checkResponse'](_0xd9fe4f,_0x1c3658['IGcCD'],null,null);_0xd9fe4f['slug']['should']['eql']('thou-shalt-be-paid-for');_0xd9fe4f['html']['should']['eql']('');_0xd9fe4f['excerpt']['should']['eql']('');});}else{var _0x49e644={'gDHKM':function(_0x20d529,_0x24dab6){return _0x20d529(_0x24dab6);}};request['get'](localUtils['API']['getApiQuery']('posts/?key='+_0x2c7de1+'&filter=status:published,status:draft'))['expect'](_0x290251['aDIGX'],/json/)['expect'](_0x290251['ikCmf'],testUtils['cacheRules']['private'])['expect'](0xc8)['end'](function(_0x2c2680,_0x556c9c){if(_0x2c2680){return _0x49e644['gDHKM'](done,_0x2c2680);}const _0x7606ab=_0x556c9c['body'];_0x7606ab['posts']['should']['be']['an']['Array']()['with']['lengthOf'](0xb);done();});}});_0x42b8d9['ESMqx'](it,'cannot read members only post plaintext',function(){return request['get'](localUtils['API']['getApiQuery']('posts/'+_0x42a1dd['id']+'/?key='+_0x2c7de1+'&formats=html,plaintext&fields=html,plaintext'))['set']('Origin',testUtils['API']['getURL']())['expect'](_0x42b8d9['rijlj'],/json/)['expect'](_0x42b8d9['rrpFi'],testUtils['cacheRules']['private'])['expect'](0xc8)['then'](_0x10c34c=>{const _0x1cac34=_0x10c34c['body'];should['exist'](_0x1cac34['posts']);const _0x238dea=_0x1cac34['posts'][0x0];localUtils['API']['checkResponse'](_0x238dea,_0x290251['TqGyE'],null,null,['id','html',_0x290251['kBDaS']]);_0x238dea['html']['should']['eql']('');_0x238dea['plaintext']['should']['eql']('');});});_0x42b8d9['eZXiN'](it,_0x42b8d9['gxVjJ'],function(){var _0xc6bfea={'VwyvX':_0x42b8d9['eSTVQ'],'DjKLL':_0x42b8d9['ChIDc'],'vyZHl':function(_0x2db38b,_0x4bd751){return _0x42b8d9['AuBVI'](_0x2db38b,_0x4bd751);},'wqmGi':_0x42b8d9['SjxRE'],'QPZMG':_0x42b8d9['gHpnC'],'uwmMl':_0x42b8d9['jaIlk'],'efEPT':_0x42b8d9['Xqlwo'],'XCpfz':'primary_tag','rqWtr':_0x42b8d9['ZuLJz'],'cBlmo':_0x42b8d9['kFFTF'],'aQJWC':'next','osEHU':_0x42b8d9['TZCes'],'pGbzF':function(_0x4058d2,_0x58d383){return _0x42b8d9['BgjNm'](_0x4058d2,_0x58d383);},'RKejP':'HZyyG'};if(_0x42b8d9['AyiZg']('CjxRF','xsJJA')){return request['get'](localUtils['API']['getApiQuery']('posts/?key='+_0x2c7de1+'&filter=slug:[write,ghostly-kitchen-sink,grow]'))['expect']('Content-Type',/json/)['expect'](_0x290251['ikCmf'],testUtils['cacheRules']['private'])['expect'](0xc8)['then'](_0x181a2b=>{const _0x13d42f=_0x181a2b['body'];_0x13d42f['posts']['should']['be']['an']['Array']()['with']['lengthOf'](0x3);_0x13d42f['posts'][0x0]['slug']['should']['equal']('write');_0x13d42f['posts'][0x1]['slug']['should']['equal'](_0xc6bfea['VwyvX']);_0x13d42f['posts'][0x2]['slug']['should']['equal'](_0xc6bfea['DjKLL']);});}else{return request['get'](localUtils['API']['getApiQuery']('posts/'+_0x19f890['id']+'/?key='+_0x2c7de1+'&formats=html,plaintext'))['set']('Origin',testUtils['API']['getURL']())['expect']('Content-Type',/json/)['expect'](_0x42b8d9['rrpFi'],testUtils['cacheRules']['private'])['expect'](0xc8)['then'](_0x5693b8=>{var _0x3cad98={'hcGXf':function(_0x2e69ff,_0x9e5b6){return _0xc6bfea['vyZHl'](_0x2e69ff,_0x9e5b6);},'lsFxN':'Accept-Encoding','dIykt':_0xc6bfea['wqmGi'],'cYeeI':_0xc6bfea['QPZMG'],'rWPgY':'posts','kYdcm':'post','JKArh':_0xc6bfea['uwmMl'],'FAAni':_0xc6bfea['efEPT'],'VPWaJ':_0xc6bfea['XCpfz'],'UpyIF':'primary_author','JSujJ':_0xc6bfea['rqWtr'],'BsTfd':_0xc6bfea['cBlmo'],'hAety':_0xc6bfea['aQJWC'],'GlRzC':_0xc6bfea['osEHU']};if(_0xc6bfea['pGbzF'](_0xc6bfea['RKejP'],'QqXyB')){if(err){return _0x3cad98['hcGXf'](done,err);}_0x5693b8['headers']['vary']['should']['eql'](_0x3cad98['lsFxN']);should['exist'](_0x5693b8['headers'][_0x3cad98['dIykt']]);should['not']['exist'](_0x5693b8['headers'][_0x3cad98['cYeeI']]);const _0x42af92=_0x5693b8['body'];should['exist'](_0x42af92['posts']);localUtils['API']['checkResponse'](_0x42af92,_0x3cad98['rWPgY']);_0x42af92['posts']['should']['have']['length'](0xb);localUtils['API']['checkResponse'](_0x42af92['posts'][0x0],_0x3cad98['kYdcm'],[_0x3cad98['JKArh'],_0x3cad98['FAAni'],_0x3cad98['VPWaJ'],_0x3cad98['UpyIF']],null);localUtils['API']['checkResponse'](_0x42af92['meta']['pagination'],'pagination');_['isBoolean'](_0x42af92['posts'][0x0]['featured'])['should']['eql'](!![]);_0x42af92['posts'][0x0]['slug']['should']['eql'](_0x3cad98['JSujJ']);_0x42af92['posts'][0x6]['slug']['should']['eql'](_0x3cad98['BsTfd']);_0x42af92['meta']['pagination']['page']['should']['eql'](0x1);_0x42af92['meta']['pagination']['limit']['should']['eql'](0xf);_0x42af92['meta']['pagination']['pages']['should']['eql'](0x1);_0x42af92['meta']['pagination']['total']['should']['eql'](0xb);_0x42af92['meta']['pagination']['hasOwnProperty'](_0x3cad98['hAety'])['should']['be']['true']();_0x42af92['meta']['pagination']['hasOwnProperty'](_0x3cad98['GlRzC'])['should']['be']['true']();should['not']['exist'](_0x42af92['meta']['pagination']['next']);should['not']['exist'](_0x42af92['meta']['pagination']['prev']);done();}else{const _0x46ca57=_0x5693b8['body'];should['exist'](_0x46ca57['posts']);const _0x3fc4ad=_0x46ca57['posts'][0x0];localUtils['API']['checkResponse'](_0x3fc4ad,'post',['plaintext']);_0x3fc4ad['html']['should']['eql']('<p>Free\x20content</p>');_0x3fc4ad['plaintext']['should']['eql']('Free content');}});}});it('cannot browse members only posts content',function(){var _0x121d31={'QjlSw':function(_0x3b4722,_0x1b45a0){return _0x290251['QQCYv'](_0x3b4722,_0x1b45a0);}};if(_0x290251['SVIje']('uQHCP',_0x290251['AszGG'])){return request['get'](localUtils['API']['getApiQuery']('posts/?key='+_0x2c7de1))['set'](_0x290251['vuDWt'],testUtils['API']['getURL']())['expect'](_0x290251['aDIGX'],/json/)['expect'](_0x290251['ikCmf'],testUtils['cacheRules']['private'])['expect'](0xc8)['then'](_0x143020=>{_0x143020['headers']['vary']['should']['eql'](_0x290251['pKiek']);should['exist'](_0x143020['headers']['access-control-allow-origin']);should['not']['exist'](_0x143020['headers']['x-cache-invalidate']);const _0x5c47e8=_0x143020['body'];should['exist'](_0x5c47e8['posts']);localUtils['API']['checkResponse'](_0x5c47e8,_0x290251['zabhm']);_0x5c47e8['posts']['should']['have']['length'](0xf);localUtils['API']['checkResponse'](_0x5c47e8['posts'][0x0],_0x290251['TqGyE'],null,null);localUtils['API']['checkResponse'](_0x5c47e8['meta']['pagination'],'pagination');_['isBoolean'](_0x5c47e8['posts'][0x0]['featured'])['should']['eql'](!![]);_0x5c47e8['posts'][0x0]['slug']['should']['eql'](_0x290251['jyTPb']);_0x5c47e8['posts'][0x1]['slug']['should']['eql'](_0x290251['oyIQc']);_0x5c47e8['posts'][0x2]['slug']['should']['eql']('free-to-see');_0x5c47e8['posts'][0x3]['slug']['should']['eql']('thou-shalt-have-a-taste');_0x5c47e8['posts'][0x8]['slug']['should']['eql']('sell');_0x5c47e8['posts'][0x0]['html']['should']['eql']('');_0x5c47e8['posts'][0x1]['html']['should']['eql']('');_0x5c47e8['posts'][0x2]['html']['should']['not']['eql']('');_0x5c47e8['posts'][0x8]['html']['should']['not']['eql']('');_0x5c47e8['posts'][0x0]['excerpt']['should']['eql']('');_0x5c47e8['posts'][0x1]['excerpt']['should']['eql']('');_0x5c47e8['posts'][0x2]['excerpt']['should']['not']['eql']('');_0x5c47e8['posts'][0x3]['excerpt']['should']['not']['eql']('');_0x5c47e8['posts'][0x8]['excerpt']['should']['not']['eql']('');_0x5c47e8['meta']['pagination']['page']['should']['eql'](0x1);_0x5c47e8['meta']['pagination']['limit']['should']['eql'](0xf);_0x5c47e8['meta']['pagination']['pages']['should']['eql'](0x1);_0x5c47e8['meta']['pagination']['total']['should']['eql'](0xf);_0x5c47e8['meta']['pagination']['hasOwnProperty'](_0x290251['MkzBB'])['should']['be']['true']();_0x5c47e8['meta']['pagination']['hasOwnProperty']('prev')['should']['be']['true']();should['not']['exist'](_0x5c47e8['meta']['pagination']['next']);should['not']['exist'](_0x5c47e8['meta']['pagination']['prev']);});}else{return _0x121d31['QjlSw'](done,err);}});});});