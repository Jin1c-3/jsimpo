import _0x1d7893 from'underscore';import{FileUploadClass,FileUpload}from'../lib/FileUpload';import{settings}from'../../../settings';import'../../ufs/Webdav/server.js';const get=function(file,req,res){var dhyxGG={'YVnKu':'An error ocurred when fetching the file','kOVHC':'Bwvlw','FCKjD':'error','QPJUj':'data'};this['store']['getReadStream'](file['_id'],file)['on'](dhyxGG['FCKjD'],()=>{console['error'](dhyxGG['YVnKu']);res['writeHead'](0x1f7);res['end']();})['on'](dhyxGG['QPJUj'],chunk=>{if(dhyxGG['kOVHC']==='xygHw'){this['store']['getReadStream'](file['_id'],file)['pipe'](out);}else{res['write'](chunk);}})['on']('end',res['end']['bind'](res));};const copy=function(file,out){this['store']['getReadStream'](file['_id'],file)['pipe'](out);};const WebdavUploads=new FileUploadClass({'name':'Webdav:Uploads','get':get,'copy':copy});const WebdavAvatars=new FileUploadClass({'name':'Webdav:Avatars','get':get,'copy':copy});const WebdavUserDataFiles=new FileUploadClass({'name':'Webdav:UserDataFiles','get':get,'copy':copy});const configure=_0x1d7893['debounce'](function(){var oYeQcg={'PifFP':'FileUpload_Webdav_Upload_Folder_Path','IClcv':'FileUpload_Webdav_Server_URL','BoOEt':'FileUpload_Webdav_Username','ulssl':'FileUpload_Webdav_Password','QGSeb':function(x,y){return x||y;},'czEmu':'hmZON','hkmLX':'aMsnm','HPQbi':'Webdav'};const uploadFolderPath=settings['get'](oYeQcg['PifFP']);const server=settings['get'](oYeQcg['IClcv']);const username=settings['get'](oYeQcg['BoOEt']);const password=settings['get'](oYeQcg['ulssl']);if(oYeQcg['QGSeb'](!server,!username)||!password){if(oYeQcg['czEmu']!==oYeQcg['hkmLX']){return;}else{console['error']('An error ocurred when fetching the file');res['writeHead'](0x1f7);res['end']();}}const config={'connection':{'credentials':{'server':server,'username':username,'password':password}},'uploadFolderPath':uploadFolderPath};WebdavUploads['store']=FileUpload['configureUploadsStore'](oYeQcg['HPQbi'],WebdavUploads['name'],config);WebdavAvatars['store']=FileUpload['configureUploadsStore'](oYeQcg['HPQbi'],WebdavAvatars['name'],config);WebdavUserDataFiles['store']=FileUpload['configureUploadsStore'](oYeQcg['HPQbi'],WebdavUserDataFiles['name'],config);},0x1f4);settings['get'](/^FileUpload_Webdav_/,configure);