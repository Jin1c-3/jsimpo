import _0x4f8401 from'fs';import _0x4745e3 from'path';import*as _0x39d0ad from'../../../packages/weex-vue-framework';import{compile}from'../../../packages/weex-template-compiler';import _0xee4779 from'weex-js-runtime';import _0x1f0c1c from'weex-styler';const styleRE=/<\s*style\s*\w*>([^(<\/)]*)<\/\s*style\s*>/g;const scriptRE=/<\s*script.*>([^]*)<\/\s*script\s*>/;const templateRE=/<\s*template\s*([^>]*)>([^]*)<\/\s*template\s*>/;export function readFile(filename){var UkqyPj={'tkWVp':'../cases/','oiRZj':'utf8'};return _0x4f8401['readFileSync'](_0x4745e3['resolve'](__dirname,UkqyPj['tkWVp'],filename),UkqyPj['oiRZj']);}export function readObject(filename){var QLBfwD={'FxpFv':function(callee,param1){return callee(param1);}};return new Function('return\x20'+QLBfwD['FxpFv'](readFile,filename))();}console['debug']=()=>{};const matchOperatorsRe=/[|\\{}()[\]^$+*?.]/g;export function strToRegExp(str){var cFrGjJ={'XNJua':'\x5c$&'};return new RegExp(str['replace'](matchOperatorsRe,cFrGjJ['XNJua']));}function parseStatic(fns){var PGPocM={'EExzB':function(x,y){return x+y;}};return PGPocM['EExzB']('['+fns['map'](fn=>'function () { '+fn+'\x20}')['join'](','),']');}export function compileAndStringify(template){const {render,staticRenderFns}=compile(template);return{'render':'function () { '+render+'\x20}','staticRenderFns':parseStatic(staticRenderFns)};}export function compileVue(source,componentName){var kxhBrO={'gRGcz':function(callee,param1){return callee(param1);},'wAESF':function(callee,param1){return callee(param1);},'TDaRI':function(x,y){return x===y;},'hPXUM':'@styleScope','JeXTz':'No Template!','pVKEF':function(x,y){return x===y;},'xsyEU':'nPezo','zPNGz':function(callee,param1,param2){return callee(param1,param2);},'kkflV':function(x,y){return x+y;},'wCoCV':function(x,y){return x*y;},'XiPoD':function(callee,param1){return callee(param1);}};return new Promise((resolve,reject)=>{var WARrRz={'vuvAg':function(callee,param1){return kxhBrO['wAESF'](callee,param1);},'MfVSW':function(x,y){return kxhBrO['TDaRI'](x,y);},'aBRCs':kxhBrO['hPXUM'],'EgOPQ':'@templateId','irWMb':'bindingExpression'};if(!templateRE['test'](source)){return kxhBrO['wAESF'](reject,kxhBrO['JeXTz']);}const scriptMatch=scriptRE['exec'](source);const script=scriptMatch?scriptMatch[0x1]:'';const templateMatch=templateRE['exec'](source);const compileOptions={};if(/\s*recyclable\=?/i['test'](templateMatch[0x1])){if(kxhBrO['pVKEF']('nPezo',kxhBrO['xsyEU'])){compileOptions['recyclable']=!![];}else{delete object['ref'];for(const _0x565d3a in object){WARrRz['vuvAg'](omitUseless,object[_0x565d3a]);if(WARrRz['MfVSW'](_0x565d3a,WARrRz['aBRCs'])||WARrRz['MfVSW'](_0x565d3a,WARrRz['EgOPQ'])||_0x565d3a===WARrRz['irWMb']){delete object[_0x565d3a];}if(_0x565d3a['charAt'](0x0)!=='@'&&(WARrRz['vuvAg'](isEmptyObject,object[_0x565d3a])||WARrRz['MfVSW'](object[_0x565d3a],undefined))){delete object[_0x565d3a];}}}}const res=kxhBrO['zPNGz'](compile,templateMatch[0x2],compileOptions);const name=kxhBrO['kkflV']('test_case_',kxhBrO['wCoCV'](Math['random'](),0x5f5e0ff)['toFixed'](0x0));const generateCode=styles=>'\n      try { weex.document.registerStyleSheets("'+name+'", ['+JSON['stringify'](styles)+']) } catch(e) {};\n      var '+name+'\x20=\x20Object.assign({\x0a\x20\x20\x20\x20\x20\x20\x20\x20_scopeId:\x20\x22'+name+'",\n        style: '+JSON['stringify'](styles)+',\n        render: function () { '+res['render']+' },\n        '+(res['@render']?'\x22@render\x22:\x20function\x20()\x20{'+res['@render']+'},':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20staticRenderFns:\x20'+parseStatic(res['staticRenderFns'])+',\x0a\x20\x20\x20\x20\x20\x20},\x20(function(){\x0a\x20\x20\x20\x20\x20\x20\x20\x20var\x20module\x20=\x20{\x20exports:\x20{}\x20};\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+script+';\n        return module.exports;\n      })());\n    '+(componentName?'Vue.component(\x27'+componentName+'\x27,\x20'+name+');\n':name+'.el\x20=\x20\x27body\x27;new\x20Vue('+name+');');let cssText='';let styleMatch=null;while(styleMatch=styleRE['exec'](source)){cssText+='\x0a'+styleMatch[0x1]+'\x0a';}_0x1f0c1c['parse'](cssText,(error,result)=>{if(error){return kxhBrO['gRGcz'](reject,error);}resolve(kxhBrO['gRGcz'](generateCode,result['jsonStyle']));});kxhBrO['wAESF'](resolve,kxhBrO['XiPoD'](generateCode,{}));});}export function compileWithDeps(entryPath,deps){var wzkPYH={'WMbpP':function(callee,param1,param2){return callee(param1,param2);},'EhwgZ':'CtZeh','oRUqh':function(callee,param1){return callee(param1);}};return new Promise((resolve,reject)=>{var gAgYMg={'FeJSx':function(callee,param1,param2){return wzkPYH['WMbpP'](callee,param1,param2);},'XtnAw':function(callee,param1){return callee(param1);},'dQHAp':function(x,y){return x+y;},'uEbGd':wzkPYH['EhwgZ'],'MZfKx':function(callee,param1){return wzkPYH['oRUqh'](callee,param1);},'LGzKj':function(callee,param1){return wzkPYH['oRUqh'](callee,param1);}};if(Array['isArray'](deps)){Promise['all'](deps['map'](dep=>{return gAgYMg['FeJSx'](compileVue,readFile(dep['path']),dep['name'])['catch'](reject);}))['then'](depCodes=>{if(gAgYMg['uEbGd']===gAgYMg['uEbGd']){gAgYMg['MZfKx'](compileVue,gAgYMg['LGzKj'](readFile,entryPath))['then'](entryCode=>{gAgYMg['XtnAw'](resolve,gAgYMg['dQHAp'](depCodes['join']('\x0a'),entryCode));})['catch'](reject);}else{let _0x1fc635=Promise['resolve']();arr['forEach'](_0x289858=>{_0x1fc635=_0x1fc635['then'](_0x289858);});return _0x1fc635;}})['catch'](reject);}});}function isObject(object){var XERybv={'VcdKy':function(x,y){return x!==y;},'vxXYU':function(x,y){return x===y;},'tNfxS':'object'};return XERybv['VcdKy'](object,null)&&XERybv['vxXYU'](typeof object,XERybv['tNfxS']);}function isEmptyObject(object){var TOJlec={'lruaL':function(callee,param1){return callee(param1);},'MtDMG':function(x,y){return x<y;}};return TOJlec['lruaL'](isObject,object)&&TOJlec['MtDMG'](Object['keys'](object)['length'],0x1);}function omitUseless(object){var gYCLMa={'OwoTz':function(callee,param1){return callee(param1);},'hFgtT':function(x,y){return x===y;},'KknHc':'LfQju','LqPzt':function(callee,param1){return callee(param1);},'hJckl':'@styleScope','tiCOX':'@templateId','UChuQ':'bindingExpression','DAbZN':function(x,y){return x!==y;},'eYinH':'gwJgr','flTXR':function(x,y){return x!==y;},'KNeLm':function(x,y){return x===y;}};if(gYCLMa['OwoTz'](isObject,object)){delete object['ref'];for(const key in object){if(gYCLMa['hFgtT'](gYCLMa['KknHc'],'RatlI')){delete object[key];}else{gYCLMa['LqPzt'](omitUseless,object[key]);if(key===gYCLMa['hJckl']||key===gYCLMa['tiCOX']||gYCLMa['hFgtT'](key,gYCLMa['UChuQ'])){if(gYCLMa['DAbZN']('gwJgr',gYCLMa['eYinH'])){events['push']({'ref':node['ref'],'type':type});}else{delete object[key];}}if(gYCLMa['flTXR'](key['charAt'](0x0),'@')&&(isEmptyObject(object[key])||gYCLMa['KNeLm'](object[key],undefined))){delete object[key];}}}}return object;}export function getRoot(instance){var MeDrVx={'NlRZz':function(callee,param1){return callee(param1);}};return MeDrVx['NlRZz'](omitUseless,instance['$getRoot']());}export function getEvents(instance){var nJdskK={'WfaIr':'../cases/','zbmwH':'utf8','qIKxG':function(x,y){return x===y;},'PhAST':'lLDQL','JyyRf':function(x,y){return x===y;},'YFHfH':'@styleScope','FreFD':'@templateId','yUEaH':'bindingExpression','bRNaU':'\x5c$&','gsGZz':function(x,y){return x!==y;},'yNAaW':'aGLuh','tWoSS':'PCIZH'};const events=[];const recordEvent=node=>{var pbdCMQ={'IAYoG':function(callee,param1){return callee(param1);},'HDxYG':function(x,y){return nJdskK['JyyRf'](x,y);},'nrUZc':nJdskK['YFHfH'],'NlwiI':function(x,y){return x===y;},'tUbxP':nJdskK['FreFD'],'UugyR':function(x,y){return x===y;},'mEIKz':nJdskK['yUEaH'],'fnunE':function(x,y){return x!==y;},'wMOEz':nJdskK['bRNaU']};if(!node){if(nJdskK['gsGZz'](nJdskK['yNAaW'],'aGLuh')){pbdCMQ['IAYoG'](omitUseless,object[key]);if(pbdCMQ['HDxYG'](key,pbdCMQ['nrUZc'])||pbdCMQ['NlwiI'](key,pbdCMQ['tUbxP'])||pbdCMQ['UugyR'](key,pbdCMQ['mEIKz'])){delete object[key];}if(pbdCMQ['fnunE'](key['charAt'](0x0),'@')&&(isEmptyObject(object[key])||pbdCMQ['UugyR'](object[key],undefined))){delete object[key];}}else{return;}}if(Array['isArray'](node['event'])){if(nJdskK['tWoSS']===nJdskK['tWoSS']){node['event']['forEach'](type=>{var okZdpg={'xaIRA':nJdskK['WfaIr'],'dfhPU':nJdskK['zbmwH']};if(nJdskK['qIKxG']('GsdOY',nJdskK['PhAST'])){return _0x4f8401['readFileSync'](_0x4745e3['resolve'](__dirname,okZdpg['xaIRA'],filename),okZdpg['dfhPU']);}else{events['push']({'ref':node['ref'],'type':type});}});}else{return new RegExp(str['replace'](matchOperatorsRe,pbdCMQ['wMOEz']));}}if(Array['isArray'](node['children'])){node['children']['forEach'](recordEvent);}};recordEvent(instance['$getRoot']());return events;}export function fireEvent(instance,ref,type,event={}){const el=instance['document']['getRef'](ref);if(el){instance['document']['fireEvent'](el,type,event);}}export function createInstance(id,code,...args){var eNsrMi={'PsOwn':function(x,y){return x===y;},'cvDdc':'BdsjN','mzLqI':'lifecycle','GwVdm':'setTimeout','JvkgY':'setInterval'};_0xee4779['config']['frameworks']={'Vue':_0x39d0ad};const context=_0xee4779['init'](_0xee4779['config']);context['registerModules']({'timer':[eNsrMi['GwVdm'],eNsrMi['JvkgY']]});const instance=context['createInstance'](id,'// { "framework": "Vue" }\n'+code,...args)||{};instance['document']=context['getDocument'](id);instance['$getRoot']=()=>context['getRoot'](id);instance['$refresh']=data=>context['refreshInstance'](id,data);instance['$destroy']=()=>{if(eNsrMi['cvDdc']===eNsrMi['cvDdc']){delete instance['document'];context['destroyInstance'](id);}else{return object!==null&&eNsrMi['PsOwn'](typeof object,'object');}};instance['$triggerHook']=(id,hook,args)=>{instance['document']['taskCenter']['triggerHook'](id,eNsrMi['mzLqI'],hook,{'args':args});};return instance;}export function compileAndExecute(template,additional=''){var rmJqJo={'JjeuS':function(callee,param1){return callee(param1);},'lfqhE':function(x,y){return x*y;},'QcmPc':function(callee,param1,param2){return callee(param1,param2);}};return new Promise(resolve=>{const id=rmJqJo['JjeuS'](String,rmJqJo['lfqhE'](Date['now'](),Math['random']()));const {render,staticRenderFns}=rmJqJo['JjeuS'](compile,template);const instance=rmJqJo['QcmPc'](createInstance,id,'\n      new Vue({\n        el: \'#whatever\',\n        render: function () { '+render+' },\n        staticRenderFns: '+rmJqJo['JjeuS'](parseStatic,staticRenderFns)+',\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+additional+'\n      })\n    ');setTimeout(()=>resolve(instance),0xa);});}export function syncPromise(arr){let p=Promise['resolve']();arr['forEach'](item=>{p=p['then'](item);});return p;}export function checkRefresh(instance,data,checker){var HyeWtR={'vbGNi':function(callee,param1){return callee(param1);},'ZAZFl':function(x,y){return x===y;},'Qvqfh':'FjiTg','hvnzm':'SQYYv'};return()=>new Promise(res=>{var iYXkkz={'Edqkn':function(callee,param1){return HyeWtR['vbGNi'](callee,param1);}};if(HyeWtR['ZAZFl'](HyeWtR['Qvqfh'],HyeWtR['hvnzm'])){delete instance['document'];context['destroyInstance'](id);}else{instance['$refresh'](data);setTimeout(()=>{iYXkkz['Edqkn'](checker,getRoot(instance));res();});}});}export function addTaskHook(hook){var PgjGGF={'EXVFb':function(callee,param1,param2){return callee(param1,param2);},'swhfI':function(x,y){return x===y;},'JFBEd':'function'};global['callNative']=function callNative(id,tasks){var saCOjO={'ICQOW':function(callee,param1,param2){return PgjGGF['EXVFb'](callee,param1,param2);}};if(Array['isArray'](tasks)&&PgjGGF['swhfI'](typeof hook,PgjGGF['JFBEd'])){tasks['forEach'](task=>{saCOjO['ICQOW'](hook,id,{'module':task['module'],'method':task['method'],'args':Array['from'](task['args'])});});}};}export function resetTaskHook(){delete global['callNative'];}