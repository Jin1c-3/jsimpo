import _0x36765d from'sinon';import{silencePromise}from'../../src/js/utils/promise';import _0x1a8e1b from'./test-helpers';QUnit['module']('Player#play',{'beforeEach'(){this['clock']=_0x36765d['useFakeTimers']();this['player']=_0x1a8e1b['makePlayer']({});this['techPlayCallCount']=0x0;this['techCurrentTimeCallCount']=0x0;this['initTime']=0x0;this['player']['tech_']['play']=()=>{this['techPlayCallCount']++;};this['player']['tech_']['setCurrentTime']=seconds=>{this['techCurrentTimeCallCount']++;this['initTime']=seconds;};},'afterEach'(){this['player']['dispose']();this['clock']['restore']();}});QUnit['test']('tech\x20not\x20ready\x20+\x20no\x20source\x20=\x20wait\x20for\x20ready,\x20then\x20loadstart',function(assert){var IPOvQb={'YmUQm':'tech_.play\x20was\x20not\x20called\x20because\x20there\x20was\x20no\x20source','RNRKd':'xyz.mp4','BoXxZ':'loadstart'};this['player']['isReady_']=![];this['player']['play']();this['clock']['tick'](0x64);assert['strictEqual'](this['techPlayCallCount'],0x0,'tech_.play was not called because the tech was not ready');this['player']['triggerReady']();this['clock']['tick'](0x64);assert['strictEqual'](this['techPlayCallCount'],0x0,IPOvQb['YmUQm']);this['player']['src'](IPOvQb['RNRKd']);this['clock']['tick'](0x64);this['player']['trigger'](IPOvQb['BoXxZ']);assert['strictEqual'](this['techPlayCallCount'],0x1,'tech_.play was called');});QUnit['test']('tech not ready + has source = wait for ready',function(assert){var dUzLQT={'juRXW':'2|3|4|1|8|7|6|5|0','heIXB':'xyz.mp4','IbSXg':'tech_.play\x20was\x20not\x20called\x20because\x20the\x20tech\x20was\x20not\x20ready'};var iaaxxa=dUzLQT['juRXW']['split']('|'),PtQyPI=0x0;while(!![]){switch(iaaxxa[PtQyPI++]){case'0':assert['strictEqual'](this['techPlayCallCount'],0x1,'tech_.play\x20was\x20called');continue;case'1':this['player']['play']();continue;case'2':this['player']['isReady_']=![];continue;case'3':this['player']['src'](dUzLQT['heIXB']);continue;case'4':this['clock']['tick'](0x64);continue;case'5':this['clock']['tick'](0x64);continue;case'6':this['player']['triggerReady']();continue;case'7':assert['strictEqual'](this['techPlayCallCount'],0x0,dUzLQT['IbSXg']);continue;case'8':this['clock']['tick'](0x64);continue;}break;}});QUnit['test']('tech ready + no source = wait for loadstart',function(assert){var klnOIL={'JQTRC':'tech_.play\x20was\x20not\x20called\x20because\x20the\x20tech\x20was\x20not\x20ready','fbrsU':'xyz.mp4','uJRRP':'tech_.play\x20was\x20called'};this['player']['play']();this['clock']['tick'](0x64);assert['strictEqual'](this['techPlayCallCount'],0x0,klnOIL['JQTRC']);this['player']['src'](klnOIL['fbrsU']);this['clock']['tick'](0x64);this['player']['trigger']('loadstart');assert['strictEqual'](this['techPlayCallCount'],0x1,klnOIL['uJRRP']);});QUnit['test']('tech ready + has source = play immediately!',function(assert){var MiaOcD={'iijJl':'xyz.mp4','NoTMc':function(callee,param1){return callee(param1);},'LINxv':'tech_.play was called'};this['player']['src'](MiaOcD['iijJl']);this['clock']['tick'](0x64);MiaOcD['NoTMc'](silencePromise,this['player']['play']());assert['strictEqual'](this['techPlayCallCount'],0x1,MiaOcD['LINxv']);});QUnit['test']('tech\x20ready\x20+\x20has\x20source\x20+\x20changing\x20source\x20=\x20wait\x20for\x20loadstart',function(assert){var EsvNMr={'LkqNX':'xyz.mp4','AJnun':'tech_.play was not called because the source was changing','jixkC':'abc.mp4','JYfKm':'loadstart'};var teWAtk='0|7|4|2|6|1|5|3'['split']('|'),oQAFXM=0x0;while(!![]){switch(teWAtk[oQAFXM++]){case'0':this['player']['src'](EsvNMr['LkqNX']);continue;case'1':assert['strictEqual'](this['techPlayCallCount'],0x0,EsvNMr['AJnun']);continue;case'2':this['player']['play']();continue;case'3':assert['strictEqual'](this['techPlayCallCount'],0x1,'tech_.play was called');continue;case'4':this['player']['src'](EsvNMr['jixkC']);continue;case'5':this['player']['trigger'](EsvNMr['JYfKm']);continue;case'6':this['clock']['tick'](0x64);continue;case'7':this['clock']['tick'](0x64);continue;}break;}});