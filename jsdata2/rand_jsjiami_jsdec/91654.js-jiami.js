const fs=require('fs-extra');const path=require('path');const fileType=require('file-type');const {createFileNode}=require('./create-file-node');const {createFilePath}=require('./utils');const {createContentDigest}=require('gatsby-core-utils');const cacheId=_0x5cdfc2=>'create-file-node-from-buffer-'+_0x5cdfc2;const writeBuffer=(_0x48a12c,_0x463335)=>new Promise((_0x521b37,_0x37fe75)=>{fs['writeFile'](_0x48a12c,_0x463335,_0x14428e=>_0x14428e?_0x37fe75(_0x14428e):_0x521b37());});async function processBufferNode({buffer,hash,cache,createNode,parentNodeId,createNodeId,ext,name}){var _0x50e8cb={'EFeFj':function(_0x4b9d9e,_0x1664e2){return _0x4b9d9e(_0x1664e2);},'phwPX':function(_0x2fea61,_0x2ff368,_0x5a104b,_0x89115f){return _0x2fea61(_0x2ff368,_0x5a104b,_0x89115f);},'AcdIa':function(_0x446417,_0x3febe9,_0x403cd2){return _0x446417(_0x3febe9,_0x403cd2);}};const _0x1ab224=cache['directory'];let _0x5c6e06=await cache['get'](_0x50e8cb['EFeFj'](cacheId,hash));if(!_0x5c6e06){if(typeof ext==='undefined'){const _0x4f2c3f=await fileType['fromBuffer'](buffer);ext=_0x4f2c3f?'.'+_0x4f2c3f['ext']:'.bin';}_0x5c6e06=_0x50e8cb['phwPX'](createFilePath,path['join'](_0x1ab224,hash),name,ext);await fs['ensureDir'](path['dirname'](_0x5c6e06));await writeBuffer(_0x5c6e06,buffer);await cache['set'](_0x50e8cb['EFeFj'](cacheId,hash),_0x5c6e06);}const _0x453f5f=await _0x50e8cb['phwPX'](createFileNode,_0x5c6e06,createNodeId,{});_0x453f5f['internal']['description']='File\x20\x22Buffer<'+hash+'>\x22';_0x453f5f['hash']=hash;_0x453f5f['parent']=parentNodeId;await _0x50e8cb['AcdIa'](createNode,_0x453f5f,{'name':'gatsby-source-filesystem'});return _0x453f5f;}const processingCache={};module['exports']=({buffer,hash,cache,createNode,getCache,parentNodeId=null,createNodeId,ext,name=hash})=>{var _0x1a9cb7={'RMaId':function(_0x123851,_0x16f7e1){return _0x123851===_0x16f7e1;},'CkmRo':function(_0xd54a78,_0x48543e){return _0xd54a78!==_0x48543e;},'wGgpt':'MFVAW','ehKRZ':'epFpg','oOItq':function(_0x28f230,_0x1d30da){return _0x28f230===_0x1d30da;},'wCpOI':'OwgHu','ayYOn':function(_0x514018,_0x1aaa04){return _0x514018(_0x1aaa04);},'vMfgS':function(_0x600410,_0xa178cb){return _0x600410!==_0xa178cb;},'mATOR':'VvudU'};if(typeof createNodeId!=='function'){if(_0x1a9cb7['RMaId']('NEDzj','UGByb')){throw new Error('Neither "cache" or "getCache" was passed. getCache must be function that return Gatsby cache, "cache" must be the Gatsby cache, was '+typeof cache);}else{throw new Error('createNodeId\x20must\x20be\x20a\x20function,\x20was\x20'+typeof createNodeId);}}if(_0x1a9cb7['CkmRo'](typeof createNode,'function')){if(_0x1a9cb7['RMaId'](_0x1a9cb7['wGgpt'],_0x1a9cb7['wGgpt'])){throw new Error('createNode must be a function, was '+typeof createNode);}else{return Promise['reject']('bad buffer: '+buffer);}}if(typeof getCache==='function'){cache=getCache('gatsby-source-filesystem');}if(typeof cache!=='object'){if(_0x1a9cb7['ehKRZ']!=='epFpg'){cache=getCache('gatsby-source-filesystem');}else{throw new Error('Neither\x20\x22cache\x22\x20or\x20\x22getCache\x22\x20was\x20passed.\x20getCache\x20must\x20be\x20function\x20that\x20return\x20Gatsby\x20cache,\x20\x22cache\x22\x20must\x20be\x20the\x20Gatsby\x20cache,\x20was\x20'+typeof cache);}}if(!buffer){return Promise['reject']('bad\x20buffer:\x20'+buffer);}if(!hash){if(_0x1a9cb7['oOItq']('CSdWr',_0x1a9cb7['wCpOI'])){return processingCache[hash];}else{hash=_0x1a9cb7['ayYOn'](createContentDigest,buffer);}}if(processingCache[hash]){if(_0x1a9cb7['vMfgS']('VvudU',_0x1a9cb7['mATOR'])){throw new Error('createNodeId must be a function, was '+typeof createNodeId);}else{return processingCache[hash];}}const _0x24eb21=_0x1a9cb7['ayYOn'](processBufferNode,{'buffer':buffer,'hash':hash,'cache':cache,'createNode':createNode,'parentNodeId':parentNodeId,'createNodeId':createNodeId,'ext':ext,'name':name});processingCache[hash]=_0x24eb21;return processingCache[hash];};