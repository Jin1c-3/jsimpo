import _0x2211a4 from'./worker-executor';function mockWorker({init,postMessage,terminate}={}){var _0x25158b={'YQAYj':function(_0x56f679,_0x2a51b6){return _0x56f679(_0x2a51b6);},'WzPiT':'0|3|2|4|1','UFaDm':function(_0x253f83,_0x8f688){return _0x253f83(_0x8f688);}};global['Worker']=jest['fn'](function(){var _0x51bd44=_0x25158b['WzPiT']['split']('|'),_0x464e44=0x0;while(!![]){switch(_0x51bd44[_0x464e44++]){case'0':_0x25158b['YQAYj'](setImmediate,init&&_0x25158b['UFaDm'](init,this)||(()=>this['onmessage']&&this['onmessage']({'data':{'type':'contentLoaded'}})));continue;case'1':return this;case'2':this['postMessage']=postMessage||function(_0x323e4f){_0x25158b['YQAYj'](setImmediate,()=>this['onmessage']&&this['onmessage']({'data':_0x323e4f+' processed'}));};continue;case'3':this['onmessage']=null;continue;case'4':this['terminate']=terminate||(()=>{});continue;}break;}});}afterEach(()=>{delete global['Worker'];});it('Worker executor should successfully execute one task',async()=>{var _0x405255={'LIfOy':function(_0x437666,_0x41f349){return _0x437666(_0x41f349);},'AOove':function(_0x152d83,_0x17a056){return _0x152d83(_0x17a056);},'aUYJH':'test','pkVaE':function(_0x222921,_0xec8678){return _0x222921(_0xec8678);},'tUjiW':'test\x20processed','lGDwI':function(_0x125e0a,_0x40e5e5){return _0x125e0a(_0x40e5e5);},'NdtMg':function(_0xd6e7cd,_0x513c65){return _0xd6e7cd(_0x513c65);}};const _0x16af7a=jest['fn']();mockWorker({'terminate':_0x16af7a});const _0x4386cd=_0x405255['LIfOy'](_0x2211a4,'test');_0x405255['AOove'](expect,_0x4386cd)['not']['toBeUndefined']();const _0x2f10e=_0x4386cd['execute'](_0x405255['aUYJH']);_0x405255['AOove'](expect,_0x2f10e)['not']['toBeUndefined']();_0x405255['pkVaE'](expect,_0x2f10e['done'])['not']['toBeUndefined']();const _0x16594f=jest['fn']();_0x2f10e['on']('done',_0x16594f);const _0x543e47=jest['fn']();_0x2f10e['on']('error',_0x543e47);await _0x405255['pkVaE'](expect,_0x2f10e['done'])['resolves']['toBe'](_0x405255['tUjiW']);_0x405255['lGDwI'](expect,_0x16594f)['toBeCalledTimes'](0x1);expect(_0x16594f)['toBeCalledWith'](_0x405255['tUjiW']);_0x405255['NdtMg'](expect,_0x543e47)['not']['toBeCalled']();_0x405255['NdtMg'](expect,_0x16af7a)['not']['toBeCalled']();_0x405255['NdtMg'](expect,global['Worker'])['toBeCalledTimes'](0x1);_0x405255['NdtMg'](expect,global['Worker'])['toBeCalledWith']('/js/test.js');});it('Worker executor should successfully execute two tasks in parallel',async()=>{var _0x19d016={'ahyVn':function(_0x1f55fa,_0x51fc13){return _0x1f55fa(_0x51fc13);},'AaZAA':function(_0x41c0d3,_0x18f8a6){return _0x41c0d3(_0x18f8a6);},'pwlnD':'done','KwoiJ':'error','jWQUG':'test1\x20processed','TmkfB':'test2\x20processed','tOXGt':function(_0x5cf505,_0x5eeed2){return _0x5cf505(_0x5eeed2);},'Aupho':function(_0x5a722a,_0x5944ed){return _0x5a722a(_0x5944ed);},'FpeNK':function(_0x3d073c,_0x1de8c3){return _0x3d073c(_0x1de8c3);}};const _0x54694f=jest['fn']();_0x19d016['ahyVn'](mockWorker,{'terminate':_0x54694f});const _0x39157f=_0x19d016['AaZAA'](_0x2211a4,'test');const _0x3e8665=_0x39157f['execute']('test1');const _0x49d67f=jest['fn']();_0x3e8665['on'](_0x19d016['pwlnD'],_0x49d67f);const _0x48f817=jest['fn']();_0x3e8665['on'](_0x19d016['KwoiJ'],_0x48f817);const _0x5b49f3=_0x39157f['execute']('test2');const _0x52963d=jest['fn']();_0x5b49f3['on'](_0x19d016['pwlnD'],_0x52963d);const _0x1f7e5c=jest['fn']();_0x5b49f3['on']('error',_0x1f7e5c);await _0x19d016['AaZAA'](expect,Promise['all']([_0x3e8665['done'],_0x5b49f3['done']]))['resolves']['toEqual']([_0x19d016['jWQUG'],_0x19d016['TmkfB']]);expect(_0x49d67f)['toBeCalledTimes'](0x1);_0x19d016['tOXGt'](expect,_0x49d67f)['toBeCalledWith']('test1 processed');expect(_0x48f817)['not']['toBeCalled']();_0x19d016['Aupho'](expect,_0x52963d)['toBeCalledTimes'](0x1);_0x19d016['Aupho'](expect,_0x52963d)['toBeCalledWith'](_0x19d016['TmkfB']);expect(_0x1f7e5c)['not']['toBeCalled']();_0x19d016['FpeNK'](expect,_0x54694f)['not']['toBeCalled']();_0x19d016['FpeNK'](expect,global['Worker'])['toBeCalledTimes'](0x2);});it('Worker executor should successfully execute 3 tasks in parallel and use two workers',async()=>{var _0x185d10={'AJPcT':function(_0x44d0d1){return _0x44d0d1();},'tGjkU':function(_0x3b1d82,_0x2617ff){return _0x3b1d82(_0x2617ff);},'PBFEd':'test','XiTzb':'test1','gtttB':'test2','olrzA':'test3','bpQdN':function(_0x53e94b,_0xd7720){return _0x53e94b(_0xd7720);},'RUaxg':'test1 processed','Wuwjy':'test2 processed','MAvrO':'test3 processed','lpRiJ':function(_0x8531bc,_0x3017bf){return _0x8531bc(_0x3017bf);}};_0x185d10['AJPcT'](mockWorker);const _0x14a539=_0x185d10['tGjkU'](_0x2211a4,_0x185d10['PBFEd']);const _0x3d65bc=_0x14a539['execute'](_0x185d10['XiTzb']);const _0x418d18=_0x14a539['execute'](_0x185d10['gtttB']);const _0x37914a=_0x14a539['execute'](_0x185d10['olrzA']);await _0x185d10['bpQdN'](expect,Promise['all']([_0x3d65bc['done'],_0x418d18['done'],_0x37914a['done']]))['resolves']['toEqual']([_0x185d10['RUaxg'],_0x185d10['Wuwjy'],_0x185d10['MAvrO']]);_0x185d10['lpRiJ'](expect,global['Worker'])['toBeCalledTimes'](0x2);});it('Worker executor should successfully execute 3 tasks, use 3 workers and terminate each worker',async()=>{var _0x1d578e={'Rigwp':function(_0x45fde7,_0x36937c){return _0x45fde7(_0x36937c);},'dlTNk':function(_0xb7960a,_0x9332b7,_0x580da9){return _0xb7960a(_0x9332b7,_0x580da9);},'BpEhO':'test','vPXJK':'test3','Fbsuq':'test1 processed','exmVB':'test3 processed'};const _0x4b17e2=jest['fn']();_0x1d578e['Rigwp'](mockWorker,{'terminate':_0x4b17e2});const _0x221890=_0x1d578e['dlTNk'](_0x2211a4,_0x1d578e['BpEhO'],{'terminateWorker':!![]});const _0x3f5c89=_0x221890['execute']('test1');const _0x198455=_0x221890['execute']('test2');const _0x1bca82=_0x221890['execute'](_0x1d578e['vPXJK']);await _0x1d578e['Rigwp'](expect,Promise['all']([_0x3f5c89['done'],_0x198455['done'],_0x1bca82['done']]))['resolves']['toEqual']([_0x1d578e['Fbsuq'],'test2 processed',_0x1d578e['exmVB']]);_0x1d578e['Rigwp'](expect,_0x4b17e2)['toBeCalledTimes'](0x3);expect(global['Worker'])['toBeCalledTimes'](0x3);});it('Worker executor should successfully execute 3 tasks in parallel and use 3 workers',async()=>{var _0x140dfe={'PCOxR':function(_0x171f6a){return _0x171f6a();},'VkScw':function(_0x56f3a7,_0x58b6f5,_0x45f5fb){return _0x56f3a7(_0x58b6f5,_0x45f5fb);},'FwbDr':'test','mvelC':'test2','deYyV':'test3','sOZvX':function(_0x5e0f77,_0x49a7a7){return _0x5e0f77(_0x49a7a7);},'MYgqN':'test2 processed','JNBhP':'test3\x20processed','UYava':function(_0x5700fe,_0x2a2bb5){return _0x5700fe(_0x2a2bb5);}};_0x140dfe['PCOxR'](mockWorker);const _0x5c13d4=_0x140dfe['VkScw'](_0x2211a4,_0x140dfe['FwbDr'],{'concurrency':0x3});const _0x22d5f7=_0x5c13d4['execute']('test1');const _0x105e53=_0x5c13d4['execute'](_0x140dfe['mvelC']);const _0x1b4826=_0x5c13d4['execute'](_0x140dfe['deYyV']);await _0x140dfe['sOZvX'](expect,Promise['all']([_0x22d5f7['done'],_0x105e53['done'],_0x1b4826['done']]))['resolves']['toEqual'](['test1 processed',_0x140dfe['MYgqN'],_0x140dfe['JNBhP']]);_0x140dfe['UYava'](expect,global['Worker'])['toBeCalledTimes'](0x3);});it('Worker executor should successfully execute 3 tasks and use 1 worker',async()=>{var _0x14b473={'VWDeM':function(_0x2a16d6,_0x4777c3,_0x3bf828){return _0x2a16d6(_0x4777c3,_0x3bf828);},'aqOfj':'test','fGurK':'test1','DARLK':'test2','zjUyR':function(_0x4522e3,_0x3ab411){return _0x4522e3(_0x3ab411);},'YvGeF':'test1 processed','IFoga':'test3 processed'};mockWorker();const _0x2d7726=_0x14b473['VWDeM'](_0x2211a4,_0x14b473['aqOfj'],{'concurrency':0x1});const _0x588f46=_0x2d7726['execute'](_0x14b473['fGurK']);const _0x11754c=_0x2d7726['execute'](_0x14b473['DARLK']);const _0x12b7ad=_0x2d7726['execute']('test3');await _0x14b473['zjUyR'](expect,Promise['all']([_0x588f46['done'],_0x11754c['done'],_0x12b7ad['done']]))['resolves']['toEqual']([_0x14b473['YvGeF'],'test2\x20processed',_0x14b473['IFoga']]);_0x14b473['zjUyR'](expect,global['Worker'])['toBeCalledTimes'](0x1);});it('Worker executor should reject task',async()=>{var _0x38708f={'ktWLu':function(_0x2f3b09,_0x2efb4d){return _0x2f3b09===_0x2efb4d;},'TvQOh':'FBsmS','tBYnp':'Error on init worker','zYOmX':function(_0x41b3c1,_0x503687){return _0x41b3c1(_0x503687);},'qnTlO':'test','qCAjV':'error'};const _0x1b5a01={'message':_0x38708f['tBYnp']};_0x38708f['zYOmX'](mockWorker,{'init':()=>{if(_0x38708f['ktWLu'](_0x38708f['TvQOh'],_0x38708f['TvQOh'])){throw _0x1b5a01;}else{throw _0x1b5a01;}}});const _0x34433f=_0x2211a4(_0x38708f['qnTlO']);const _0x1d6300=_0x34433f['execute'](_0x38708f['qnTlO']);const _0x32f1f1=jest['fn']();_0x1d6300['on'](_0x38708f['qCAjV'],_0x32f1f1);await _0x38708f['zYOmX'](expect,_0x1d6300['done'])['rejects']['toBe'](_0x1b5a01['message']);expect(_0x32f1f1)['toBeCalledTimes'](0x1);_0x38708f['zYOmX'](expect,_0x32f1f1)['toBeCalledWith'](_0x1b5a01);});it('Worker executor should emit LOG events',async()=>{var _0x560149={'usudR':function(_0x5cc19c,_0x5c462a){return _0x5cc19c<_0x5c462a;},'uYhoK':'LOG','oCuhi':function(_0x42f0ef,_0x21a67f){return _0x42f0ef(_0x21a67f);},'UdANL':function(_0x502f07,_0x3bb633){return _0x502f07(_0x3bb633);},'mKaFn':'test','jrxIH':'error','rLcim':function(_0x2fb89d,_0xcc19b2){return _0x2fb89d(_0xcc19b2);},'vMmlK':'test processed'};_0x560149['UdANL'](mockWorker,{'postMessage':function(_0x2ae092){_0x560149['oCuhi'](setImmediate,()=>{for(let _0x2be51d=0x0;_0x560149['usudR'](_0x2be51d,0x3);_0x2be51d++){this['onmessage']&&this['onmessage']({'data':{'type':_0x560149['uYhoK'],'data':_0x2be51d}});}this['onmessage']&&this['onmessage']({'data':_0x2ae092+' processed'});_0x560149['oCuhi'](setImmediate,()=>this['onmessage']&&this['onmessage']({'data':{'type':'LOG','data':0x3}}));});}});const _0x93f1c7=_0x2211a4(_0x560149['mKaFn']);const _0xc57ccb=_0x93f1c7['execute']('test');const _0x53caa9=jest['fn']();_0xc57ccb['on']('done',_0x53caa9);const _0x2802b8=jest['fn']();_0xc57ccb['on'](_0x560149['jrxIH'],_0x2802b8);const _0x3cef90=jest['fn']();_0xc57ccb['on'](_0x560149['uYhoK'],_0x3cef90);await _0x560149['UdANL'](expect,_0xc57ccb['done'])['resolves']['toBe']('test\x20processed');_0x560149['rLcim'](expect,_0x53caa9)['toBeCalledTimes'](0x1);expect(_0x53caa9)['toBeCalledWith'](_0x560149['vMmlK']);expect(_0x2802b8)['not']['toBeCalled']();_0x560149['rLcim'](expect,_0x3cef90)['toBeCalledTimes'](0x3);for(let _0x535e10=0x0;_0x535e10<0x3;_0x535e10++){_0x560149['rLcim'](expect,_0x3cef90['mock']['calls'][_0x535e10][0x0])['toBe'](_0x535e10);}});it('Worker executor should reject task on timeout',async()=>{var _0x597168={'FFtGZ':function(_0x2192ff,_0x55d6b9){return _0x2192ff(_0x55d6b9);},'CWMuw':'test','wHUfv':'error','MZoNf':function(_0x20106f,_0x24d604){return _0x20106f(_0x24d604);},'BJPEC':function(_0x54635b,_0x73ff04){return _0x54635b(_0x73ff04);}};const _0x41c6c4=jest['fn']();_0x597168['FFtGZ'](mockWorker,{'postMessage':()=>{},'terminate':_0x41c6c4});const _0x210906=_0x597168['FFtGZ'](_0x2211a4,_0x597168['CWMuw']);const _0x4885cb=_0x210906['execute'](_0x597168['CWMuw'],0x0);const _0x29d102=jest['fn']();_0x4885cb['on'](_0x597168['wHUfv'],_0x29d102);await expect(_0x4885cb['done'])['rejects']['toBe']('timeout');_0x597168['MZoNf'](expect,_0x29d102)['toBeCalledTimes'](0x1);_0x597168['BJPEC'](expect,_0x29d102['mock']['calls'][0x0][0x0])['toEqual']({'message':'timeout'});expect(_0x41c6c4)['toBeCalledTimes'](0x1);});it('Worker executor should get worker from specified location',async()=>{var _0x2a56fc={'dPMMi':function(_0x1ad64e){return _0x1ad64e();},'Mqkhp':'test','qlLcn':'/other/location/','vBhrN':'test processed','ERtLv':function(_0x45528e,_0x49f615){return _0x45528e(_0x49f615);},'Mflvp':'/other/location/test.js'};_0x2a56fc['dPMMi'](mockWorker);const _0x2c11f5=_0x2211a4(_0x2a56fc['Mqkhp'],{'location':_0x2a56fc['qlLcn']});const _0x35a8a6=_0x2c11f5['execute']('test');await expect(_0x35a8a6['done'])['resolves']['toBe'](_0x2a56fc['vBhrN']);_0x2a56fc['ERtLv'](expect,global['Worker'])['toBeCalledTimes'](0x1);_0x2a56fc['ERtLv'](expect,global['Worker'])['toBeCalledWith'](_0x2a56fc['Mflvp']);});