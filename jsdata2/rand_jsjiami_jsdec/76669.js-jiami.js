import{expect}from'chai';import{getCredentials,api,request,credentials}from'../../data/api-data.js';import{password}from'../../data/user.js';import{createUser,login as _0x2ea02a}from'../../data/users.helper';describe('licenses',function(){var BBphZY={'PwtRd':function(callee){return callee();},'QMiKT':function(callee,param1){return callee(param1);},'bCrEx':function(callee,param1){return callee(param1);},'Phgyw':'error','ApjQs':'message','JdeON':function(x,y){return x!==y;},'vqgLg':'Content-Type','CsLCa':'status','hkjZE':'JTmbD','burHe':function(callee,param1){return callee(param1);},'XIsAr':function(callee,param1){return callee(param1);},'daHlN':function(callee,param1,param2){return callee(param1,param2);},'IEOfD':'should\x20fail\x20if\x20not\x20logged\x20in','zhmMz':'should\x20fail\x20if\x20license\x20is\x20invalid','huoYP':function(callee,param1){return callee(param1);},'tmTiw':'success','fBxXd':'unauthorized','ZisKU':function(callee,param1){return callee(param1);},'epjtK':'application/json','aSpiq':'FTaUW','ReMqZ':'XEhyA','BMxDX':function(callee,param1){return callee(param1);},'bYeFZ':'licenses','HpnRV':'array','WCYit':'SUmpF','wBxIR':function(callee,param1){return callee(param1);},'culWl':function(callee,param1,param2){return callee(param1,param2);},'NvTZc':function(callee,param1,param2){return callee(param1,param2);},'QQYRd':'should return licenses if user is logged in and is authorized','siLUc':'[/licenses.add]','xKtPD':'[/licenses.get]'};this['retries'](0x0);BBphZY['wBxIR'](before,done=>getCredentials(done));BBphZY['NvTZc'](describe,BBphZY['siLUc'],()=>{var nZeDBf={'wAdmB':function(callee,param1){return BBphZY['QMiKT'](callee,param1);},'EMjBK':'success','NITbD':function(callee,param1){return BBphZY['bCrEx'](callee,param1);},'ZFpej':BBphZY['Phgyw'],'aEMZE':BBphZY['ApjQs'],'DxVsE':function(x,y){return BBphZY['JdeON'](x,y);},'drcUZ':'SfEVa','WRyGp':BBphZY['vqgLg'],'LIdcw':'application/json','AzvZN':'licenses.add','iocar':BBphZY['CsLCa'],'QyWTH':BBphZY['hkjZE'],'wUDJs':function(callee,param1){return BBphZY['burHe'](callee,param1);}};let unauthorizedUserCredentials;BBphZY['XIsAr'](before,async()=>{const createdUser=await BBphZY['PwtRd'](createUser);unauthorizedUserCredentials=await _0x2ea02a(createdUser['username'],password);});BBphZY['daHlN'](it,BBphZY['IEOfD'],done=>{var QQdwTB={'FuJJf':function(callee,param1){return nZeDBf['NITbD'](callee,param1);},'bnKqo':nZeDBf['ZFpej'],'PWGfu':nZeDBf['aEMZE']};if(nZeDBf['DxVsE'](nZeDBf['drcUZ'],'ERWNM')){request['post'](api('licenses.add'))['send']({'license':''})['expect'](nZeDBf['WRyGp'],nZeDBf['LIdcw'])['expect'](0x191)['expect'](res=>{QQdwTB['FuJJf'](expect,res['body'])['to']['have']['property']('status',QQdwTB['bnKqo']);expect(res['body'])['to']['have']['property'](QQdwTB['PWGfu']);})['end'](done);}else{nZeDBf['wAdmB'](expect,res['body'])['to']['have']['property'](nZeDBf['EMjBK'],![]);nZeDBf['NITbD'](expect,res['body'])['to']['have']['property'](nZeDBf['ZFpej']);}});BBphZY['daHlN'](it,'should fail if user is unauthorized',done=>{request['post'](nZeDBf['NITbD'](api,nZeDBf['AzvZN']))['set'](unauthorizedUserCredentials)['send']({'license':''})['expect']('Content-Type',nZeDBf['LIdcw'])['expect'](0x193)['expect'](res=>{expect(res['body'])['to']['have']['property'](nZeDBf['EMjBK'],![]);expect(res['body'])['to']['have']['property']('error','unauthorized');})['end'](done);});it(BBphZY['zhmMz'],done=>{var kUCsHt={'DkyJi':function(callee,param1){return nZeDBf['NITbD'](callee,param1);},'eiWje':nZeDBf['iocar'],'SZjbg':'message','ttkTq':function(x,y){return x!==y;},'ABpLO':nZeDBf['QyWTH'],'PrwMK':nZeDBf['EMjBK'],'jKlaY':function(callee,param1){return nZeDBf['NITbD'](callee,param1);},'SmncU':nZeDBf['ZFpej']};request['post'](nZeDBf['wUDJs'](api,'licenses.add'))['set'](credentials)['send']({'license':''})['expect']('Content-Type',nZeDBf['LIdcw'])['expect'](0x190)['expect'](res=>{var Vjnfcn={'yEkfj':function(callee,param1){return kUCsHt['DkyJi'](callee,param1);},'IUnxf':kUCsHt['eiWje'],'RQKeU':'error','VCflO':function(callee,param1){return callee(param1);},'TbNJi':kUCsHt['SZjbg']};if(kUCsHt['ttkTq']('NCnds',kUCsHt['ABpLO'])){expect(res['body'])['to']['have']['property'](kUCsHt['PrwMK'],![]);kUCsHt['jKlaY'](expect,res['body'])['to']['have']['property'](kUCsHt['SmncU']);}else{Vjnfcn['yEkfj'](expect,res['body'])['to']['have']['property'](Vjnfcn['IUnxf'],Vjnfcn['RQKeU']);Vjnfcn['VCflO'](expect,res['body'])['to']['have']['property'](Vjnfcn['TbNJi']);}})['end'](done);});});BBphZY['NvTZc'](describe,BBphZY['xKtPD'],()=>{var lAicur={'LQXEe':function(callee,param1){return BBphZY['ZisKU'](callee,param1);},'Rpcuz':'error','xPIPl':'message','EBdZT':function(callee,param1){return callee(param1);},'iMhnv':'licenses.get','acgaH':BBphZY['epjtK'],'uEurW':'licenses.add','CmCyH':BBphZY['vqgLg'],'ZbPGP':function(x,y){return BBphZY['JdeON'](x,y);},'lsoyr':BBphZY['aSpiq'],'QWdcP':'cuFez','uTiLZ':'success','LrUOi':'unauthorized','TYaCg':BBphZY['CsLCa'],'qNjha':BBphZY['ReMqZ'],'BBFjO':function(callee,param1){return BBphZY['BMxDX'](callee,param1);},'lGJeU':BBphZY['bYeFZ'],'oNPox':BBphZY['HpnRV'],'pbTcx':function(x,y){return x!==y;},'xwQwp':BBphZY['WCYit'],'Hdisc':function(callee,param1){return BBphZY['wBxIR'](callee,param1);}};let unauthorizedUserCredentials;BBphZY['wBxIR'](before,async()=>{var PiOnZY={'pdNBt':function(callee,param1){return BBphZY['huoYP'](callee,param1);},'iwfWC':BBphZY['tmTiw'],'KqzkW':BBphZY['Phgyw'],'hejTq':BBphZY['fBxXd']};if('CFHCC'!=='CFHCC'){PiOnZY['pdNBt'](expect,res['body'])['to']['have']['property'](PiOnZY['iwfWC'],![]);expect(res['body'])['to']['have']['property'](PiOnZY['KqzkW'],PiOnZY['hejTq']);}else{const createdUser=await createUser();unauthorizedUserCredentials=await _0x2ea02a(createdUser['username'],password);}});BBphZY['culWl'](it,BBphZY['IEOfD'],done=>{request['get'](lAicur['EBdZT'](api,lAicur['iMhnv']))['expect']('Content-Type',lAicur['acgaH'])['expect'](0x191)['expect'](res=>{lAicur['LQXEe'](expect,res['body'])['to']['have']['property']('status',lAicur['Rpcuz']);lAicur['LQXEe'](expect,res['body'])['to']['have']['property'](lAicur['xPIPl']);})['end'](done);});it('should fail if user is unauthorized',done=>{var xMTpoM={'xwYQM':lAicur['TYaCg'],'vhDBt':function(callee,param1){return lAicur['EBdZT'](callee,param1);},'nUAKZ':lAicur['CmCyH'],'fHpNi':lAicur['acgaH']};if('rzmVE'===lAicur['qNjha']){var nVBJCT={'VvyZk':function(callee,param1){return callee(param1);},'DGUhC':'success','wlDuw':'error'};request['post'](lAicur['EBdZT'](api,lAicur['uEurW']))['set'](credentials)['send']({'license':''})['expect'](lAicur['CmCyH'],lAicur['acgaH'])['expect'](0x190)['expect'](_0x4182b5=>{nVBJCT['VvyZk'](expect,_0x4182b5['body'])['to']['have']['property'](nVBJCT['DGUhC'],![]);nVBJCT['VvyZk'](expect,_0x4182b5['body'])['to']['have']['property'](nVBJCT['wlDuw']);})['end'](done);}else{request['get'](lAicur['BBFjO'](api,lAicur['iMhnv']))['set'](unauthorizedUserCredentials)['expect']('Content-Type','application/json')['expect'](0x193)['expect'](res=>{if(lAicur['ZbPGP'](lAicur['lsoyr'],lAicur['QWdcP'])){lAicur['EBdZT'](expect,res['body'])['to']['have']['property'](lAicur['uTiLZ'],![]);expect(res['body'])['to']['have']['property'](lAicur['Rpcuz'],lAicur['LrUOi']);}else{var LmaTtE={'psGTV':xMTpoM['xwYQM'],'yYXAi':'error','KAzgA':function(callee,param1){return xMTpoM['vhDBt'](callee,param1);}};request['get'](api('licenses.get'))['expect'](xMTpoM['nUAKZ'],xMTpoM['fHpNi'])['expect'](0x191)['expect'](_0x74bf1=>{expect(_0x74bf1['body'])['to']['have']['property'](LmaTtE['psGTV'],LmaTtE['yYXAi']);LmaTtE['KAzgA'](expect,_0x74bf1['body'])['to']['have']['property']('message');})['end'](done);}})['end'](done);}});BBphZY['NvTZc'](it,BBphZY['QQYRd'],done=>{var uobKNM={'apOhP':function(callee,param1){return lAicur['BBFjO'](callee,param1);},'dUsFt':lAicur['lGJeU']};if(lAicur['pbTcx'](lAicur['xwQwp'],lAicur['xwQwp'])){lAicur['BBFjO'](expect,res['body'])['to']['have']['property'](lAicur['uTiLZ'],!![]);expect(res['body'])['to']['have']['property'](lAicur['lGJeU'])['and']['to']['be']['an'](lAicur['oNPox']);}else{request['get'](lAicur['Hdisc'](api,lAicur['iMhnv']))['set'](credentials)['expect'](0xc8)['expect'](res=>{expect(res['body'])['to']['have']['property']('success',!![]);uobKNM['apOhP'](expect,res['body'])['to']['have']['property'](uobKNM['dUsFt'])['and']['to']['be']['an']('array');})['end'](done);}});});});