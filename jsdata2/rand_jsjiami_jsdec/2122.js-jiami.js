import{log}from'../logger';import _0x2c9504 from'graphlib';export let clusterDb={};let decendants={};let parents={};export const clear=()=>{decendants={};parents={};clusterDb={};};const isDecendant=(id,ancenstorId)=>{var Vnidla={'qVclQ':'In isDecendant'};log['trace'](Vnidla['qVclQ'],ancenstorId,'\x20',id,' = ',decendants[ancenstorId]['indexOf'](id)>=0x0);if(decendants[ancenstorId]['indexOf'](id)>=0x0)return!![];return![];};const edgeInCluster=(edge,clusterId)=>{var aodyLH={'HOaqb':'2|3|6|7|9|10|1|5|0|4|8','xqUYr':function(callee,param1,param2){return callee(param1,param2);},'RaZNg':function(x,y){return x>=y;},'niReQ':'Decendants of ','siaYh':' is ','UhrNN':'Edge\x20is\x20','VtqKg':function(x,y){return x===y;},'ParlN':'Tilt, ','hQrEW':',not in decendants','wsbGU':'Here '};var mhBjyT=aodyLH['HOaqb']['split']('|'),gXmQqi=0x0;while(!![]){switch(mhBjyT[gXmQqi++]){case'0':if(aodyLH['xqUYr'](isDecendant,edge['w'],clusterId))return!![];continue;case'1':if(aodyLH['RaZNg'](decendants[clusterId]['indexOf'](edge['v']),0x0))return!![];continue;case'2':log['info'](aodyLH['niReQ'],clusterId,aodyLH['siaYh'],decendants[clusterId]);continue;case'3':log['info'](aodyLH['UhrNN'],edge);continue;case'4':if(decendants[clusterId]['indexOf'](edge['w'])>=0x0)return!![];continue;case'5':if(aodyLH['xqUYr'](isDecendant,edge['v'],clusterId))return!![];continue;case'6':if(edge['v']===clusterId)return![];continue;case'7':if(aodyLH['VtqKg'](edge['w'],clusterId))return![];continue;case'8':return![];case'9':if(!decendants[clusterId]){log['debug'](aodyLH['ParlN'],clusterId,aodyLH['hQrEW']);return![];}continue;case'10':log['info'](aodyLH['wsbGU']);continue;}break;}};const copy=(clusterId,graph,newGraph,rootId)=>{var UUBcUd={'UcIMI':function(callee,param1,param2){return callee(param1,param2);},'LVJlD':function(x,y){return x===y;},'kWQKu':'Edges: ','hMgxo':function(x,y){return x<y;},'nUnDC':function(x,y){return x>y;},'MfuWY':'The node ','Pilia':function(x,y){return x!==y;},'RGKDN':'Edge','pSiaW':function(callee,param1,param2){return callee(param1,param2);},'yecYp':'Copying as ','XdMWY':'Skipping copy of edge ','dkriX':'-->','VoJXc':' rootId: ','aMxDJ':'ZooDp','EzGva':function(callee,param1,param2,param3,param4){return callee(param1,param2,param3,param4);},'wnZKT':' to ','GicQy':' with parent ','mhLMj':function(x,y){return x!==y;},'iMOBr':function(x,y){return x===y;},'hhdNo':'gHsdM','odBVT':'Setting parent','Slusn':'root','rbUZd':'data','eQbig':'Not\x20Setting\x20parent\x20for\x20node=','xVvSV':'cluster!==rootId','rFuIu':function(x,y){return x!==y;},'AutjG':'Copying Edges','ZmHxi':'Removing node','jGNQL':'ZDtrT','mDCoD':'Copying (nodes) clusterId'};log['warn']('Copying children of ',clusterId,'root',rootId,UUBcUd['rbUZd'],graph['node'](clusterId),rootId);const nodes=graph['children'](clusterId)||[];if(UUBcUd['rFuIu'](clusterId,rootId)){if(UUBcUd['jGNQL']==='NpqdC'){if(UUBcUd['LVJlD'](nodes['length'],0x0))return[];let _0x34f0a6=Object['assign'](nodes);nodes['forEach'](_0x22abc7=>{const _0x4669dd=graph['children'](_0x22abc7);const _0x5cc1a4=UUBcUd['UcIMI'](sorter,graph,_0x4669dd);_0x34f0a6=_0x34f0a6['concat'](_0x5cc1a4);});return _0x34f0a6;}else{nodes['push'](clusterId);}}log['warn'](UUBcUd['mDCoD'],clusterId,'nodes',nodes);nodes['forEach'](node=>{if(UUBcUd['aMxDJ']!==UUBcUd['aMxDJ']){nodes['push'](clusterId);}else{if(UUBcUd['nUnDC'](graph['children'](node)['length'],0x0)){UUBcUd['EzGva'](copy,node,graph,newGraph,rootId);}else{const data=graph['node'](node);log['info']('cp ',node,UUBcUd['wnZKT'],rootId,UUBcUd['GicQy'],clusterId);newGraph['setNode'](node,data);if(UUBcUd['mhLMj'](rootId,graph['parent'](node))){if(UUBcUd['iMOBr'](UUBcUd['hhdNo'],'gHsdM')){log['warn'](UUBcUd['odBVT'],node,graph['parent'](node));newGraph['setParent'](node,graph['parent'](node));}else{const _0x2bbd69=graph['edges']();log['trace'](UUBcUd['kWQKu'],_0x2bbd69);for(let _0x15bbbf=0x0;UUBcUd['hMgxo'](_0x15bbbf,_0x2bbd69['length']);_0x15bbbf++){if(UUBcUd['nUnDC'](graph['children'](_0x2bbd69[_0x15bbbf]['v'])['length'],0x0)){log['trace'](UUBcUd['MfuWY'],_0x2bbd69[_0x15bbbf]['v'],'\x20is\x20part\x20of\x20and\x20edge\x20even\x20though\x20it\x20has\x20children');return![];}if(UUBcUd['nUnDC'](graph['children'](_0x2bbd69[_0x15bbbf]['w'])['length'],0x0)){log['trace'](UUBcUd['MfuWY'],_0x2bbd69[_0x15bbbf]['w'],'\x20is\x20part\x20of\x20and\x20edge\x20even\x20though\x20it\x20has\x20children');return![];}}return!![];}}if(UUBcUd['mhLMj'](clusterId,rootId)&&node!==clusterId){log['debug']('Setting parent',node,clusterId);newGraph['setParent'](node,clusterId);}else{log['info']('In\x20copy\x20',clusterId,UUBcUd['Slusn'],rootId,UUBcUd['rbUZd'],graph['node'](clusterId),rootId);log['debug'](UUBcUd['eQbig'],node,UUBcUd['xVvSV'],UUBcUd['rFuIu'](clusterId,rootId),'node!==clusterId',node!==clusterId);}const edges=graph['edges'](node);log['debug'](UUBcUd['AutjG'],edges);edges['forEach'](edge=>{if(UUBcUd['Pilia']('PTpQV','PTpQV')){return{};}else{log['info'](UUBcUd['RGKDN'],edge);const data=graph['edge'](edge['v'],edge['w'],edge['name']);log['info']('Edge\x20data',data,rootId);try{if(UUBcUd['pSiaW'](edgeInCluster,edge,rootId)){log['info'](UUBcUd['yecYp'],edge['v'],edge['w'],data,edge['name']);newGraph['setEdge'](edge['v'],edge['w'],data,edge['name']);log['info']('newGraph edges ',newGraph['edges'](),newGraph['edge'](newGraph['edges']()[0x0]));}else{log['info'](UUBcUd['XdMWY'],edge['v'],UUBcUd['dkriX'],edge['w'],UUBcUd['VoJXc'],rootId,' clusterId:',clusterId);}}catch(_0x3c651d){log['error'](_0x3c651d);}}});}log['debug'](UUBcUd['ZmHxi'],node);graph['removeNode'](node);}});};export const extractDecendants=(id,graph)=>{var TubTHC={'GvSaZ':function(x,y){return x<y;}};const children=graph['children'](id);let res=[]['concat'](children);for(let i=0x0;TubTHC['GvSaZ'](i,children['length']);i++){parents[children[i]]=id;res=res['concat'](extractDecendants(children[i],graph));}return res;};export const validate=graph=>{var xbcSRj={'BZDta':'Setting parent','OqvLw':'Edges: ','MvXtn':function(x,y){return x>y;},'HWPjr':' is part of and edge even though it has children'};const edges=graph['edges']();log['trace'](xbcSRj['OqvLw'],edges);for(let i=0x0;i<edges['length'];i++){if(xbcSRj['MvXtn'](graph['children'](edges[i]['v'])['length'],0x0)){log['trace']('The\x20node\x20',edges[i]['v'],' is part of and edge even though it has children');return![];}if(xbcSRj['MvXtn'](graph['children'](edges[i]['w'])['length'],0x0)){if('eEmMF'!=='eEmMF'){log['debug'](xbcSRj['BZDta'],node,clusterId);newGraph['setParent'](node,clusterId);}else{log['trace']('The\x20node\x20',edges[i]['w'],xbcSRj['HWPjr']);return![];}}}return!![];};export const findNonClusterChild=(id,graph)=>{var LkAphb={'Qjjex':'In\x20isDecendant','hiVMC':'\x20=\x20','PvLFd':function(x,y){return x>=y;},'NBkPD':'Done,\x20no\x20node\x20has\x20children','DuqgT':'Cluster identified','SsyxN':' Replacement id in edges: ','YemgW':function(callee,param1,param2){return callee(param1,param2);},'Eiusb':function(callee,param1,param2){return callee(param1,param2);},'HSuIm':function(x,y){return x<y;},'UqAIB':function(x,y){return x!==y;},'tFjpi':'EIHNW','ydbpD':'This is a valid node','upUZS':function(x,y){return x===y;},'PyVDB':'DqZwJ','sTZKh':function(x,y){return x===y;},'KXXus':'Found replacement for'};log['trace']('Searching',id);const children=graph['children'](id);log['trace']('Searching children of id ',id,children);if(LkAphb['HSuIm'](children['length'],0x1)){if(LkAphb['UqAIB'](LkAphb['tFjpi'],'EIHNW')){log['trace'](LkAphb['Qjjex'],ancenstorId,'\x20',id,LkAphb['hiVMC'],LkAphb['PvLFd'](decendants[ancenstorId]['indexOf'](id),0x0));if(decendants[ancenstorId]['indexOf'](id)>=0x0)return!![];return![];}else{log['trace'](LkAphb['ydbpD'],id);return id;}}for(let i=0x0;LkAphb['HSuIm'](i,children['length']);i++){if(LkAphb['upUZS']('DqZwJ',LkAphb['PyVDB'])){const _id=LkAphb['Eiusb'](findNonClusterChild,children[i],graph);if(_id){if(LkAphb['sTZKh']('KNmYO','KNmYO')){log['trace'](LkAphb['KXXus'],id,' => ',_id);return _id;}else{log['debug'](LkAphb['NBkPD'],graph['nodes']());return;}}}else{log['warn'](LkAphb['DuqgT'],id,LkAphb['SsyxN'],LkAphb['YemgW'](findNonClusterChild,id,graph));decendants[id]=extractDecendants(id,graph);clusterDb[id]={'id':LkAphb['Eiusb'](findNonClusterChild,id,graph),'clusterData':graph['node'](id)};}}};const getAnchorId=id=>{var iaCoTR={'ZGHvK':function(callee,param1,param2,param3,param4){return callee(param1,param2,param3,param4);},'HayWN':function(x,y){return x<y;},'JSvyT':function(callee,param1,param2){return callee(param1,param2);},'cfKoq':function(x,y){return x!==y;},'KkZvk':'DjUNx','urRgJ':'fiFqy','ybQYZ':function(x,y){return x===y;},'VGkrO':'pCSnZ','ZyjVY':'BJOrG'};if(!clusterDb[id]){return id;}if(!clusterDb[id]['externalConnections']){if(iaCoTR['cfKoq'](iaCoTR['KkZvk'],iaCoTR['urRgJ'])){return id;}else{iaCoTR['ZGHvK'](copy,node,graph,newGraph,rootId);}}if(clusterDb[id]){if(iaCoTR['ybQYZ'](iaCoTR['VGkrO'],iaCoTR['ZyjVY'])){const _0xcac676=graph['children'](id);let _0x52f145=[]['concat'](_0xcac676);for(let _0x2e448e=0x0;iaCoTR['HayWN'](_0x2e448e,_0xcac676['length']);_0x2e448e++){parents[_0xcac676[_0x2e448e]]=id;_0x52f145=_0x52f145['concat'](iaCoTR['JSvyT'](extractDecendants,_0xcac676[_0x2e448e],graph));}return _0x52f145;}else{return clusterDb[id]['id'];}}return id;};export const adjustClustersAndEdges=(graph,depth)=>{var PFWmnp={'yUWxj':'Cluster ** ','SwpuU':' **not meeting the criteria !externalConnections:','bmFCs':function(x,y){return x===y;},'BrsUU':'tZoug','LsmfN':'eWdOy','nJmSn':'Cluster identified','TilHq':' Replacement id in edges: ','aIgAq':function(callee,param1,param2){return callee(param1,param2);},'bDFMF':function(callee,param1,param2){return callee(param1,param2);},'wJoBM':'Fixing dir','uephq':'Old\x20graph\x20before\x20copy','WzUZG':'New graph after copy node: (','xlVmj':'Old graph after copy','wvqbf':'iXwum','AeDxS':function(callee,param1,param2){return callee(param1,param2);},'buLik':function(callee,param1,param2){return callee(param1,param2);},'KUUvy':function(x,y){return x^y;},'FJslL':function(x,y){return x!==y;},'RqPlO':'zwWbB','NfvUB':'Oamtt','fwFZK':'\x20leaves\x20cluster\x20','QWGuG':function(x,y){return x>y;},'sKSzo':function(x,y){return x!==y;},'LDtxp':'knETj','xohFr':function(x,y){return x+y;},'amVnU':function(x,y){return x+y;},'kTgId':'Edge ','UasQo':' -> ','VIsZo':function(x,y){return x+y;},'WEHZS':'Translateing: ','vPlQA':'4|2|3|6|1|5|7|0','mWiaQ':function(callee,param1){return callee(param1);},'tixLJ':'Fixing\x20and\x20trixing\x20-\x20removing\x20XXX','EFQJu':'Fix\x20Replacing\x20with\x20XXX','Reyaw':function(x,y){return x>y;},'yeTfx':'Adjusted Graph'};if(!graph||PFWmnp['Reyaw'](depth,0xa)){log['debug']('Opting\x20out,\x20no\x20graph\x20');return;}else{log['debug']('Opting in, graph ');}graph['nodes']()['forEach'](function(id){const children=graph['children'](id);if(children['length']>0x0){if(PFWmnp['bmFCs'](PFWmnp['BrsUU'],PFWmnp['LsmfN'])){log['warn'](PFWmnp['yUWxj'],node,PFWmnp['SwpuU'],!clusterDb[node]['externalConnections'],' no parent: ',!graph['parent'](node),'\x20children\x20',graph['children'](node)&&graph['children'](node)['length']>0x0,graph['children']('D'),depth);log['debug'](clusterDb);}else{log['warn'](PFWmnp['nJmSn'],id,PFWmnp['TilHq'],PFWmnp['aIgAq'](findNonClusterChild,id,graph));decendants[id]=extractDecendants(id,graph);clusterDb[id]={'id':PFWmnp['bDFMF'](findNonClusterChild,id,graph),'clusterData':graph['node'](id)};}}});graph['nodes']()['forEach'](function(id){const children=graph['children'](id);const edges=graph['edges']();if(PFWmnp['QWGuG'](children['length'],0x0)){log['debug'](PFWmnp['nJmSn'],id,decendants);edges['forEach'](edge=>{var bAlDak={'uXaDe':PFWmnp['wJoBM'],'ynoKl':PFWmnp['uephq'],'svxkz':PFWmnp['WzUZG'],'aMdzB':PFWmnp['xlVmj']};if(PFWmnp['wvqbf']!==PFWmnp['wvqbf']){return id;}else{if(edge['v']!==id&&edge['w']!==id){const d1=PFWmnp['AeDxS'](isDecendant,edge['v'],id);const d2=PFWmnp['buLik'](isDecendant,edge['w'],id);if(PFWmnp['KUUvy'](d1,d2)){if(PFWmnp['FJslL'](PFWmnp['RqPlO'],PFWmnp['NfvUB'])){log['warn']('Edge: ',edge,PFWmnp['fwFZK'],id);log['warn']('Decendants of XXX ',id,':\x20',decendants[id]);clusterDb[id]['externalConnections']=!![];}else{log['warn']('Cluster without external connections, without a parent and with children',node,depth);const _0x1ace1d=graph['graph']();let _0x34f70e=_0x1ace1d['rankdir']==='TB'?'LR':'TB';if(clusterDb[node]){if(clusterDb[node]['clusterData']&&clusterDb[node]['clusterData']['dir']){_0x34f70e=clusterDb[node]['clusterData']['dir'];log['warn'](bAlDak['uXaDe'],clusterDb[node]['clusterData']['dir'],_0x34f70e);}}const _0xf9ee89=new _0x2c9504['Graph']({'multigraph':!![],'compound':!![]})['setGraph']({'rankdir':_0x34f70e,'nodesep':0x32,'ranksep':0x32,'marginx':0x8,'marginy':0x8})['setDefaultEdgeLabel'](function(){return{};});log['warn'](bAlDak['ynoKl'],_0x2c9504['json']['write'](graph));copy(node,graph,_0xf9ee89,node);graph['setNode'](node,{'clusterNode':!![],'id':node,'clusterData':clusterDb[node]['clusterData'],'labelText':clusterDb[node]['labelText'],'graph':_0xf9ee89});log['warn'](bAlDak['svxkz'],node,')',_0x2c9504['json']['write'](_0xf9ee89));log['debug'](bAlDak['aMdzB'],_0x2c9504['json']['write'](graph));}}}}});}else{log['debug']('Not\x20a\x20cluster\x20',id,decendants);}});graph['edges']()['forEach'](function(e){if(PFWmnp['sKSzo']('IwJZm',PFWmnp['LDtxp'])){const edge=graph['edge'](e);log['warn'](PFWmnp['xohFr'](PFWmnp['xohFr'](PFWmnp['xohFr'](PFWmnp['amVnU'](PFWmnp['kTgId'],e['v'])+PFWmnp['UasQo'],e['w']),':\x20'),JSON['stringify'](e)));log['warn'](PFWmnp['amVnU'](PFWmnp['VIsZo'](PFWmnp['kTgId']+e['v']+PFWmnp['UasQo'],e['w'])+':\x20',JSON['stringify'](graph['edge'](e))));let v=e['v'];let w=e['w'];log['warn']('Fix XXX',clusterDb,'ids:',e['v'],e['w'],PFWmnp['WEHZS'],clusterDb[e['v']],' --- ',clusterDb[e['w']]);if(clusterDb[e['v']]||clusterDb[e['w']]){var zyOIRO=PFWmnp['vPlQA']['split']('|'),phZuxx=0x0;while(!![]){switch(zyOIRO[phZuxx++]){case'0':graph['setEdge'](v,w,edge,e['name']);continue;case'1':if(PFWmnp['sKSzo'](v,e['v']))edge['fromCluster']=e['v'];continue;case'2':v=PFWmnp['mWiaQ'](getAnchorId,e['v']);continue;case'3':w=PFWmnp['mWiaQ'](getAnchorId,e['w']);continue;case'4':log['warn'](PFWmnp['tixLJ'],e['v'],e['w'],e['name']);continue;case'5':if(PFWmnp['sKSzo'](w,e['w']))edge['toCluster']=e['w'];continue;case'6':graph['removeEdge'](e['v'],e['w'],e['name']);continue;case'7':log['warn'](PFWmnp['EFQJu'],v,w,e['name']);continue;}break;}}}else{log['error']('Bailing\x20out');return;}});log['warn'](PFWmnp['yeTfx'],_0x2c9504['json']['write'](graph));PFWmnp['buLik'](extractor,graph,0x0);log['trace'](clusterDb);};export const extractor=(graph,depth)=>{var nQbYla={'eYOHI':function(callee,param1,param2){return callee(param1,param2);},'uKqiS':function(x,y){return x^y;},'uGetY':'Edge:\x20','orNZJ':'Decendants\x20of\x20XXX\x20','idXlM':'Searching','Sxqmr':'Searching\x20children\x20of\x20id\x20','tkiEW':function(x,y){return x<y;},'gBZxT':'This\x20is\x20a\x20valid\x20node','fFpAR':function(callee,param1,param2){return callee(param1,param2);},'mFzHu':' => ','GDQxw':'Found replacement for','Iwovn':'-->','OTvdZ':' rootId: ','CSMiF':'\x20clusterId:','OKrSS':'Skipping copy of edge ','iibfK':'psnRJ','oLXrT':function(x,y){return x>y;},'mnStx':'extractor - ','OsCpy':'Bailing out','wVzQl':function(x,y){return x===y;},'AHBKk':'eRTNg','CMXBX':'MwNtw','XVfnq':function(x,y){return x<y;},'gpfDF':'Extracting node','ZdWRg':function(x,y){return x>y;},'Nmtam':function(x,y){return x!==y;},'Sgcai':'RYlNi','Qvpji':'vBJSJ','tZnpE':'Cluster without external connections, without a parent and with children','GhUZx':'ngLru','EdSAE':'lQwYS','vEJHj':'Fixing dir','uTRWm':'Old\x20graph\x20before\x20copy','KayKT':'New\x20graph\x20after\x20copy\x20node:\x20(','pxAMJ':'\x20**not\x20meeting\x20the\x20criteria\x20!externalConnections:','lHWZd':' no parent: ','bqBlp':' children ','QYyWT':' Now next level','FmLPC':function(x,y){return x+y;}};log['warn'](nQbYla['mnStx'],depth,_0x2c9504['json']['write'](graph),graph['children']('D'));if(depth>0xa){log['error'](nQbYla['OsCpy']);return;}let nodes=graph['nodes']();let hasChildren=![];for(let i=0x0;i<nodes['length'];i++){if(nQbYla['wVzQl'](nQbYla['AHBKk'],'pdUik')){const _0x14ad04=nQbYla['eYOHI'](isDecendant,edge['v'],id);const _0x1d3bd3=nQbYla['eYOHI'](isDecendant,edge['w'],id);if(nQbYla['uKqiS'](_0x14ad04,_0x1d3bd3)){log['warn'](nQbYla['uGetY'],edge,' leaves cluster ',id);log['warn'](nQbYla['orNZJ'],id,':\x20',decendants[id]);clusterDb[id]['externalConnections']=!![];}}else{const node=nodes[i];const children=graph['children'](node);hasChildren=hasChildren||nQbYla['oLXrT'](children['length'],0x0);}}if(!hasChildren){if(nQbYla['CMXBX']!==nQbYla['CMXBX']){log['trace'](nQbYla['idXlM'],id);const _0x53c802=graph['children'](id);log['trace'](nQbYla['Sxqmr'],id,_0x53c802);if(nQbYla['tkiEW'](_0x53c802['length'],0x1)){log['trace'](nQbYla['gBZxT'],id);return id;}for(let _0x462afa=0x0;nQbYla['tkiEW'](_0x462afa,_0x53c802['length']);_0x462afa++){const _0x19289e=nQbYla['fFpAR'](findNonClusterChild,_0x53c802[_0x462afa],graph);if(_0x19289e){log['trace']('Found\x20replacement\x20for',id,nQbYla['mFzHu'],_0x19289e);return _0x19289e;}}}else{log['debug']('Done, no node has children',graph['nodes']());return;}}log['debug']('Nodes = ',nodes,depth);for(let i=0x0;nQbYla['XVfnq'](i,nodes['length']);i++){const node=nodes[i];log['debug'](nQbYla['gpfDF'],node,clusterDb,clusterDb[node]&&!clusterDb[node]['externalConnections'],!graph['parent'](node),graph['node'](node),graph['children']('D'),'\x20Depth\x20',depth);if(!clusterDb[node]){log['debug']('Not a cluster',node,depth);}else if(!clusterDb[node]['externalConnections']&&graph['children'](node)&&nQbYla['ZdWRg'](graph['children'](node)['length'],0x0)){if(nQbYla['Nmtam'](nQbYla['Sgcai'],nQbYla['Qvpji'])){log['warn'](nQbYla['tZnpE'],node,depth);const graphSettings=graph['graph']();let dir=graphSettings['rankdir']==='TB'?'LR':'TB';if(clusterDb[node]){if(nQbYla['GhUZx']!==nQbYla['GhUZx']){log['trace'](nQbYla['GDQxw'],id,nQbYla['mFzHu'],_id);return _id;}else{if(clusterDb[node]['clusterData']&&clusterDb[node]['clusterData']['dir']){if(nQbYla['wVzQl'](nQbYla['EdSAE'],nQbYla['EdSAE'])){dir=clusterDb[node]['clusterData']['dir'];log['warn'](nQbYla['vEJHj'],clusterDb[node]['clusterData']['dir'],dir);}else{if(edgeInCluster(edge,rootId)){log['info']('Copying as ',edge['v'],edge['w'],data,edge['name']);newGraph['setEdge'](edge['v'],edge['w'],data,edge['name']);log['info']('newGraph\x20edges\x20',newGraph['edges'](),newGraph['edge'](newGraph['edges']()[0x0]));}else{log['info']('Skipping copy of edge ',edge['v'],nQbYla['Iwovn'],edge['w'],nQbYla['OTvdZ'],rootId,nQbYla['CSMiF'],clusterId);}}}}}const clusterGraph=new _0x2c9504['Graph']({'multigraph':!![],'compound':!![]})['setGraph']({'rankdir':dir,'nodesep':0x32,'ranksep':0x32,'marginx':0x8,'marginy':0x8})['setDefaultEdgeLabel'](function(){var pwvXTD={'mlEzW':nQbYla['OKrSS'],'TeVHG':nQbYla['OTvdZ']};if('psnRJ'!==nQbYla['iibfK']){log['info'](pwvXTD['mlEzW'],edge['v'],'-->',edge['w'],pwvXTD['TeVHG'],rootId,' clusterId:',clusterId);}else{return{};}});log['warn'](nQbYla['uTRWm'],_0x2c9504['json']['write'](graph));copy(node,graph,clusterGraph,node);graph['setNode'](node,{'clusterNode':!![],'id':node,'clusterData':clusterDb[node]['clusterData'],'labelText':clusterDb[node]['labelText'],'graph':clusterGraph});log['warn'](nQbYla['KayKT'],node,')',_0x2c9504['json']['write'](clusterGraph));log['debug']('Old\x20graph\x20after\x20copy',_0x2c9504['json']['write'](graph));}else{const _0x28b75d=nodes[i];const _0x155eca=graph['children'](_0x28b75d);hasChildren=hasChildren||nQbYla['oLXrT'](_0x155eca['length'],0x0);}}else{log['warn']('Cluster\x20**\x20',node,nQbYla['pxAMJ'],!clusterDb[node]['externalConnections'],nQbYla['lHWZd'],!graph['parent'](node),nQbYla['bqBlp'],graph['children'](node)&&graph['children'](node)['length']>0x0,graph['children']('D'),depth);log['debug'](clusterDb);}}nodes=graph['nodes']();log['warn']('New\x20list\x20of\x20nodes',nodes);for(let i=0x0;nQbYla['XVfnq'](i,nodes['length']);i++){const node=nodes[i];const data=graph['node'](node);log['warn'](nQbYla['QYyWT'],node,data);if(data['clusterNode']){nQbYla['fFpAR'](extractor,data['graph'],nQbYla['FmLPC'](depth,0x1));}}};const sorter=(graph,nodes)=>{var xfklGu={'BoIYM':function(callee,param1,param2){return callee(param1,param2);}};if(nodes['length']===0x0)return[];let result=Object['assign'](nodes);nodes['forEach'](node=>{const children=graph['children'](node);const sorted=xfklGu['BoIYM'](sorter,graph,children);result=result['concat'](sorted);});return result;};export const sortNodesByHierarchy=graph=>sorter(graph,graph['children']());