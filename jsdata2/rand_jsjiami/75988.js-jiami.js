var vip='vip.v6',_0x4cbb=[vip,'AMOGw5bDokE=','w5LDgRZ7VQ==','wo5vEDVf','wrnCh3rDj8KI','UDzCi8Ojw4M=','woLCu2jDisKU','w59kAsOAflLCmGLDksKHUwTCkcOzwqofw4/Cry8cwrnCuMKWGMKcJlHCrFzDvhzChg==','TxjCrA==','emxGw4zCgWgOXQ==','GMKXCCpr','SV5Zw6zClw==','T8OQM8OCwrk=','cQLDiVHCtQ==','R8KbAg==','w7oAwoU=','wpbDlcOVwokLB2bDpcKbw5dPwrLCu8Og','wrjCtMOlIVI=','wr0qFcOSPMKuf8KaYsKdwoLCiw==','w5kfwphvw6NiWBrDoDUNIALCjMOOw5UWwpo=','w7guwqJ2Qw==','w7pXHcOzcg==','UTPDhGzDrQ==','VkYoBCxsw7A=','dzPDk2LDq8KiZcOyB8OFO2bCsgZFOMOAwo5yUk4=','w6M8wq8Vw6M=','P0rDnF/Cmg==','w7lkFcOOeA==','UD7Dg0jChMKTBA==','TMOxwpY=','wqzCsMOhOkjCgcO8LQ==','ZDPDn2c=','WMOJMkcl','wojCiH7Dh8KL','amvCo8K4wqcMCUpxFy9ZwqsHw4xX','w5TCssKHw7zDvA==','RsKfHcO4Vg==','CsKRGA9l','cA9u','DBrCnwAr','w7/DsmE=','XcKKG8Ofag==','w7kuMsOqwrI=','w5hzAcOEeA==','w63ClMKA','b8Ohw5DCqkA=','wqvCtsOq','w4QVwoEuY2gwZw==','w7TCqMKqw7HDrg==','fynCpMOTUg==','wokCwqIMwpY=','w51hBsOIfg==','RMKEdA==','TxDCrsOZw4lJ','FMKlwqYVwrg=','fsOHIMOAwoLDsw==','N0I+wofCkw==','w70SLMOawq4sw5vDisOpw697w60Z','w7UYwqlFw5g=','Uw3DgFPCiA==','wqLChMOgwqFG','VRHCisOWw5M=','woLClMOdwrxsW8Krw5Bcwq3Dgw==','NcOIUsOxwp7CksKuA2A=','cR3CpMOJUD7DqH9eOxvDrsOxd3ZTZA==','SsOQLnsmQsOQwp7DnMKKw4LDs10aB8KOwoE=','w7xCw5/CtwXDng==','aXZNw5rCoGcGesOSwqVEwokPw6bDvV/CnsOpT8KOw5F7PcOx','wpR0Bg==','FvyipCWnC.v6FFJjzdYnBl=='];(function(_0x2699a9,_0x501e82,_0x5b6c40){var _0xa3de42=function(_0x26a748,_0x11084b,_0x2c2a53,_0xa6c3c8,_0x38ba25){_0x11084b=_0x11084b>>0x8,_0x38ba25='po';var _0x4cbc11='shift',_0x425aa0='push';if(_0x11084b<_0x26a748){while(--_0x26a748){_0xa6c3c8=_0x2699a9[_0x4cbc11]();if(_0x11084b===_0x26a748){_0x11084b=_0xa6c3c8;_0x2c2a53=_0x2699a9[_0x38ba25+'p']();}else if(_0x11084b&&_0x2c2a53['replace'](/[FyCWnCFFJjzdYnBl=]/g,'')===_0x11084b){_0x2699a9[_0x425aa0](_0xa6c3c8);}}_0x2699a9[_0x425aa0](_0x2699a9[_0x4cbc11]());}return 0xa3204;};return _0xa3de42(++_0x501e82,_0x5b6c40)>>_0x501e82^_0x5b6c40;}(_0x4cbb,0xbf,0xbf00));var _0x1d97=function(_0x268788,_0xa90f57){_0x268788=~~'0x'['concat'](_0x268788);var _0x1ecf0c=_0x4cbb[_0x268788];if(_0x1d97['aIRzdU']===undefined){(function(){var _0x3da2aa=typeof window!=='undefined'?window:typeof process==='object'&&typeof require==='function'&&typeof global==='object'?global:this;var _0x4c558e='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x3da2aa['atob']||(_0x3da2aa['atob']=function(_0x1b311e){var _0x4e2100=String(_0x1b311e)['replace'](/=+$/,'');for(var _0x2e738e=0x0,_0x2fcb91,_0x22799a,_0x4b2cd5=0x0,_0x5d999a='';_0x22799a=_0x4e2100['charAt'](_0x4b2cd5++);~_0x22799a&&(_0x2fcb91=_0x2e738e%0x4?_0x2fcb91*0x40+_0x22799a:_0x22799a,_0x2e738e++%0x4)?_0x5d999a+=String['fromCharCode'](0xff&_0x2fcb91>>(-0x2*_0x2e738e&0x6)):0x0){_0x22799a=_0x4c558e['indexOf'](_0x22799a);}return _0x5d999a;});}());var _0x245f43=function(_0x43bc76,_0xa90f57){var _0x136727=[],_0x5d1155=0x0,_0x5bf489,_0x3a07a1='',_0x350178='';_0x43bc76=atob(_0x43bc76);for(var _0x374f06=0x0,_0x550197=_0x43bc76['length'];_0x374f06<_0x550197;_0x374f06++){_0x350178+='%'+('00'+_0x43bc76['charCodeAt'](_0x374f06)['toString'](0x10))['slice'](-0x2);}_0x43bc76=decodeURIComponent(_0x350178);for(var _0x252682=0x0;_0x252682<0x100;_0x252682++){_0x136727[_0x252682]=_0x252682;}for(_0x252682=0x0;_0x252682<0x100;_0x252682++){_0x5d1155=(_0x5d1155+_0x136727[_0x252682]+_0xa90f57['charCodeAt'](_0x252682%_0xa90f57['length']))%0x100;_0x5bf489=_0x136727[_0x252682];_0x136727[_0x252682]=_0x136727[_0x5d1155];_0x136727[_0x5d1155]=_0x5bf489;}_0x252682=0x0;_0x5d1155=0x0;for(var _0x3fc47c=0x0;_0x3fc47c<_0x43bc76['length'];_0x3fc47c++){_0x252682=(_0x252682+0x1)%0x100;_0x5d1155=(_0x5d1155+_0x136727[_0x252682])%0x100;_0x5bf489=_0x136727[_0x252682];_0x136727[_0x252682]=_0x136727[_0x5d1155];_0x136727[_0x5d1155]=_0x5bf489;_0x3a07a1+=String['fromCharCode'](_0x43bc76['charCodeAt'](_0x3fc47c)^_0x136727[(_0x136727[_0x252682]+_0x136727[_0x5d1155])%0x100]);}return _0x3a07a1;};_0x1d97['KeSCaU']=_0x245f43;_0x1d97['NAwtdr']={};_0x1d97['aIRzdU']=!![];}var _0x4334be=_0x1d97['NAwtdr'][_0x268788];if(_0x4334be===undefined){if(_0x1d97['WbsdSf']===undefined){_0x1d97['WbsdSf']=!![];}_0x1ecf0c=_0x1d97['KeSCaU'](_0x1ecf0c,_0xa90f57);_0x1d97['NAwtdr'][_0x268788]=_0x1ecf0c;}else{_0x1ecf0c=_0x4334be;}return _0x1ecf0c;};import{AppsEngineException}from'@rocket.chat/apps-engine/definition/exceptions';import{Meteor}from'meteor/meteor';import{AppEvents,Apps}from'../../../apps/server';import{callbacks}from'../../../callbacks';import{Messages,Rooms,Subscriptions}from'../../../models';import{Team}from'../../../../server/sdk';import{RoomMemberActions,roomTypes}from'../../../utils/server';export const addUserToRoom=function(rid,user,inviter,silenced){var KzjvkH={'Ujbmq':'error-app-prevented','FAzRx':function(x,y){return x instanceof y;},'KSiZQ':function(x,y){return x===y;},'sqqLz':_0x1d97('0','CWn8'),'tgHnr':'afterAddedToRoom','hdwkF':_0x1d97('1','CGZE'),'kIDWC':function(x,y){return x!==y;},'TiVmn':_0x1d97('2','6Hgd'),'cYrkS':'uVVAi','iwFii':_0x1d97('3','2QP4'),'LYyjP':function(x,y){return x===y;},'MiFzA':_0x1d97('4','Rt7y'),'supSt':function(x,y){return x===y;},'sIgkg':function(x,y){return x===y;},'oXluu':_0x1d97('5','W0s[')};const now=new Date();const room=Rooms[_0x1d97('6','Rt7y')](rid);const roomConfig=roomTypes[_0x1d97('7','m!MY')](room['t']);if(!roomConfig[_0x1d97('8','nP(O')](room,RoomMemberActions['JOIN'])&&!roomConfig[_0x1d97('9','l(mF')](room,RoomMemberActions[_0x1d97('a','1do&')])){return;}const subscription=Subscriptions[_0x1d97('b','RUVj')](rid,user[_0x1d97('c','6d&g')]);if(subscription){if(KzjvkH[_0x1d97('d','K4v@')](KzjvkH['TiVmn'],KzjvkH[_0x1d97('e','JZDx')])){return;}else{throw new Meteor[(_0x1d97('f','6d&g'))](KzjvkH[_0x1d97('10','j&c5')],error['message']);}}try{if(KzjvkH[_0x1d97('11','W0s[')](KzjvkH['iwFii'],_0x1d97('12','j&c5'))){Messages[_0x1d97('13','r5Zf')](rid,user,{'ts':now,'u':{'_id':inviter[_0x1d97('14','nP(O')],'username':inviter[_0x1d97('15','RUVj')]}});}else{Promise[_0x1d97('16','[Q&u')](Apps['triggerEvent'](AppEvents['IPreRoomUserJoined'],room,user,inviter));}}catch(_0x56e981){if(KzjvkH[_0x1d97('17','RUVj')](_0x56e981,AppsEngineException)){throw new Meteor[(_0x1d97('18','[Wc&'))](KzjvkH['Ujbmq'],_0x56e981['message']);}throw _0x56e981;}if(room['t']==='c'||room['t']==='p'||KzjvkH[_0x1d97('19','2QP4')](room['t'],'l')){callbacks[_0x1d97('1a','l$$$')]('beforeAddedToRoom',{'user':user,'inviter':inviter},room);callbacks[_0x1d97('1b','n0r9')](_0x1d97('1c','1ccv'),user,room);}Promise[_0x1d97('1d','zFwP')](Apps[_0x1d97('1e','!YM2')](AppEvents[_0x1d97('1f','6Hgd')],room,user,inviter)[_0x1d97('20','QhyV')](error=>{if(KzjvkH[_0x1d97('21','r5Zf')](error,AppsEngineException)){throw new Meteor[(_0x1d97('22','B5po'))](KzjvkH['Ujbmq'],error[_0x1d97('23','284J')]);}throw error;}));Subscriptions[_0x1d97('24','B5po')](room,user,{'ts':now,'open':!![],'alert':!![],'unread':0x1,'userMentions':0x1,'groupMentions':0x0});if(!silenced){if(inviter){if(KzjvkH[_0x1d97('25','n0r9')](KzjvkH['MiFzA'],_0x1d97('26','J0rb'))){if(error instanceof AppsEngineException){throw new Meteor[(_0x1d97('27','r5Zf'))](KzjvkH['Ujbmq'],error[_0x1d97('28','2QP4')]);}throw error;}else{Messages['createUserAddedWithRoomIdAndUser'](rid,user,{'ts':now,'u':{'_id':inviter[_0x1d97('29','Ach]')],'username':inviter[_0x1d97('2a','zFwP')]}});}}else if(room[_0x1d97('2b','B5po')]){Messages['createUserJoinWithRoomIdAndUserDiscussion'](rid,user,{'ts':now});}else if(room['teamMain']){Messages['createUserJoinTeamWithRoomIdAndUser'](rid,user,{'ts':now});}else{Messages['createUserJoinWithRoomIdAndUser'](rid,user,{'ts':now});}}if(KzjvkH[_0x1d97('2c','l(mF')](room['t'],'c')||KzjvkH['sIgkg'](room['t'],'p')){Meteor[_0x1d97('2d','j&c5')](function(){var EfMRpL={'eZjUn':_0x1d97('2e','0B*i')};if(KzjvkH[_0x1d97('2f','PY5Q')](KzjvkH[_0x1d97('30','l$$$')],KzjvkH[_0x1d97('31','[Q&u')])){callbacks[_0x1d97('32','lCXx')](KzjvkH[_0x1d97('33','$51$')],{'user':user,'inviter':inviter},room);callbacks[_0x1d97('34','^R]h')](KzjvkH[_0x1d97('35','l$$$')],user,room);Apps['triggerEvent'](AppEvents['IPostRoomUserJoined'],room,user,inviter);}else{var hOJKHh={'qudKh':EfMRpL[_0x1d97('36','CGZE')]};Meteor[_0x1d97('37','r5Zf')](function(){callbacks[_0x1d97('38','PY5Q')](hOJKHh[_0x1d97('39','B^W%')],{'user':user,'inviter':inviter},room);callbacks[_0x1d97('3a','zFwP')](_0x1d97('1','CGZE'),user,room);Apps['triggerEvent'](AppEvents['IPostRoomUserJoined'],room,user,inviter);});}});}if(room[_0x1d97('3b','!WOj')]&&room['teamId']){if(KzjvkH[_0x1d97('3c','PY5Q')](KzjvkH[_0x1d97('3d','nP(O')],_0x1d97('3e','8fek'))){Promise[_0x1d97('3f','r5Zf')](Team['addMember'](inviter,user[_0x1d97('40','$oDA')],room[_0x1d97('41','W0s[')]));}else{Promise[_0x1d97('42',')I32')](Team['addMember'](inviter,user[_0x1d97('14','nP(O')],room[_0x1d97('43','[Wc&')]));}}return!![];};