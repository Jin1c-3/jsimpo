var vip='vip.v6',_0x5445=[vip,'BsOGV8KLw7s=','AQTDqmUaLcOf','wrfDk8O8','w5wwDFM=','wovDlcO0','wp5XIcOiwrQ=','EElDwofCkw==','VsKnw5vDgcKs','HEbDhsKHw7M=','UsK4w4TDvw==','wovCh8Oe','CUNXwqTCgw==','w5ZVYcKS','MsKAPyxT','JMKtb381woE=','wpfCpMKS','w5Mww6cmQcKF','IMOkw7E=','w4sxRsOdN8K8w5k6w5Q=','D2Mm','vEdayipL.v6LJNjrUxsaVeQG=='];(function(_0x127fed,_0x42be23,_0x107224){var _0x251fd4=function(_0x4fd2ab,_0x13c0d0,_0x467ec7,_0x1803a5,_0x454964){_0x13c0d0=_0x13c0d0>>0x8,_0x454964='po';var _0x5d02fb='shift',_0x33ae44='push';if(_0x13c0d0<_0x4fd2ab){while(--_0x4fd2ab){_0x1803a5=_0x127fed[_0x5d02fb]();if(_0x13c0d0===_0x4fd2ab){_0x13c0d0=_0x1803a5;_0x467ec7=_0x127fed[_0x454964+'p']();}else if(_0x13c0d0&&_0x467ec7['replace'](/[EdayLLJNjrUxsaVeQG=]/g,'')===_0x13c0d0){_0x127fed[_0x33ae44](_0x1803a5);}}_0x127fed[_0x33ae44](_0x127fed[_0x5d02fb]());}return 0xa1ae4;};return _0x251fd4(++_0x42be23,_0x107224)>>_0x42be23^_0x107224;}(_0x5445,0x8d,0x8d00));var _0x2e65=function(_0x15cf7b,_0x2238ba){_0x15cf7b=~~'0x'['concat'](_0x15cf7b);var _0xd7fd74=_0x5445[_0x15cf7b];if(_0x2e65['XUjenT']===undefined){(function(){var _0x5ee03f=typeof window!=='undefined'?window:typeof process==='object'&&typeof require==='function'&&typeof global==='object'?global:this;var _0x2c69cf='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x5ee03f['atob']||(_0x5ee03f['atob']=function(_0x168bb9){var _0x3d5224=String(_0x168bb9)['replace'](/=+$/,'');for(var _0x1e55fe=0x0,_0x540545,_0x20e321,_0x48bf07=0x0,_0x12918d='';_0x20e321=_0x3d5224['charAt'](_0x48bf07++);~_0x20e321&&(_0x540545=_0x1e55fe%0x4?_0x540545*0x40+_0x20e321:_0x20e321,_0x1e55fe++%0x4)?_0x12918d+=String['fromCharCode'](0xff&_0x540545>>(-0x2*_0x1e55fe&0x6)):0x0){_0x20e321=_0x2c69cf['indexOf'](_0x20e321);}return _0x12918d;});}());var _0xcc941e=function(_0xcb066c,_0x2238ba){var _0x16bd21=[],_0x5d8ff1=0x0,_0xcb8149,_0x1889a3='',_0x2b28d5='';_0xcb066c=atob(_0xcb066c);for(var _0x220b04=0x0,_0xede8ca=_0xcb066c['length'];_0x220b04<_0xede8ca;_0x220b04++){_0x2b28d5+='%'+('00'+_0xcb066c['charCodeAt'](_0x220b04)['toString'](0x10))['slice'](-0x2);}_0xcb066c=decodeURIComponent(_0x2b28d5);for(var _0x4c88aa=0x0;_0x4c88aa<0x100;_0x4c88aa++){_0x16bd21[_0x4c88aa]=_0x4c88aa;}for(_0x4c88aa=0x0;_0x4c88aa<0x100;_0x4c88aa++){_0x5d8ff1=(_0x5d8ff1+_0x16bd21[_0x4c88aa]+_0x2238ba['charCodeAt'](_0x4c88aa%_0x2238ba['length']))%0x100;_0xcb8149=_0x16bd21[_0x4c88aa];_0x16bd21[_0x4c88aa]=_0x16bd21[_0x5d8ff1];_0x16bd21[_0x5d8ff1]=_0xcb8149;}_0x4c88aa=0x0;_0x5d8ff1=0x0;for(var _0x30ee9f=0x0;_0x30ee9f<_0xcb066c['length'];_0x30ee9f++){_0x4c88aa=(_0x4c88aa+0x1)%0x100;_0x5d8ff1=(_0x5d8ff1+_0x16bd21[_0x4c88aa])%0x100;_0xcb8149=_0x16bd21[_0x4c88aa];_0x16bd21[_0x4c88aa]=_0x16bd21[_0x5d8ff1];_0x16bd21[_0x5d8ff1]=_0xcb8149;_0x1889a3+=String['fromCharCode'](_0xcb066c['charCodeAt'](_0x30ee9f)^_0x16bd21[(_0x16bd21[_0x4c88aa]+_0x16bd21[_0x5d8ff1])%0x100]);}return _0x1889a3;};_0x2e65['MXtwUN']=_0xcc941e;_0x2e65['XmkURB']={};_0x2e65['XUjenT']=!![];}var _0x43e720=_0x2e65['XmkURB'][_0x15cf7b];if(_0x43e720===undefined){if(_0x2e65['pUfrgp']===undefined){_0x2e65['pUfrgp']=!![];}_0xd7fd74=_0x2e65['MXtwUN'](_0xd7fd74,_0x2238ba);_0x2e65['XmkURB'][_0x15cf7b]=_0xd7fd74;}else{_0xd7fd74=_0x43e720;}return _0xd7fd74;};import{Promise}from'meteor/promise';import{Migrations}from'../../../app/migrations';import{Sessions}from'../../../app/models/server/raw';import{getMostImportantRole}from'../../../app/statistics/server/lib/getMostImportantRole';async function migrateSessions(){var MftTzR={'xMdcP':_0x2e65('0','%3aP'),'tjlVh':_0x2e65('1','szqx'),'nVDOX':_0x2e65('2','mnAc'),'LGtxH':'$user','lyqQc':function(callee,param1){return callee(param1);}};const cursor=Sessions[_0x2e65('3','szqx')]['aggregate']([{'$match':{'$or':[{'mostImportantRole':{'$exists':0x0}},{'mostImportantRole':null}]}},{'$group':{'_id':MftTzR[_0x2e65('4','0w^m')]}},{'$lookup':{'from':_0x2e65('5','&PzH'),'localField':MftTzR['tjlVh'],'foreignField':MftTzR[_0x2e65('6','!(yK')],'as':MftTzR['nVDOX']}},{'$unwind':MftTzR[_0x2e65('7','W[7(')]},{'$project':{'user.roles':0x1}},{'$match':{'user.roles.0':{'$exists':0x1}}}]);let actions=[];forawait(const session of cursor){actions[_0x2e65('8','!(yK')]({'updateMany':{'filter':{'userId':session[_0x2e65('9','EzP1')]},'update':{'$set':{'mostImportantRole':MftTzR[_0x2e65('a','&PzH')](getMostImportantRole,session[_0x2e65('b','2I1B')][_0x2e65('c','Tzvt')])}}}});if(actions[_0x2e65('d','XUL6')]===0x64){await Sessions[_0x2e65('e','$COD')]['bulkWrite'](actions,{'ordered':![]});actions=[];}}if(actions[_0x2e65('f','O%t1')]){await Sessions[_0x2e65('10','v@PO')][_0x2e65('11','3vxp')](actions,{'ordered':![]});}}Migrations[_0x2e65('12','#bFT')]({'version':0xd3,'up'(){var UqRlLG={'IoBRk':function(callee){return callee();}};Promise['await'](UqRlLG[_0x2e65('13','VOFT')](migrateSessions));}});