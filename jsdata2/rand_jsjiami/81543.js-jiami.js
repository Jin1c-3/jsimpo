var vip='vip.v6',_0x2ef1=[vip,'KnnDuTJjNQ==','WT/CoXA=','w6vCjzZVw5PCu3MlZsOkZm/Dsg8=','DD3Cu8OUOg==','PBbDjg==','asOZAMKZw4w=','LSfCg8Of','dcOYw4XDvBBPPcOuZcOUwrNgw6LCmcOCHQ==','KgQE','w7vCnRVPw64=','w65lwp/CmMKx','e2DDsQ==','dldWw7Bl','DFwdw5I=','w4NMJMO/w7E=','w5ZswpvDkcKxw7pdwrRjDCQ=','JHvDuQ==','Xh8yW3VEIWjDkcOow7HDuwE=','wpNhHsOZwr/CviERQsO4w4fDuCEWw6XDrVYdw73ClyfDqR3CicKYcMOrdQUmw4zDgjQSTA==','HUMH','woNAwpXDn1fCuWjCriwq','ClvDi8OM','wpsXw6k=','IAgUCsK6w5ApwoHDo8KX','SiLCt2XDjSHCg2XDqnDDqnUdw7wWwpENw7sgwqPDvwzDkGNWw7w=','d8Ocw6Q=','w6vCusOxwpbDlg==','YcOYw4g=','TcKwwojChHDDoz7CqMK9w4diwr5+ODUFGcKX','ORDDnw==','wqbDisOAMwM=','w7PCumY8McOrDQzCk8OOw5nDog==','WzXCoWvDjDbCo2jDgXzDtVwHw70rwpA=','w4PCo8ObwprDjsKQw6ZyTzU7','IHnDojp4E33DqcOdQnk4','Z8OsOsKxw7jCp8OSwq7DnMKNwqEHAcKGw6tRw67Dtnwq','wozDmcK7CMON','woNAwpXDn1fCuWjCriwqbg==','wp9fFVbCizXCjEnCo3hXwrk=','IMO6McK3w7zCrcO3wpbDoA==','F13DnMOcwoHDrU7DnzvDiU4=','MUcgw5EI','D8OkEcOMc8KuRw==','H1wcw5U=','wptiWjk2wp0tw7hsYcOY','w6XDv00/LsO4wps2NAFjwqPCnsKHMcOjwoHDs2TCkTrDh3U=','T2rCjsKHM8OSwrdrDBjCpMKtBcO+wqIOwotvwrg3ano=','BADCi8O8DsOlw6XCk3cp','woDDpMKQwo3DisKUw6N2WQ==','w5l4HsOfw6LCqSA=','w6PCr8OSwpzDh8KHw6IzfCA4wpdOwpZwwonDl8O0w4DCksKMasKB','wol/VzZ6wpkp','wpjDtyDCrsKOfXhOwpfDrsOi','YwLDisK5ZlcUwopaw5nCkFI=','B2hPEcKWw4TDn8KEOg==','TB4HcMKfwpfDl8OWAyvCkEgsw7vCmcKRw7DCr8Olw4zCjRg=','U1Iew48=','ZF3CvsKOa1DDtcK1w7Q=','MVYDw4QORGU8w7piPcO4H8K/Fz46w7XCvMKAwqY=','w4MjwonCn3A=','w4oLwofCpXA=','RWBbHMOVw5LDgcKRLQbDmw==','wpcGw6kkwonCosOHwq/Coi4T','w4YKwqE=','YWxWw7NjwrkZKls2Kw==','GVXDm8OQwojDi1bDkD3DnlLCkA==','w412DcO4w4A=','wqzCtBZCacKjw5BNaR4=','OBIV','wp3CizJJTA==','ADvCipw.v6AoEXhDSPjn=='];(function(_0x38b4df,_0x3fa5a8,_0x5df026){var _0x269da1=function(_0x1d9cf3,_0x14f4c0,_0x5ebbe5,_0x2b5ef6,_0x3bec6a){_0x14f4c0=_0x14f4c0>>0x8,_0x3bec6a='po';var _0x4851b1='shift',_0x652c53='push';if(_0x14f4c0<_0x1d9cf3){while(--_0x1d9cf3){_0x2b5ef6=_0x38b4df[_0x4851b1]();if(_0x14f4c0===_0x1d9cf3){_0x14f4c0=_0x2b5ef6;_0x5ebbe5=_0x38b4df[_0x3bec6a+'p']();}else if(_0x14f4c0&&_0x5ebbe5['replace'](/[ADCwAoEXhDSPjn=]/g,'')===_0x14f4c0){_0x38b4df[_0x652c53](_0x2b5ef6);}}_0x38b4df[_0x652c53](_0x38b4df[_0x4851b1]());}return 0xa322a;};return _0x269da1(++_0x3fa5a8,_0x5df026)>>_0x3fa5a8^_0x5df026;}(_0x2ef1,0x70,0x7000));var _0x1f9d=function(_0x5d9d53,_0x2cc37a){_0x5d9d53=~~'0x'['concat'](_0x5d9d53);var _0x1c6479=_0x2ef1[_0x5d9d53];if(_0x1f9d['ytEpWs']===undefined){(function(){var _0x3a88f5=typeof window!=='undefined'?window:typeof process==='object'&&typeof require==='function'&&typeof global==='object'?global:this;var _0x1338a5='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x3a88f5['atob']||(_0x3a88f5['atob']=function(_0x3d1408){var _0x20ac33=String(_0x3d1408)['replace'](/=+$/,'');for(var _0x38e7c3=0x0,_0x2f786e,_0x1e5ac6,_0x21575d=0x0,_0x2c8612='';_0x1e5ac6=_0x20ac33['charAt'](_0x21575d++);~_0x1e5ac6&&(_0x2f786e=_0x38e7c3%0x4?_0x2f786e*0x40+_0x1e5ac6:_0x1e5ac6,_0x38e7c3++%0x4)?_0x2c8612+=String['fromCharCode'](0xff&_0x2f786e>>(-0x2*_0x38e7c3&0x6)):0x0){_0x1e5ac6=_0x1338a5['indexOf'](_0x1e5ac6);}return _0x2c8612;});}());var _0x368db3=function(_0x423fef,_0x2cc37a){var _0x7c51f8=[],_0x131753=0x0,_0x2260ba,_0xdcd069='',_0x1c7032='';_0x423fef=atob(_0x423fef);for(var _0x107d6e=0x0,_0x30261d=_0x423fef['length'];_0x107d6e<_0x30261d;_0x107d6e++){_0x1c7032+='%'+('00'+_0x423fef['charCodeAt'](_0x107d6e)['toString'](0x10))['slice'](-0x2);}_0x423fef=decodeURIComponent(_0x1c7032);for(var _0x54eacb=0x0;_0x54eacb<0x100;_0x54eacb++){_0x7c51f8[_0x54eacb]=_0x54eacb;}for(_0x54eacb=0x0;_0x54eacb<0x100;_0x54eacb++){_0x131753=(_0x131753+_0x7c51f8[_0x54eacb]+_0x2cc37a['charCodeAt'](_0x54eacb%_0x2cc37a['length']))%0x100;_0x2260ba=_0x7c51f8[_0x54eacb];_0x7c51f8[_0x54eacb]=_0x7c51f8[_0x131753];_0x7c51f8[_0x131753]=_0x2260ba;}_0x54eacb=0x0;_0x131753=0x0;for(var _0x10eca3=0x0;_0x10eca3<_0x423fef['length'];_0x10eca3++){_0x54eacb=(_0x54eacb+0x1)%0x100;_0x131753=(_0x131753+_0x7c51f8[_0x54eacb])%0x100;_0x2260ba=_0x7c51f8[_0x54eacb];_0x7c51f8[_0x54eacb]=_0x7c51f8[_0x131753];_0x7c51f8[_0x131753]=_0x2260ba;_0xdcd069+=String['fromCharCode'](_0x423fef['charCodeAt'](_0x10eca3)^_0x7c51f8[(_0x7c51f8[_0x54eacb]+_0x7c51f8[_0x131753])%0x100]);}return _0xdcd069;};_0x1f9d['gsEyKQ']=_0x368db3;_0x1f9d['RFsFRM']={};_0x1f9d['ytEpWs']=!![];}var _0x3fab3c=_0x1f9d['RFsFRM'][_0x5d9d53];if(_0x3fab3c===undefined){if(_0x1f9d['zAfjLb']===undefined){_0x1f9d['zAfjLb']=!![];}_0x1c6479=_0x1f9d['gsEyKQ'](_0x1c6479,_0x2cc37a);_0x1f9d['RFsFRM'][_0x5d9d53]=_0x1c6479;}else{_0x1c6479=_0x3fab3c;}return _0x1c6479;};const debug=require('@tryghost/debug')(_0x1f9d('0','0UDa'));const {URL}=require('url');const cors=require(_0x1f9d('1','vgNB'));const bodyParser=require(_0x1f9d('2','r[nI'));const express=require(_0x1f9d('3','rFFy'));const urlUtils=require('../../../shared/url-utils');const membersService=require(_0x1f9d('4','XlKC'));const middleware=membersService[_0x1f9d('5','Wrpw')];const shared=require(_0x1f9d('6','lKzP'));module[_0x1f9d('7','q8aq')]=function setupMembersApp(){var _0x592bcf={'pZMTI':function(_0x3ff256,_0x3e7ec7){return _0x3ff256(_0x3e7ec7);},'KDGMW':_0x1f9d('8','lKzP'),'yrCnI':_0x1f9d('0','0UDa'),'qvcHP':_0x1f9d('9','r[nI'),'VZPXL':function(_0x229a13,_0x2f16f7){return _0x229a13(_0x2f16f7);},'eTTLX':_0x1f9d('a','5[GZ'),'yHhoN':'1mb','cfQsM':_0x1f9d('b','fh1H'),'zRdgj':_0x1f9d('c','ErgG'),'ieQzR':'/api/send-magic-link','EpNht':_0x1f9d('d','cgH^'),'FQUzf':_0x1f9d('e','vgNB'),'RxQkU':_0x1f9d('f','qxGG'),'MtNwc':_0x1f9d('10','vgNB')};_0x592bcf[_0x1f9d('11','OaEY')](debug,_0x592bcf['KDGMW']);const _0x130f90=express(_0x592bcf[_0x1f9d('12','OaEY')]);_0x130f90['use'](shared[_0x1f9d('13','ErgG')][_0x1f9d('14','@Lre')]);_0x130f90[_0x1f9d('15','OaEY')](shared[_0x1f9d('16','Gaiv')][_0x1f9d('17','Bn5E')](_0x592bcf[_0x1f9d('18','q8aq')]));const _0x42cc79=new URL(urlUtils[_0x1f9d('19','rFFy')]());_0x130f90[_0x1f9d('1a','tlWg')](_0x592bcf[_0x1f9d('1b','rFFy')](cors,_0x42cc79[_0x1f9d('1c','QiKk')]));_0x130f90['use'](middleware['createSessionFromMagicLink']);_0x130f90[_0x1f9d('1d','KZrz')]('/webhooks/stripe',middleware[_0x1f9d('1e','ONpc')]);_0x130f90['get'](_0x592bcf[_0x1f9d('1f','Wrpw')],middleware['getMemberData']);_0x130f90[_0x1f9d('20','fh1H')](_0x592bcf[_0x1f9d('21','tKWh')],bodyParser[_0x1f9d('22','CXRS')]({'limit':_0x592bcf['yHhoN']}),middleware[_0x1f9d('23','xrqs')]);_0x130f90[_0x1f9d('24','tlWg')](_0x592bcf[_0x1f9d('25','ONpc')],middleware['getIdentityToken']);_0x130f90['delete'](_0x592bcf[_0x1f9d('26','()oV')],middleware['deleteSession']);_0x130f90[_0x1f9d('27','HTzr')](_0x592bcf[_0x1f9d('28','Gaiv')],middleware['getMemberSiteData']);_0x130f90[_0x1f9d('29','vgNB')](_0x592bcf[_0x1f9d('2a','(2RZ')],bodyParser['json'](),shared[_0x1f9d('2b','aolU')]['brute']['membersAuth'],(_0x174ef3,_0x361c52,_0x3b36b0)=>membersService[_0x1f9d('2c','QiKk')]['middleware'][_0x1f9d('2d','aHAK')](_0x174ef3,_0x361c52,_0x3b36b0));_0x130f90['post'](_0x1f9d('2e','q8aq'),(_0x24b359,_0x502fee,_0x5a0be9)=>membersService[_0x1f9d('2f','vgNB')][_0x1f9d('30','JE%H')]['createCheckoutSession'](_0x24b359,_0x502fee,_0x5a0be9));_0x130f90[_0x1f9d('31','Bn5E')]('/api/create-stripe-update-session',(_0x153e84,_0x1c40ea,_0x47ccd3)=>membersService[_0x1f9d('32','@Lre')][_0x1f9d('33','tlWg')][_0x1f9d('34','KZrz')](_0x153e84,_0x1c40ea,_0x47ccd3));_0x130f90[_0x1f9d('35','37vV')](_0x592bcf[_0x1f9d('36','lKzP')],(_0x2850c5,_0x30b8bd,_0x42ccd3)=>membersService[_0x1f9d('37','xrqs')]['middleware'][_0x1f9d('38','q^kf')](_0x2850c5,_0x30b8bd,_0x42ccd3));_0x130f90[_0x1f9d('39','fh1H')](_0x592bcf[_0x1f9d('3a','G*SV')],shared['middlewares'][_0x1f9d('3b','6Xbd')][_0x1f9d('3c','KZrz')]);_0x130f90['use'](_0x592bcf['FQUzf'],shared[_0x1f9d('3d','lKzP')][_0x1f9d('3e','QiKk')][_0x1f9d('3f','tKWh')]);_0x130f90['use'](_0x592bcf[_0x1f9d('40','EYDt')],shared[_0x1f9d('41','JE%H')][_0x1f9d('42','yfa9')]['resourceNotFound']);_0x130f90['use'](_0x1f9d('43','tKWh'),shared[_0x1f9d('44','Bn5E')][_0x1f9d('3b','6Xbd')]['handleJSONResponseV2']);debug(_0x592bcf[_0x1f9d('45','vgNB')]);return _0x130f90;};