"use strict";const path=require("path");const{BlobServiceClient}=require("@azure/storage-blob");module.exports=function e(t,i,n){const o=BlobServiceClient.fromConnectionString(t);const r="atom-build";const c=o.getContainerClient(r);async function s(){return c.listBlobsFlat({prefix:i})}async function a(e=[]){try{for await(const t of e){console.log(`Deleting blob ${t.name}`);c.deleteBlob(t.name)}return Promise.resolve(true)}catch(e){return Promise.reject(e.message)}}function l(e){return e.reduce(function(e,t){return e.then(()=>u(t))},Promise.resolve())}function u(r){return new Promise(async(e,t)=>{try{console.info(`Uploading ${r}`);const n=c.getBlockBlobClient(path.join(i,path.basename(r)));const o=await n.uploadFile(r);e(o)}catch(e){t(e.message)}})}return s().then(a).then(()=>l(n))};