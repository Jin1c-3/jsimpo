define(["./core","./var/strundefined","./var/rnotwhite","./var/hasOwn","./var/slice","./event/support","./data/var/data_priv","./core/init","./data/accepts","./selector"],function(m,y,b,h,u,e,w){var s=/^key/,l=/^(?:mouse|pointer|contextmenu)|click/,g=/^(?:focusinfocus|focusoutblur)$/,T=/^([^.]*)(?:\.(.+)|)$/;function n(){return true}function f(){return false}function t(){try{return document.activeElement}catch(e){}}m.event={global:{},add:function(t,e,n,i,r){var a,o,s,l,f,u,p,c,d,h,g,v=w.get(t);if(!v){return}if(n.handler){a=n;n=a.handler;r=a.selector}if(!n.guid){n.guid=m.guid++}if(!(l=v.events)){l=v.events={}}if(!(o=v.handle)){o=v.handle=function(e){return typeof m!==y&&m.event.triggered!==e.type?m.event.dispatch.apply(t,arguments):undefined}}e=(e||"").match(b)||[""];f=e.length;while(f--){s=T.exec(e[f])||[];d=g=s[1];h=(s[2]||"").split(".").sort();if(!d){continue}p=m.event.special[d]||{};d=(r?p.delegateType:p.bindType)||d;p=m.event.special[d]||{};u=m.extend({type:d,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&m.expr.match.needsContext.test(r),namespace:h.join(".")},a);if(!(c=l[d])){c=l[d]=[];c.delegateCount=0;if(!p.setup||p.setup.call(t,i,h,o)===false){if(t.addEventListener){t.addEventListener(d,o,false)}}}if(p.add){p.add.call(t,u);if(!u.handler.guid){u.handler.guid=n.guid}}if(r){c.splice(c.delegateCount++,0,u)}else{c.push(u)}m.event.global[d]=true}},remove:function(e,t,n,i,r){var a,o,s,l,f,u,p,c,d,h,g,v=w.hasData(e)&&w.get(e);if(!v||!(l=v.events)){return}t=(t||"").match(b)||[""];f=t.length;while(f--){s=T.exec(t[f])||[];d=g=s[1];h=(s[2]||"").split(".").sort();if(!d){for(d in l){m.event.remove(e,d+t[f],n,i,true)}continue}p=m.event.special[d]||{};d=(i?p.delegateType:p.bindType)||d;c=l[d]||[];s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)");o=a=c.length;while(a--){u=c[a];if((r||g===u.origType)&&(!n||n.guid===u.guid)&&(!s||s.test(u.namespace))&&(!i||i===u.selector||i==="**"&&u.selector)){c.splice(a,1);if(u.selector){c.delegateCount--}if(p.remove){p.remove.call(e,u)}}}if(o&&!c.length){if(!p.teardown||p.teardown.call(e,h,v.handle)===false){m.removeEvent(e,d,v.handle)}delete l[d]}}if(m.isEmptyObject(l)){delete v.handle;w.remove(e,"events")}},trigger:function(e,t,n,i){var r,a,o,s,l,f,u,p=[n||document],c=h.call(e,"type")?e.type:e,d=h.call(e,"namespace")?e.namespace.split("."):[];a=o=n=n||document;if(n.nodeType===3||n.nodeType===8){return}if(g.test(c+m.event.triggered)){return}if(c.indexOf(".")>=0){d=c.split(".");c=d.shift();d.sort()}l=c.indexOf(":")<0&&"on"+c;e=e[m.expando]?e:new m.Event(c,typeof e==="object"&&e);e.isTrigger=i?2:3;e.namespace=d.join(".");e.namespace_re=e.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;e.result=undefined;if(!e.target){e.target=n}t=t==null?[e]:m.makeArray(t,[e]);u=m.event.special[c]||{};if(!i&&u.trigger&&u.trigger.apply(n,t)===false){return}if(!i&&!u.noBubble&&!m.isWindow(n)){s=u.delegateType||c;if(!g.test(s+c)){a=a.parentNode}for(;a;a=a.parentNode){p.push(a);o=a}if(o===(n.ownerDocument||document)){p.push(o.defaultView||o.parentWindow||window)}}r=0;while((a=p[r++])&&!e.isPropagationStopped()){e.type=r>1?s:u.bindType||c;f=(w.get(a,"events")||{})[e.type]&&w.get(a,"handle");if(f){f.apply(a,t)}f=l&&a[l];if(f&&f.apply&&m.acceptData(a)){e.result=f.apply(a,t);if(e.result===false){e.preventDefault()}}}e.type=c;if(!i&&!e.isDefaultPrevented()){if((!u._default||u._default.apply(p.pop(),t)===false)&&m.acceptData(n)){if(l&&m.isFunction(n[c])&&!m.isWindow(n)){o=n[l];if(o){n[l]=null}m.event.triggered=c;n[c]();m.event.triggered=undefined;if(o){n[l]=o}}}}return e.result},dispatch:function(e){e=m.event.fix(e);var t,n,i,r,a,o=[],s=u.call(arguments),l=(w.get(this,"events")||{})[e.type]||[],f=m.event.special[e.type]||{};s[0]=e;e.delegateTarget=this;if(f.preDispatch&&f.preDispatch.call(this,e)===false){return}o=m.event.handlers.call(this,e,l);t=0;while((r=o[t++])&&!e.isPropagationStopped()){e.currentTarget=r.elem;n=0;while((a=r.handlers[n++])&&!e.isImmediatePropagationStopped()){if(!e.namespace_re||e.namespace_re.test(a.namespace)){e.handleObj=a;e.data=a.data;i=((m.event.special[a.origType]||{}).handle||a.handler).apply(r.elem,s);if(i!==undefined){if((e.result=i)===false){e.preventDefault();e.stopPropagation()}}}}}if(f.postDispatch){f.postDispatch.call(this,e)}return e.result},handlers:function(e,t){var n,i,r,a,o=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&(!e.button||e.type!=="click")){for(;l!==this;l=l.parentNode||this){if(l.disabled!==true||e.type!=="click"){i=[];for(n=0;n<s;n++){a=t[n];r=a.selector+" ";if(i[r]===undefined){i[r]=a.needsContext?m(r,this).index(l)>=0:m.find(r,this,null,[l]).length}if(i[r]){i.push(a)}}if(i.length){o.push({elem:l,handlers:i})}}}}if(s<t.length){o.push({elem:this,handlers:t.slice(s)})}return o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){if(e.which==null){e.which=t.charCode!=null?t.charCode:t.keyCode}return e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,r,a=t.button;if(e.pageX==null&&t.clientX!=null){n=e.target.ownerDocument||document;i=n.documentElement;r=n.body;e.pageX=t.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0);e.pageY=t.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)}if(!e.which&&a!==undefined){e.which=a&1?1:a&2?3:a&4?2:0}return e}},fix:function(e){if(e[m.expando]){return e}var t,n,i,r=e.type,a=e,o=this.fixHooks[r];if(!o){this.fixHooks[r]=o=l.test(r)?this.mouseHooks:s.test(r)?this.keyHooks:{}}i=o.props?this.props.concat(o.props):this.props;e=new m.Event(a);t=i.length;while(t--){n=i[t];e[n]=a[n]}if(!e.target){e.target=document}if(e.target.nodeType===3){e.target=e.target.parentNode}return o.filter?o.filter(e,a):e},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==t()&&this.focus){this.focus();return false}},delegateType:"focusin"},blur:{trigger:function(){if(this===t()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&m.nodeName(this,"input")){this.click();return false}},_default:function(e){return m.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){if(e.result!==undefined&&e.originalEvent){e.originalEvent.returnValue=e.result}}}},simulate:function(e,t,n,i){var r=m.extend(new m.Event,n,{type:e,isSimulated:true,originalEvent:{}});if(i){m.event.trigger(r,null,t)}else{m.event.dispatch.call(t,r)}if(r.isDefaultPrevented()){n.preventDefault()}}};m.removeEvent=function(e,t,n){if(e.removeEventListener){e.removeEventListener(t,n,false)}};m.Event=function(e,t){if(!(this instanceof m.Event)){return new m.Event(e,t)}if(e&&e.type){this.originalEvent=e;this.type=e.type;this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===undefined&&e.returnValue===false?n:f}else{this.type=e}if(t){m.extend(this,t)}this.timeStamp=e&&e.timeStamp||m.now();this[m.expando]=true};m.Event.prototype={isDefaultPrevented:f,isPropagationStopped:f,isImmediatePropagationStopped:f,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=n;if(e&&e.preventDefault){e.preventDefault()}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=n;if(e&&e.stopPropagation){e.stopPropagation()}},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=n;if(e&&e.stopImmediatePropagation){e.stopImmediatePropagation()}this.stopPropagation()}};m.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,a){m.event.special[e]={delegateType:a,bindType:a,handle:function(e){var t,n=this,i=e.relatedTarget,r=e.handleObj;if(!i||i!==n&&!m.contains(n,i)){e.type=r.origType;t=r.handler.apply(this,arguments);e.type=a}return t}}});if(!e.focusinBubbles){m.each({focus:"focusin",blur:"focusout"},function(n,i){var r=function(e){m.event.simulate(i,e.target,m.event.fix(e),true)};m.event.special[i]={setup:function(){var e=this.ownerDocument||this,t=w.access(e,i);if(!t){e.addEventListener(n,r,true)}w.access(e,i,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=w.access(e,i)-1;if(!t){e.removeEventListener(n,r,true);w.remove(e,i)}else{w.access(e,i,t)}}}})}m.fn.extend({on:function(e,t,n,i,r){var a,o;if(typeof e==="object"){if(typeof t!=="string"){n=n||t;t=undefined}for(o in e){this.on(o,t,n,e[o],r)}return this}if(n==null&&i==null){i=t;n=t=undefined}else if(i==null){if(typeof t==="string"){i=n;n=undefined}else{i=n;n=t;t=undefined}}if(i===false){i=f}else if(!i){return this}if(r===1){a=i;i=function(e){m().off(e);return a.apply(this,arguments)};i.guid=a.guid||(a.guid=m.guid++)}return this.each(function(){m.event.add(this,e,i,n,t)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,t,n){var i,r;if(e&&e.preventDefault&&e.handleObj){i=e.handleObj;m(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler);return this}if(typeof e==="object"){for(r in e){this.off(r,t,e[r])}return this}if(t===false||typeof t==="function"){n=t;t=undefined}if(n===false){n=f}return this.each(function(){m.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){m.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n){return m.event.trigger(e,t,n,true)}}});return m});