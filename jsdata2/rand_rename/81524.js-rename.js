const express=require("../../../../../shared/express");const api=require("../../../../api").v2;const mw=require("./middleware");const apiMw=require("../../middleware");const shared=require("../../../shared");module.exports=function i(){const t=express.Router("v2 admin");t.del=t.delete;t.use(apiMw.cors);const e=api.http;t.get("/site",mw.publicAdminApi,e(api.site.read));t.get("/config",mw.authAdminApi,e(api.config.read));t.get("/posts",mw.authAdminApi,e(api.posts.browse));t.post("/posts",mw.authAdminApi,e(api.posts.add));t.get("/posts/:id",mw.authAdminApi,e(api.posts.read));t.get("/posts/slug/:slug",mw.authAdminApi,e(api.posts.read));t.put("/posts/:id",mw.authAdminApi,e(api.posts.edit));t.del("/posts/:id",mw.authAdminApi,e(api.posts.destroy));t.get("/pages",mw.authAdminApi,e(api.pages.browse));t.post("/pages",mw.authAdminApi,e(api.pages.add));t.get("/pages/:id",mw.authAdminApi,e(api.pages.read));t.get("/pages/slug/:slug",mw.authAdminApi,e(api.pages.read));t.put("/pages/:id",mw.authAdminApi,e(api.pages.edit));t.del("/pages/:id",mw.authAdminApi,e(api.pages.destroy));t.get("/integrations",mw.authAdminApi,e(api.integrations.browse));t.get("/integrations/:id",mw.authAdminApi,e(api.integrations.read));t.post("/integrations",mw.authAdminApi,e(api.integrations.add));t.put("/integrations/:id",mw.authAdminApi,e(api.integrations.edit));t.del("/integrations/:id",mw.authAdminApi,e(api.integrations.destroy));t.put("/schedules/:resource/:id",mw.authAdminApiWithUrl,e(api.schedules.publish));t.get("/settings/routes/yaml",mw.authAdminApi,e(api.settings.download));t.post("/settings/routes/yaml",mw.authAdminApi,apiMw.upload.single("routes"),apiMw.upload.validation({type:"routes"}),e(api.settings.upload));t.get("/settings",mw.authAdminApi,e(api.settings.browse));t.get("/settings/:key",mw.authAdminApi,e(api.settings.read));t.put("/settings",mw.authAdminApi,e(api.settings.edit));t.get("/users",mw.authAdminApi,e(api.users.browse));t.get("/users/:id",mw.authAdminApi,e(api.users.read));t.get("/users/slug/:slug",mw.authAdminApi,e(api.users.read));t.get("/users/email/:email",mw.authAdminApi,e(api.users.read));t.put("/users/password",mw.authAdminApi,e(api.users.changePassword));t.put("/users/owner",mw.authAdminApi,e(api.users.transferOwnership));t.put("/users/:id",mw.authAdminApi,e(api.users.edit));t.del("/users/:id",mw.authAdminApi,e(api.users.destroy));t.get("/tags",mw.authAdminApi,e(api.tags.browse));t.get("/tags/:id",mw.authAdminApi,e(api.tags.read));t.get("/tags/slug/:slug",mw.authAdminApi,e(api.tags.read));t.post("/tags",mw.authAdminApi,e(api.tags.add));t.put("/tags/:id",mw.authAdminApi,e(api.tags.edit));t.del("/tags/:id",mw.authAdminApi,e(api.tags.destroy));t.get("/roles/",mw.authAdminApi,e(api.roles.browse));t.get("/slugs/:type/:name",mw.authAdminApi,e(api.slugs.generate));t.get("/themes/",mw.authAdminApi,e(api.themes.browse));t.get("/themes/:name/download",mw.authAdminApi,e(api.themes.download));t.post("/themes/upload",mw.authAdminApi,apiMw.upload.single("file"),apiMw.upload.validation({type:"themes"}),e(api.themes.upload));t.put("/themes/:name/activate",mw.authAdminApi,e(api.themes.activate));t.del("/themes/:name",mw.authAdminApi,e(api.themes.destroy));t.get("/notifications",mw.authAdminApi,e(api.notifications.browse));t.post("/notifications",mw.authAdminApi,e(api.notifications.add));t.del("/notifications/:notification_id",mw.authAdminApi,e(api.notifications.destroy));t.get("/db",mw.authAdminApi,e(api.db.exportContent));t.post("/db",mw.authAdminApi,apiMw.upload.single("importfile"),apiMw.upload.validation({type:"db"}),e(api.db.importContent));t.del("/db",mw.authAdminApi,e(api.db.deleteAllContent));t.post("/db/backup",mw.authAdminApi,e(api.db.backupContent));t.post("/mail",mw.authAdminApi,e(api.mail.send));t.post("/mail/test",mw.authAdminApi,e(api.mail.sendTest));t.post("/slack/test",mw.authAdminApi,e(api.slack.sendTest));t.get("/session",mw.authAdminApi,e(api.session.read));t.post("/session",shared.middlewares.brute.globalBlock,shared.middlewares.brute.userLogin,e(api.session.add));t.del("/session",mw.authAdminApi,e(api.session.delete));t.post("/authentication/passwordreset",shared.middlewares.brute.globalReset,shared.middlewares.brute.userReset,e(api.authentication.generateResetToken));t.put("/authentication/passwordreset",shared.middlewares.brute.globalBlock,e(api.authentication.resetPassword));t.post("/authentication/invitation",e(api.authentication.acceptInvitation));t.get("/authentication/invitation",e(api.authentication.isInvitation));t.post("/authentication/setup",e(api.authentication.setup));t.put("/authentication/setup",mw.authAdminApi,e(api.authentication.updateSetup));t.get("/authentication/setup",e(api.authentication.isSetup));t.post("/images/upload",mw.authAdminApi,apiMw.upload.single("file"),apiMw.upload.validation({type:"images"}),apiMw.normalizeImage,e(api.images.upload));t.get("/invites",mw.authAdminApi,e(api.invites.browse));t.get("/invites/:id",mw.authAdminApi,e(api.invites.read));t.post("/invites",mw.authAdminApi,e(api.invites.add));t.del("/invites/:id",mw.authAdminApi,e(api.invites.destroy));t.get("/redirects/json",mw.authAdminApi,e(api.redirects.download));t.post("/redirects/json",mw.authAdminApi,apiMw.upload.single("redirects"),apiMw.upload.validation({type:"redirects"}),e(api.redirects.upload));t.post("/webhooks",mw.authAdminApi,e(api.webhooks.add));t.put("/webhooks/:id",mw.authAdminApi,e(api.webhooks.edit));t.del("/webhooks/:id",mw.authAdminApi,e(api.webhooks.destroy));t.get("/oembed",mw.authAdminApi,e(api.oembed.read));t.get("/actions/:type/:id",mw.authAdminApi,e(api.actions.browse));return t};