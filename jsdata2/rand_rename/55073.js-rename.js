"use strict";const common=require("../common");if(!common.hasCrypto)common.skip("missing crypto");const http2=require("http2");function testServerTimeout(t){const e=http2.createServer();t(e);const o=common.mustCall(t=>{t.close()});e.on("stream",common.mustNotCall());e.once("timeout",o);e.listen(0,common.mustCall(()=>{const o=`http://localhost:${e.address().port}`;const t=http2.connect(o);t.on("close",common.mustCall(()=>{const t=http2.connect(o);t.on("close",common.mustCall(()=>e.close()))}))}))}const timeout=common.platformTimeout(50);testServerTimeout(t=>t.setTimeout(timeout));testServerTimeout(t=>t.timeout=timeout);