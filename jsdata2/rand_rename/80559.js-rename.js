import{Scroller}from"./Scroller";export default{methods:{initScroller:function(t,i){this._touchInfo={trackingID:-1,maxDy:0,maxDx:0};this._scroller=new Scroller(t,i);this.__handleTouchStart=this._handleTouchStart.bind(this);this.__handleTouchMove=this._handleTouchMove.bind(this);this.__handleTouchEnd=this._handleTouchEnd.bind(this);this._initedScroller=true},_findDelta:function(t){var i=this._touchInfo;return t.detail.state==="move"||t.detail.state==="end"?{x:t.detail.dx,y:t.detail.dy}:{x:t.screenX-i.x,y:t.screenY-i.y}},_handleTouchStart:function(t){var i=this._touchInfo;var e=this._scroller;if(e){if(t.detail.state==="start"){i.trackingID="touch";i.x=t.detail.x;i.y=t.detail.y}else{i.trackingID="mouse";i.x=t.screenX;i.y=t.screenY}i.maxDx=0;i.maxDy=0;i.historyX=[0];i.historyY=[0];i.historyTime=[t.detail.timeStamp];i.listener=e;if(e.onTouchStart){e.onTouchStart()}t.preventDefault()}},_handleTouchMove:function(t){var i=this._touchInfo;if(i.trackingID!==-1){t.preventDefault();var e=this._findDelta(t);if(e){for(i.maxDy=Math.max(i.maxDy,Math.abs(e.y)),i.maxDx=Math.max(i.maxDx,Math.abs(e.x)),i.historyX.push(e.x),i.historyY.push(e.y),i.historyTime.push(t.detail.timeStamp);i.historyTime.length>10;){i.historyTime.shift();i.historyX.shift();i.historyY.shift()}if(i.listener&&i.listener.onTouchMove){i.listener.onTouchMove(e.x,e.y,t.detail.timeStamp)}}}},_handleTouchEnd:function(t){var i=this._touchInfo;if(i.trackingID!==-1){t.preventDefault();var e=this._findDelta(t);if(e){var h=i.listener;i.trackingID=-1;i.listener=null;var r=i.historyTime.length;var o={x:0,y:0};if(r>2){for(var a=i.historyTime.length-1,n=i.historyTime[a],s=i.historyX[a],l=i.historyY[a];a>0;){a--;var c=i.historyTime[a];var y=n-c;if(y>30&&y<50){o.x=(s-i.historyX[a])/(y/1e3);o.y=(l-i.historyY[a])/(y/1e3);break}}}i.historyTime=[];i.historyX=[];i.historyY=[];if(h&&h.onTouchEnd){h.onTouchEnd(e.x,e.y,o)}}}}}};