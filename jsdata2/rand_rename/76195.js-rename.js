import{Meteor}from"meteor/meteor";import _ from"underscore";import{getRoles}from"./getRoles";import{Users,Roles}from"../../../models";export const addUserRoles=(e,r,o)=>{if(!e||!r){return false}const t=Users.db.findOneById(e);if(!t){throw new Meteor.Error("error-invalid-user","Invalid user",{function:"RocketChat.authz.addUserRoles"})}r=[].concat(r);const s=_.pluck(getRoles(),"_id");const n=_.difference(r,s);if(!_.isEmpty(n)){for(const d of n){Roles.createOrUpdate(d)}}Roles.addUserRoles(e,r,o);return true};