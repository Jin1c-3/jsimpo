const vip = 'vip.v6';
const _0x35d2 = ['vip.v6', 'wrHCncK+w7bCiFcPw7w5wpbCq8OmVcOOU8KVP8OJCcOmwrwBw53CgGoL', 'wr1fw7LCmcOAw7NeGsOIw7MKHkPCrsKQw4jCrUI=', 'cizDuHnDtxRa', 'GcKiwqTDi0RrU2HDmw7DhV/CrG/CtRFxP8K2bMK0w53CsgzDtcKCQMOXOcO4NMK9UsOOwo7CmsOjw7PDvw==', 'ITVHw67CnsO6b0nDqsO7UcKIwrnDmcOU', 'w4/DqMKswoTDtQ==', 'w70uHAvCtsKQGw==', 'w5fCtcKDw7w1w7TDlA==', 'GzrCgzzChcOcw7U=', 'w7xbw7zDhsOyw6x7worDlMOYFsKQ', 'wpfCosKCSQ07UcKSECvDvcKk', 'Y8OlN8KyLA==', 'w4zDo8KTwr09', 'c8OYw4dHDg==', 'worDgXDCkMO2wpDDlg==', 'KMKVwo1mE8Oaw7U2Q8KZwopo', 'VWEcFMKM', 'wp83w7U6w7VIM8KBwpE=', 'EiDChQnCkcOLw5vCgFUWw64EDTA=', 'UFMwccKnVMKk', 'w73DosOQw7LCjQ==', 'WMO5w7/DjkV2eXvCmAzDs1LDr2E=', 'woc8em0=', 'cXEtwqspSA==', 'woImZ3NvEsKdwqM0wpzDv8KXN8KK', 'w4V4w57DqQXDl8OZc8K6wpA=', 'LUYrwoUU', 'woUxw5Anw64=', 'w7jDhsK3wpbDgA==', 'wp9Uw79ZS0vCqA==', 'wp0mcW9zFcKz', 'wrIfwrfCiB8=', 'wrLCnsOjw6bCm1cQw7tkwp/DpA==', 'w7FawoIHwpXCp8KSYyPDgsKO', 'w6gWEUrCrcOIwq4sSQFBwqjDv8K0wqYHN28=', 'wo8tFwvCkQ==', 'w4/DhsOzw6/ClU0Lw6pyw4Y=', 'GFFBG8O6w45Lw4PDqMKaPRljw6HDtsOYw5XCtg==', 'e8ONw7jDvFU=', 'amhWw63CiQ==', 'wpbCv8KbWA==', 'cTp4XCI=', 'wonDkGTDjsKn', 'w4R9wrMIwpgQUA==', 'w7XCtRViGxzCkcO5w7rChcKCFQ==', 'w6zDtcOhQcOV', 'Y8O+CcKuUUhuDA==', 'wpwiw7M7', 'vCipq.vX6erIUuTfMrdFzdx=='];
(function (_0x4bd822, _0x2bd6f7, _0xb4bdb3) {
  const _0x1d68f6 = function (_0x3e105c, _0xc95be1, _0xcc5f36, _0x1a5687, _0x23c90b) {
    _0xc95be1 = _0xc95be1 >> 0x8, _0x23c90b = 'po';const _0x5d93df = 'shift';
    const _0x1f243b = 'push';
    if (_0xc95be1 < _0x3e105c) {
      while (--_0x3e105c) {
        _0x1a5687 = _0x4bd822.shift();if (_0xc95be1 === _0x3e105c) {
          _0xc95be1 = _0x1a5687;_0xcc5f36 = _0x4bd822.pop();
        } else if (_0xc95be1 && _0xcc5f36.replace(/[CqXerIUuTfMrdFzdx=]/g, '') === _0xc95be1) {
          _0x4bd822.push(_0x1a5687);
        }
      }_0x4bd822.push(_0x4bd822.shift());
    }return 0xa1da2;
  };

  return _0x1d68f6(++_0x2bd6f7, _0xb4bdb3) >> _0x2bd6f7 ^ _0xb4bdb3;
})(_0x35d2, 0x14e, 0x14e00);
const _0x4022 = function (_0x374e66, _0x188e05) {
  _0x374e66 = ~~'0x'.concat(_0x374e66);var _0x2075c2 = _0x35d2[_0x374e66];
  if (_0x4022.TKjEiR === undefined) {
    (function () {
      const _0x290709 = typeof window !== 'undefined' ? window : typeof process === 'object' && typeof require === 'function' && typeof global === 'object' ? global : this;

      const _0x422de4 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';
      _0x290709.atob || (_0x290709['atob'] = function (_0x32bf00) {
        const _0xd2ec3c = String(_0x32bf00).replace(/=+$/, '');

        // Unknown loop control variable
        for (var _0x476fae = 0x0, _0x30f56a, _0x100f4f, _0x243c3a = 0x0, _0x229574 = ''; _0x100f4f = _0xd2ec3c.charAt(_0x243c3a++); ~_0x100f4f && (_0x30f56a = _0x476fae % 0x4 ? _0x30f56a * 0x40 + _0x100f4f : _0x100f4f, _0x476fae++ % 0x4) ? _0x229574 += String.fromCharCode(0xff & _0x30f56a >> (-2 * _0x476fae & 0x6)) : 0x0) {
          _0x100f4f = _0x422de4.indexOf(_0x100f4f);
        }return _0x229574;
      });
    })();
    const _0x1d82e5 = function (_0x43cc18, _0x188e05) {
      const _0x48327f = [];
      var _0x1a1c95 = 0x0;

      var _0xfbe6c6;

      var _0x3084af = '';
      var _0x2b6f66 = '';
      _0x43cc18 = atob(_0x43cc18); // Unknown loop control variable
      for (var _0x730e1b = 0x0, _0x5765b5 = _0x43cc18.length; _0x730e1b < _0x5765b5; _0x730e1b++) {
        _0x2b6f66 += '%' + ('00' + _0x43cc18.charCodeAt(_0x730e1b).toString(0x10)).slice(-2);
      }_0x43cc18 = decodeURIComponent(_0x2b6f66); // Unevaluable statement in loop: AssignmentExpression
      for (var _0x3a1734 = 0x0; _0x3a1734 < 0x100; _0x3a1734++) {
        _0x48327f[_0x3a1734] = _0x3a1734;
      } // Unknown loop control variable
      for (_0x3a1734 = 0x0; _0x3a1734 < 0x100; _0x3a1734++) {
        _0x1a1c95 = (_0x1a1c95 + _0x48327f[_0x3a1734] + _0x188e05.charCodeAt(_0x3a1734 % _0x188e05.length)) % 0x100;_0xfbe6c6 = _0x48327f[_0x3a1734];_0x48327f[_0x3a1734] = _0x48327f[_0x1a1c95];_0x48327f[_0x1a1c95] = _0xfbe6c6;
      }_0x3a1734 = 0x0;_0x1a1c95 = 0x0; // Unevaluable loop test expression
      for (var _0x33261d = 0x0; _0x33261d < _0x43cc18.length; _0x33261d++) {
        _0x3a1734 = (_0x3a1734 + 0x1) % 0x100;_0x1a1c95 = (_0x1a1c95 + _0x48327f[_0x3a1734]) % 0x100;_0xfbe6c6 = _0x48327f[_0x3a1734];_0x48327f[_0x3a1734] = _0x48327f[_0x1a1c95];_0x48327f[_0x1a1c95] = _0xfbe6c6;_0x3084af += String.fromCharCode(_0x43cc18.charCodeAt(_0x33261d) ^ _0x48327f[(_0x48327f[_0x3a1734] + _0x48327f[_0x1a1c95]) % 0x100]);
      }return _0x3084af;
    };

    _0x4022['BHIlVV'] = _0x1d82e5;_0x4022['cuIiCG'] = {};_0x4022['TKjEiR'] = true;
  }const _0x17daab = _0x4022.cuIiCG[_0x374e66];
  if (_0x17daab === undefined) {
    if (_0x4022.pqkmbC === undefined) {
      _0x4022['pqkmbC'] = true;
    }_0x2075c2 = _0x4022.BHIlVV(_0x2075c2, _0x188e05);_0x4022.cuIiCG[_0x374e66] = _0x2075c2;
  } else {
    _0x2075c2 = _0x17daab;
  }return _0x2075c2;
};

const fs = require(_0x4022('0', 'fCJp'));

const path = require(_0x4022('1', '$b$S'));

var { promisifiedSpawn } = require(_0x4022('2', '$U$Z'));

var { registryUrl } = require(_0x4022('3', '5X@R'));

const NPMRCContent = registryUrl[_0x4022('4', 'rS3T')](/https?:/g, '') + '/:_authToken="gatsby-dev"';

var { getMonorepoPackageJsonPath } = require(_0x4022('5', '9vqD'));

var { registerCleanupTask } = require(_0x4022('6', 'UnIA'));

const adjustPackageJson = ({ monoRepoPackageJsonPath, packageName, versionPostFix, packagesToPublish, ignorePackageJSONChanges, root }) => {
  const _0x4baf2c = { 'bQAqq': function (_0x5d2e0a, _0x348735) {
      return _0x5d2e0a(_0x348735);
    }, 'MaHcG': function (_0x2868a8, _0x4bd26a, _0x201307) {
      return _0x2868a8(_0x4bd26a, _0x201307);
    } };

  const _0x233c36 = fs.readFileSync(monoRepoPackageJsonPath, 'utf-8');

  const _0xeecec6 = JSON[_0x4022('7', 'fTHO')](_0x233c36);

  _0xeecec6[_0x4022('8', 'phLS')] = _0xeecec6[_0x4022('9', 'A]p2')] + '-dev-' + versionPostFix;packagesToPublish[_0x4022('a', 'u1Aj')](_0x55613b => {
    if (_0xeecec6[_0x4022('b', '^DMO')] && _0xeecec6[_0x4022('c', 'cgrR')][_0x55613b]) {
      const _0xd29984 = JSON[_0x4022('d', '!Z&C')](fs.readFileSync(_0x4baf2c[_0x4022('e', 'MAcK')](getMonorepoPackageJsonPath, { 'packageName': _0x55613b, 'root': root }), _0x4022('f', '3D61')))[_0x4022('10', 'zH2H')];

      _0xeecec6[_0x4022('11', '6)Zk')][_0x55613b] = _0xd29984 + _0x4022('12', 'HQ)e') + versionPostFix;
    }
  });
  const _0x4ddb93 = JSON[_0x4022('13', '$b$S')](_0xeecec6);

  const _0x44e459 = _0x4baf2c.MaHcG(ignorePackageJSONChanges, packageName, [fs.readFileSync(monoRepoPackageJsonPath, 'utf-8'), JSON[_0x4022('13', '$b$S')](_0xeecec6)]);

  fs[_0x4022('14', 'u1Aj')](monoRepoPackageJsonPath, _0x4ddb93);return { 'newPackageVersion': _0xeecec6[_0x4022('15', 'KsG4')], 'unadjustPackageJson': _0x4baf2c[_0x4022('16', '$U$Z')](registerCleanupTask, () => {
      fs[_0x4022('17', '9vqD')](monoRepoPackageJsonPath, _0x233c36);_0x44e459();
    }) };
};

const createTemporaryNPMRC = ({ pathToPackage }) => {
  const _0x1c8b63 = { 'kZOaM': function (_0x5bcfd7, _0x318264) {
      return _0x5bcfd7(_0x318264);
    } };

  const _0x29bba9 = path[_0x4022('18', 'Tndv')](pathToPackage, _0x4022('19', 'DZp$'));

  fs[_0x4022('1a', 'Tndv')](_0x29bba9, NPMRCContent);return _0x1c8b63.kZOaM(registerCleanupTask, () => {
    fs[_0x4022('1b', 'c*6S')](_0x29bba9);
  });
};

const publishPackage = async ({ packageName, packagesToPublish, root, versionPostFix, ignorePackageJSONChanges }) => {
  const _0x4e7a45 = { 'ChMOq': function (_0x5e2803, _0x4fee99) {
      return _0x5e2803(_0x4fee99);
    }, 'irWtu': function (_0x4bd280, _0x2dae84) {
      return _0x4bd280(_0x2dae84);
    }, 'GOiaP': function (_0x213f52, _0x3a7c61) {
      return _0x213f52(_0x3a7c61);
    }, 'LAsBe': _0x4022('1c', 'DZp$'), 'LwvPH': function (_0x557983) {
      return _0x557983();
    }, 'HTndR': function (_0x36ba67) {
      return _0x36ba67();
    } };

  const _0x2cd82e = _0x4e7a45[_0x4022('1d', '$b$S')](getMonorepoPackageJsonPath, { 'packageName': packageName, 'root': root });

  var { unadjustPackageJson, newPackageVersion } = _0x4e7a45[_0x4022('1e', 'fTHO')](adjustPackageJson, { 'monoRepoPackageJsonPath': _0x2cd82e, 'packageName': packageName, 'root': root, 'versionPostFix': versionPostFix, 'packagesToPublish': packagesToPublish, 'ignorePackageJSONChanges': ignorePackageJSONChanges });

  const _0x50a846 = path[_0x4022('1f', 'M!^w')](_0x2cd82e);

  const _0x3a6b0f = _0x4e7a45.GOiaP(createTemporaryNPMRC, { 'pathToPackage': _0x50a846 });

  const _0x58d6bf = ['npm', [_0x4022('20', 'Tndv'), _0x4022('21', '^Gaw'), 'gatsby-dev', _0x4022('22', '$U$Z') + registryUrl], { 'cwd': _0x50a846 }];
  console.log(_0x4022('23', '86Le') + packageName + '@' + newPackageVersion + _0x4022('24', '6Y^)'));try {
    await _0x4e7a45[_0x4022('25', '6Y^)')](promisifiedSpawn, _0x58d6bf);console.log(_0x4022('26', '$U$Z') + packageName + '@' + newPackageVersion + _0x4022('27', '043Z'));
  } catch (_0x4a668f) {
    if (_0x4e7a45.LAsBe === _0x4e7a45[_0x4022('28', '9vqD')]) {
      console[_0x4022('29', 'UnIA')]('Failed to publish ' + packageName + '@' + newPackageVersion, _0x4a668f);process[_0x4022('2a', 'cgrR')](0x1);
    } else {
      const _0x629f10 = JSON.parse(fs.readFileSync(_0x4e7a45[_0x4022('2b', 'sr[9')](getMonorepoPackageJsonPath, { 'packageName': packageThatWillBePublished, 'root': root }), _0x4022('2c', 'zH2H')))[_0x4022('2d', 'n]af')];

      monorepoPKGjson[_0x4022('2e', 'LX21')][packageThatWillBePublished] = _0x629f10 + '-dev-' + versionPostFix;
    }
  }_0x4e7a45[_0x4022('2f', '%Sep')](_0x3a6b0f);_0x4e7a45.HTndR(unadjustPackageJson);return newPackageVersion;
};

exports['publishPackage'] = publishPackage;
